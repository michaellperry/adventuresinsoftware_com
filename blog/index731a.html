<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" dir="ltr">


<!-- Mirrored from adventuresinsoftware.com/blog/?cat=6&paged=5 by HTTrack Website Copier/3.x [XR&CO'2014], Fri, 13 Jan 2017 13:10:02 GMT -->
<!-- Added by HTTrack --><meta http-equiv="content-type" content="text/html;charset=UTF-8" /><!-- /Added by HTTrack -->
<head profile="http://gmpg.org/xfn/11">
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8" />

<title>Adventures in Software   &raquo; Patterns</title>

<meta name="generator" content="WordPress 2.3.3" /> <!-- leave this for stats -->

<link rel="stylesheet" href="wp-content/themes/ais2/style.css" type="text/css" media="screen" />
<link rel="alternate" type="application/rss+xml" title="Adventures in Software RSS Feed" href="indexd784.html?feed=rss2" />
<link rel="pingback" href="xmlrpc.html" />
    <script type="text/javascript">
        function onSilverlightError(sender, args) {
            var appSource = "";
            if (sender != null && sender != 0) {
              appSource = sender.getHost().Source;
            }
            
            var errorType = args.ErrorType;
            var iErrorCode = args.ErrorCode;

            if (errorType == "ImageError" || errorType == "MediaError") {
              return;
            }

            var errMsg = "Unhandled Error in Silverlight Application " +  appSource + "\n" ;

            errMsg += "Code: "+ iErrorCode + "    \n";
            errMsg += "Category: " + errorType + "       \n";
            errMsg += "Message: " + args.ErrorMessage + "     \n";

            if (errorType == "ParserError") {
                errMsg += "File: " + args.xamlFile + "     \n";
                errMsg += "Line: " + args.lineNumber + "     \n";
                errMsg += "Position: " + args.charPosition + "     \n";
            }
            else if (errorType == "RuntimeError") {           
                if (args.lineNumber != 0) {
                    errMsg += "Line: " + args.lineNumber + "     \n";
                    errMsg += "Position: " +  args.charPosition + "     \n";
                }
                errMsg += "MethodName: " + args.methodName + "     \n";
            }

            throw new Error(errMsg);
        }
    </script>

	<link rel="EditURI" type="application/rsd+xml" title="RSD" href="xmlrpc0db0.php?rsd" />
 <link rel="wlwmanifest" type="application/wlwmanifest+xml" href="wp-includes/wlwmanifest.xml" /> <style type='text/css'>
<!--#header { background: url('wp-content/themes/ais2/images/header-imgae03.html?upper=A7A73F&amp;lower=77773F') no-repeat bottom center; }
--></style>
</head>
<body>
<div id="page">

<div class="aisTopBar">
	<form method="get" id="searchform" action="http://adventuresinsoftware.com/blog/">
<div>
<a href="indexd784.html?feed=rss2"><img src="../images/feed-icon-28x28.png" border="0"></a>
<input type="text" value="" name="s" id="s" />
<input type="submit" id="searchsubmit" value="Search" />
</div>
</form>
</div>

<div class="aisHeaderImageRight">
	<div class="aisHeaderImage">
	<div class="aisHeaderCornerRight">
	<div class="aisHeaderCornerLeft">
	<div class="aisImageBar">
	<div class="aisSubSites">
		<a href="index.html" class="aisSubSiteLink"><span class="aisSiteTabRight"><span class="aisSiteTabLeft"><span class="aisSiteTab">
			home</span></span></span></a>
		<a class="aisSubSiteLink" href="indexb60a.html?cat=27"><span class="aisSiteTabRight"><span class="aisSiteTabLeft"><span class="aisSiteTab">
			historic modeling</span></span></span></a>
		<a class="aisSubSiteLink" href="indexa88f.html?cat=36"><span class="aisSiteTabRight"><span class="aisSiteTabLeft"><span class="aisSiteTab">
			update controls</span></span></span></a>
		<a href="index2d79.html?cat=26" class="aisSubSiteLink"><span class="aisSiteTabRight"><span class="aisSiteTabLeft"><span class="aisSiteTab">
			degrees of freedom</span></span></span></a>
		<a class="aisSubSiteLink" href="indexba53.html?page_id=2"><span class="aisSiteTabRight"><span class="aisSiteTabLeft"><span class="aisSiteTab">
			about us</span></span></span></a>

	</div>
	</div>
	</div>
	</div>
	</div>
</div>

<table style="width: 100%" cellspacing="0" cellpadding="0">
	<tr valign="top">
		<td width="210px">
<div id="sidebar">
<div class="aisLeftColumnFill">
<div class="aisLeftColumnBottom">
<div class="aisLeftColumnTop">
<div id="twitter_div" class="aisLeftNav">
<h2 class="sidebar-title">Twitter Updates</h2>
<ul id="twitter_update_list"></ul>
<a href="http://twitter.com/michaellperry" id="follow">Follow me</a>
</div>
<div id="twitter_reply_div" class="aisLeftNav">
<h2 class="sidebar-title">Twitter Replies</h2>
<ul id="twitter_reply_list"></ul>
</div>

<div class="aisLeftNav">
<a href='http://ineta.org/Speakers/SearchCommunitySpeakers.aspx?SpeakerId=c5110e21-9243-461b-a464-a6548524e885'><img alt='INETA Community Speakers Program' border='0' src='../../www.ineta.org/images/OfficialLogos/InetaCommunitySpeakersRequestMe.html' /></a>
</div>

<div class="aisLeftNav">
	<li class="pagenav"><h2>Pages</h2><ul><li class="page_item page-item-2"><a href="indexba53.html?page_id=2" title="About Us">About Us</a></li>
<li class="page_item page-item-210"><a href="index6ae3.html?page_id=210" title="Templates">Templates</a></li>
</ul></li></div>

<div class="aisLeftNav">
<h2>Archives</h2>
<ul>
	<li><a href='indexb4d5.html?m=201110' title='October 2011'>October 2011</a></li>
	<li><a href='indexc61a.html?m=201106' title='June 2011'>June 2011</a></li>
	<li><a href='indexa80d.html?m=201105' title='May 2011'>May 2011</a></li>
	<li><a href='index512b.html?m=201104' title='April 2011'>April 2011</a></li>
	<li><a href='index08fb.html?m=201103' title='March 2011'>March 2011</a></li>
	<li><a href='index52f4.html?m=201102' title='February 2011'>February 2011</a></li>
	<li><a href='index74f1.html?m=201101' title='January 2011'>January 2011</a></li>
	<li><a href='index8956.html?m=201012' title='December 2010'>December 2010</a></li>
	<li><a href='indexa1aa.html?m=201011' title='November 2010'>November 2010</a></li>
	<li><a href='indexe3d5.html?m=201010' title='October 2010'>October 2010</a></li>
	<li><a href='index9ab9.html?m=201009' title='September 2010'>September 2010</a></li>
	<li><a href='index1ff0.html?m=201008' title='August 2010'>August 2010</a></li>
	<li><a href='index9f11.html?m=201007' title='July 2010'>July 2010</a></li>
	<li><a href='index31f0.html?m=201006' title='June 2010'>June 2010</a></li>
	<li><a href='indexd189.html?m=201005' title='May 2010'>May 2010</a></li>
	<li><a href='indexb5c0.html?m=201004' title='April 2010'>April 2010</a></li>
	<li><a href='indexf258.html?m=201003' title='March 2010'>March 2010</a></li>
	<li><a href='index6e30.html?m=201002' title='February 2010'>February 2010</a></li>
	<li><a href='index6b19.html?m=201001' title='January 2010'>January 2010</a></li>
	<li><a href='index5c0a.html?m=200912' title='December 2009'>December 2009</a></li>
	<li><a href='index8f62.html?m=200911' title='November 2009'>November 2009</a></li>
	<li><a href='index451d.html?m=200910' title='October 2009'>October 2009</a></li>
	<li><a href='index3e04.html?m=200909' title='September 2009'>September 2009</a></li>
	<li><a href='index425a.html?m=200908' title='August 2009'>August 2009</a></li>
	<li><a href='index9907.html?m=200907' title='July 2009'>July 2009</a></li>
	<li><a href='index3104.html?m=200906' title='June 2009'>June 2009</a></li>
	<li><a href='indexc36d.html?m=200905' title='May 2009'>May 2009</a></li>
	<li><a href='index17e8.html?m=200904' title='April 2009'>April 2009</a></li>
	<li><a href='index10a5.html?m=200903' title='March 2009'>March 2009</a></li>
	<li><a href='index8988.html?m=200902' title='February 2009'>February 2009</a></li>
	<li><a href='index1419.html?m=200901' title='January 2009'>January 2009</a></li>
	<li><a href='index7866.html?m=200812' title='December 2008'>December 2008</a></li>
	<li><a href='index55f6.html?m=200811' title='November 2008'>November 2008</a></li>
	<li><a href='indexa7bc.html?m=200810' title='October 2008'>October 2008</a></li>
	<li><a href='indexe77c.html?m=200809' title='September 2008'>September 2008</a></li>
	<li><a href='indexcffc.html?m=200808' title='August 2008'>August 2008</a></li>
	<li><a href='index0e62.html?m=200807' title='July 2008'>July 2008</a></li>
	<li><a href='indexfda7.html?m=200806' title='June 2008'>June 2008</a></li>
	<li><a href='index7d64.html?m=200805' title='May 2008'>May 2008</a></li>
	<li><a href='index94dd.html?m=200804' title='April 2008'>April 2008</a></li>
	<li><a href='index9631.html?m=200803' title='March 2008'>March 2008</a></li>
	<li><a href='indexdd52.html?m=200802' title='February 2008'>February 2008</a></li>
	<li><a href='index21ee.html?m=200801' title='January 2008'>January 2008</a></li>
	<li><a href='index363c.html?m=200712' title='December 2007'>December 2007</a></li>
	<li><a href='index7493.html?m=200711' title='November 2007'>November 2007</a></li>
	<li><a href='index93a7.html?m=200710' title='October 2007'>October 2007</a></li>
	<li><a href='index4ca8.html?m=200709' title='September 2007'>September 2007</a></li>
	<li><a href='index6124.html?m=200708' title='August 2007'>August 2007</a></li>
	<li><a href='index6013.html?m=200707' title='July 2007'>July 2007</a></li>
	<li><a href='index2ab6.html?m=200706' title='June 2007'>June 2007</a></li>
	<li><a href='index44f0.html?m=200705' title='May 2007'>May 2007</a></li>
	<li><a href='indexf0b4.html?m=200704' title='April 2007'>April 2007</a></li>
	<li><a href='index481d.html?m=200703' title='March 2007'>March 2007</a></li>
	<li><a href='indexcbea.html?m=200702' title='February 2007'>February 2007</a></li>
	<li><a href='index9cdc.html?m=200701' title='January 2007'>January 2007</a></li>
	<li><a href='index3ea4.html?m=200612' title='December 2006'>December 2006</a></li>
	<li><a href='index67ca.html?m=200611' title='November 2006'>November 2006</a></li>
	<li><a href='indexff49.html?m=200610' title='October 2006'>October 2006</a></li>
	<li><a href='index611c.html?m=200609' title='September 2006'>September 2006</a></li>
	<li><a href='index9a21.html?m=200608' title='August 2006'>August 2006</a></li>
	<li><a href='index3ee9.html?m=200607' title='July 2006'>July 2006</a></li>
	<li><a href='indexe13a.html?m=200606' title='June 2006'>June 2006</a></li>
</ul>
</div>

<div class="aisLeftNav">
	</div>

<div class="aisLeftNav">
<h2>Books</h2>
<iframe src="http://rcm.amazon.com/e/cm?t=adventures0d2-20&amp;o=1&amp;p=8&amp;l=as1&amp;asins=0764526413&amp;fc1=000000&amp;IS2=1&amp;lt1=_blank&amp;lc1=0000ff&amp;bc1=000000&amp;bg1=ffffff&amp;f=ifr" style="width:120px;height:240px;" scrolling="no" marginwidth="0" marginheight="0" frameborder="0" name="I5" id="I5"></iframe>
<br/>
<iframe src="http://rcm.amazon.com/e/cm?t=adventures0d2-20&amp;o=1&amp;p=8&amp;l=as1&amp;asins=0201633612&amp;fc1=000000&amp;IS2=1&amp;lt1=_blank&amp;lc1=0000ff&amp;bc1=000000&amp;bg1=ffffff&amp;f=ifr" style="width:120px;height:240px;" scrolling="no" marginwidth="0" marginheight="0" frameborder="0" name="I6" id="I6"></iframe>
<br/>
<iframe src="http://rcm.amazon.com/e/cm?t=adventures0d2-20&amp;o=1&amp;p=8&amp;l=as1&amp;asins=0136291554&amp;fc1=000000&amp;IS2=1&amp;lt1=_blank&amp;lc1=0000ff&amp;bc1=000000&amp;bg1=ffffff&amp;f=ifr" style="width:120px;height:240px;" scrolling="no" marginwidth="0" marginheight="0" frameborder="0" name="I7" id="I7"></iframe>
<br/>
<iframe src="http://rcm.amazon.com/e/cm?t=adventures0d2-20&amp;o=1&amp;p=8&amp;l=as1&amp;asins=1888009195&amp;fc1=000000&amp;IS2=1&amp;lt1=_blank&amp;lc1=0000ff&amp;bc1=000000&amp;bg1=ffffff&amp;f=ifr" style="width:120px;height:240px;" scrolling="no" marginwidth="0" marginheight="0" frameborder="0" name="I8" id="I8"></iframe>
</div>
<div class="aisLeftNav">
<h2>Meta</h2>
<ul>
		<li><a href="wp-login.html">Login</a></li>
	<li><a href="http://validator.w3.org/check/referer" title="This page validates as XHTML 1.0 Transitional">Valid <abbr title="eXtensible HyperText Markup Language">XHTML</abbr></a></li>
	<li><a href="http://gmpg.org/xfn/"><abbr title="XHTML Friends Network">XFN</abbr></a></li>
	<li><a href="http://wordpress.org/" title="Powered by WordPress, state-of-the-art semantic personal publishing platform.">WordPress</a></li>
	</ul>
</div>
<div class="aisLeftContent">
<h2>Community</h2>
<ul>
	<script type="text/javascript" src="../../localhost/embed/92q2bbma.js"></script>
</ul>
</div>

</div></div></div>
</div>		</td>
		<td>

	<div id="content" class="narrowcolumn">

		
		 		<h2 class="pagetitle">Archive for the &#8216;Patterns&#8217; Category</h2>

 	  

		<div class="navigation">
			<div class="alignleft"><a href="indexd923.html?cat=6&amp;paged=6">&laquo; Previous Entries</a></div>
			<div class="alignright"><a href="index890d.html?cat=6&amp;paged=4">Next Entries &raquo;</a></div>
		</div>

				<div class="post">
				<h3 id="post-57"><a href="index9787.html?p=57" rel="bookmark" title="Permanent Link to The Single-Queue Dispatcher Pattern">The Single-Queue Dispatcher Pattern</a></h3>
				<small>Saturday, November 25th, 2006</small>

				<div class="entry">
					<p>Today is Black Friday in the States: the day after Thanksgiving when the Christmas shopping season officially begins. I usually try to avoid stores on this day, but my wife needs a new PC, so we went to Fry's.</p>
<p>There was quite a crowd there as we were picking out components, but the experience was incredible. They had extra staff helping customers on the floor, and even more manning the registers. The line moved quickly and smoothly due to their excellent planning.</p>
<p>The system that Fry's uses is a single queue. One person stands at the head of the queue and dispatches customers to multiple registers. Unlike a grocery store, with its one queue per register, this system doesn't force you to chose your server prior to getting in line. Have you ever gotten behind the person with three price-checks only to see the people who queued up after you served first in the next line? That won't happen at Fry's.</p>
<p>The single-queue solution is so simple and elegant that it is my favorite parallel-service software pattern. It is applicable any time you have units of work concurrently flowing into a system, when those units of work are independent. Examples I've seen include HTTP requests, financial transactions, and remote procedure calls.</p>
<p>This pattern has three components. First is the queue, which holds units of work. Second is the dispatcher, which draws units of work from the queue. Third is the pool, which holds the processors to which the dispatcher assigns work.</p>
<p>The queue is a thread-safe container. It may be implemented in memory if it is OK for work items to be lost (e.g. HTTP requests, which will be retried). Or it may be implemented in a database if work items cannot be lost (e.g. financial transactions).</p>
<p>The dispatcher is a single thread in a tight loop. It blocks on the queue until a unit of work is available, then it blocks on the pool until a processor can be allocated. More sophisticated dispatchers may even grow and shrink the pool based on demand.</p>
<p>The pool is another thread-safe collection, this one of processors. A processor carries with it the resources it needs to do the work, such as threads or database connections. Allocation of these resources can be expensive, so processors are returned to the pool with their resource intact. Usually the pool is implemented as a stack, so that a small number of processors will be kept as busy as possible. Processors that sink to the bottom of the pool will go stale, and will be the first to be reclaimed by a sophisticated dispatcher.</p>
<p>This pattern is supported by Berkley Sockets. The accept() function blocks on a queue within the TCP/IP stack. The ideal use of this function is for a dispatcher thread to call it in a tight loop and allocate the sockets it returns to threads in a pool.</p>
<p>This pattern is implemented in .NET's ThreadPool. The QueueUserWorkItem method places a unit of work into a managed queue, and the .NET Framework dispatches that work to a pooled thread for processing.</p>
<p>There are countless other implementations of this pattern, from JMS to MSMQ. But even if one of these solutions is more than you need, you can implement the pattern yourself. It is simple, efficient, and effective.</p>
				</div>

				<p class="postmetadata">Posted in <a href="indexb0b7.html?cat=6" title="View all posts in Patterns" rel="category">Patterns</a> |   <a href="index9787.html?p=57#respond" title="Comment on The Single-Queue Dispatcher Pattern">No Comments &#187;</a></p>

			</div>

				<div class="post">
				<h3 id="post-54"><a href="indexcc0f.html?p=54" rel="bookmark" title="Permanent Link to Data Aggregation for Reporting">Data Aggregation for Reporting</a></h3>
				<small>Thursday, November 16th, 2006</small>

				<div class="entry">
					<p>A good way to design an enterprise system is to separate reporting from transaction processing. This lets the two processes run independently without interfering with one another. It also allows the database designer to optimize each component for its particular use.</p>
<p>When these two concerns are separated, the data must be moved from the transaction processing side of the business into the reporting side. In the process, data should be aggregated to keep storage requirements low and to make reports run quickly. There are two ways of accomplishing this: real-time and agent-driven.</p>
<p>A real-time aggregation solution updates the aggregate records as transactions are processed. For example, a book sale transaction might update a record that keeps track of the number of books sold by author. The author's record is either inserted or updated during the book sale transaction.</p>
<p>An agent-based aggregation solution, on the other hand, calculates an aggregate in the background after many transactions. For example, a query might run once a day to insert a count of books sold by author for that day.</p>
<p>There are advantages and disadvantages to each technique. Real-time updates provide the most accurate and useful reports, but they can interfere with the main business of the system. Agent-based aggregates don't block current transactions, but they can generate large batches of data that can be hard to move. Which method is right for a given situation?</p>
<p><strong>Here's my solution</strong><br />
The best rule-of-thumb that I've found is to use the granularity as an indicator. Some aggregates are extremely coarse-grained, pulling all of the data into a small number of categories. Others are more fine, rolling up to a large number of very specific line items. Coarse-grained aggregates should be updated by a background agent, while fine-grained aggregates should be summed in real-time.</p>
<p>Coarse-grained aggregates create sums for a small set of keys. Usually, this key set is fixed, as in the categories of books or the locations of book stores. If the key set is small, then a real-time rollup would experience a lot of contention. The same small number rows would be updated many times by many concurrent threads. However, a delayed agent rollup would calculate each of those rows once by a single process. That makes the agent-based approach ideal.</p>
<p>Fine-grained aggregates create sums for a large set of keys. This key set grows over time because is based on the data itself. It might include individual books, authors, or customers. If the key set is large, a background agent would produce a large set of rows all at once. Large row sets cause problems with replication and blocking. But a real-time update would insert or modify one row at a time, leaving plenty of room for replication or blocking operations to interweave. Furthermore, if a user ID is part of the key set, collisions are extremely unlikely. User activity tends to be serialized, since one person can't usually do two things at once with the same application.</p>
<p>Separating reporting from transaction processing is an important part of an enterprise system. Consider the size of the aggregate key set when choosing how to go about moving the data.</p>
				</div>

				<p class="postmetadata">Posted in <a href="indexc728.html?cat=7" title="View all posts in Databases" rel="category">Databases</a>,  <a href="indexb0b7.html?cat=6" title="View all posts in Patterns" rel="category">Patterns</a> |   <a href="indexcc0f.html?p=54#comments" title="Comment on Data Aggregation for Reporting">1 Comment &#187;</a></p>

			</div>

				<div class="post">
				<h3 id="post-44"><a href="index49b1.html?p=44" rel="bookmark" title="Permanent Link to Share the Authority">Share the Authority</a></h3>
				<small>Monday, November 13th, 2006</small>

				<div class="entry">
					<p>In the typical database application, identity is created by an auto-increment key. Every insert to a table allocates a new number that uniquely identifies that new row. This number is used within the business logic of the application to return to that row in the future, and as foreign keys in other tables. It's a solution that works quite well.</p>
<p>That is, until it stops working.</p>
<p>One problem with this approach is that it fails to scale out. The one database server that allocates IDs becomes the one and only authority on identity. In order to create a new identity, any web server, any app server, and any integrated database server must abdicate to the one keeper of the auto-increment key. This one server becomes the bottleneck for rows in the table.</p>
<p>Database vendors have created ingenious solutions to this problem. It is possible with today's technology to connect a cluster of homogeneous servers and have them act as one big database. However, this solution is costly go build, tricky to configure, and difficult to maintain.</p>
<p>The problem (which we see time and again) is that our model has written a check that our technology can't cash. When we design our systems relationally, we assume that we can always go to one big table and that it will contain all of the rows that we need. If the customer in my system, she can be found in the one and only customer table. Since there is no other table that holds customers, the monotonically increasing ID is all I need to find her.</p>
<p>That assumption builds in a bottleneck that we later try to engineer out. In creating a cluster, we acknowledge that it can't <em>really</em> be one big table, but we still have to make it look like one. The relational model demands it.</p>
<p>But if we take a step back, we discover that we don't really need all of the promises that the relational model makes. Instead, we can live with a smaller set of promises that the technology can actually deliver.</p>
<p><strong>Here's my solution </strong><br />
Distribute data across different databases. These databases agree in schema, but differ in data. Identify rows not just by their auto-incremented ID numbers, but by a compound key that also includes a database ID. Yes, go ahead and store that database ID in a separate column -- make that the first column -- of every table.</p>
<p>Use a connection factory in your applications that recognizes this database ID. Based on that ID, create a connection to the appropriate database. Give your operations team control over that configuration so that they can control the allocation of IDs to databases. Give them tools to move data from one database to another in order to split or merge databases as demand requires.</p>
<p>Joining across databases is often impossible and never recommended. So keep all detail rows in the same database as their master. Choose your pivot points wisely to avoid the need for cross-database joining. Database allocation should be coarse, such as keeping all records for one client or account in the same database. But when you need finer grained control, choose a relationship that you exploit only through presentation-tier linking or middle-tier business logic, never through data-tier joins. You can serve a link on a web page that leads to another database, but don't mix data from two databases on one page.</p>
<p>And always allow for many database IDs to refer to one physical database server. This will be necessary when underutilized databases are merged. It will also give your operations team the ability to plan ahead for future splits should they become necessary.</p>
<p>One server or cluster may be all you ever need, but by sharing the authority you give yourself options. The operations team may thank you in years to come.</p>
				</div>

				<p class="postmetadata">Posted in <a href="indexc728.html?cat=7" title="View all posts in Databases" rel="category">Databases</a>,  <a href="indexb0b7.html?cat=6" title="View all posts in Patterns" rel="category">Patterns</a> |   <a href="index49b1.html?p=44#respond" title="Comment on Share the Authority">No Comments &#187;</a></p>

			</div>

				<div class="post">
				<h3 id="post-49"><a href="index0012.html?p=49" rel="bookmark" title="Permanent Link to Alternative to Role-Based Security">Alternative to Role-Based Security</a></h3>
				<small>Thursday, November 2nd, 2006</small>

				<div class="entry">
					<p>The ideas of users and roles are pervasive. Just about every OS includes the idea of a user who logs in and is a member of some role. And many types of web sites -- blogs, message boards, and wikis for example -- organize their registered users into roles like administrator, editor, author, and guest.</p>
<p>In this type of system, resource permissions are usually doled out not to individual users, but to all users in a role. All members of a role tend to perform the same types of actions to several resources. Authors create articles, editors modify them, and guests read them. Role-based security is a simple metaphor for permitting people to do the jobs that they want to do.</p>
<p>As pervasive as this metaphor is, we often forget that it is not the only option. Indeed, it is not even the best option. Role-based security has several flaws that make it inconvenient, and ultimately insecure.</p>
<p>The first weakness of role-based security is the root, or administrator. Someone has to define the roles, assign them permissions, and populate them with users. Even if this person doesn't have direct access to all resources in the system, he can easily create another user account for himself that does. It is impossible to keep secrets from Root.</p>
<p>The second weakness is coarse granularity. When a permission for a resource is granted to a role, all users in that role inherit that permission. But you might want to subdivide your editors and authors into teams, giving each team's editors permission to modify articles created by their own team's authors. You could create finer roles to account for this, but doing so requires administrator intervention.</p>
<p>Which brings us to the third weakness: the admin bottleneck. Any significant change requires an administrator. Administrators are busy people, and work should not stop while we wait for them to create new roles and assign new permissions. The people doing the work should be able to organize themselves and their resources on their own, independent of other groups.</p>
<p>The fourth weakness is centralization. The administrator represents one authority. All users and all roles are derived from this authority. It is difficult to merge two organizations that have different roots, as all users, roles, and resources must be merged into one of the two central authorities. LDAP directory services perform this operation, but they are difficult to set up and administer.</p>
<p>The fifth flaw is that the administrator controls identity. In order to gain access to the system, a person needs to go to the administrator to obtain a user account. The admin assigns them to a role and issues a name and password. For that brief period, both the user and root know the password. Furthermore, root has the authority to change the user's password or revoke the account at any time.</p>
<p>These flaws add up to a system that is inconvenient and insecure. The lack of convenience comes from the bottleneck of administration and the difficulty of merging. The insecurity comes from the all-powerful root, who has access to data and identities that he does not own.</p>
<p><strong>Here's my solution</strong></p>
<p>The alternative is so simple and powerful that I'm surprised to see how infrequently it is implemented. Just put the power in the hands of the users who create the resources. When people control their own identity and their own resources, the omnipotent root becomes obsolete.</p>
<p>The scenario is as follows. A person -- call him Jim -- approaches a system for the first time and creates his own user account. Jim only shares his password with the system, not with an admin. This new user account only has permissions to create new resources. No one has access to these new resources other than Jim. No one.</p>
<p>Then another person -- Helen -- establishes a user account in the same way. She and Jim want to work together, so she identifies herself to Jim both in-band (by giving him her user name) and out-of-band (by verifying that user name on the phone or face-to-face). Jim then assigns Helen permission to access the resource he created.</p>
<p>Now suppose Daniel and John want to join the team. Either Jim or Helen can give them access to the resource. But instead they decide to create a group. John creates the group and invites the others to join (again both in-band and out-of-band). Then Helen gives that group access to the resource. They can now create more resources under the umbrella of that group.</p>
<p>If Jim leaves the team, any remaining member can remove him from the group. Now he no longer has access to the resources controlled by the group, including the one that he started the whole project with. The team can organize themselves, authenticate their members, and control their resources without giving up any control to an administrator.</p>
<p><strong>The solution in practice</strong></p>
<p>Multi-user blog sites go part of the way toward this solution. You can go to blogspot.com and create an account without contacting an administrator. Then you create your own blog to which you alone can post. But everyone has read access to your resource. After all, it is a blog.</p>
<p>Google Docs and Spreadsheets goes a little further by allowing you to grant other users access to your resources. But you still can't create groups to manage permissions for entire teams.</p>
<p>By far the best implementation of this idea is <a href="http://www.adventuresinsoftware.com/blog/www.groove.net">Groove</a>, a peer-to-peer collaborative workspace acquired by Microsoft. Anyone can create a new space, invite anyone they want into that space, and maintain control over the resources therein. The space itself acts like a group, associating individual users with the resources that they control. Any member can invite others to the space, though last I looked you cannot revoke someone else's membership.</p>
<p>But there is nothing special about peer-to-peer. You can implement this idea on the web. Think about it next time you are setting up a collaborative site.</p>
				</div>

				<p class="postmetadata">Posted in <a href="indexb0b7.html?cat=6" title="View all posts in Patterns" rel="category">Patterns</a>,  <a href="index376e.html?cat=13" title="View all posts in Security" rel="category">Security</a> |   <a href="index0012.html?p=49#comments" title="Comment on Alternative to Role-Based Security">4 Comments &#187;</a></p>

			</div>

				<div class="post">
				<h3 id="post-42"><a href="indexfbd5.html?p=42" rel="bookmark" title="Permanent Link to Four Rules for APIs">Four Rules for APIs</a></h3>
				<small>Tuesday, October 17th, 2006</small>

				<div class="entry">
					<p>Java's Date and Calendar API is awful. Even when a quick date calculation is required, you have to stop the flow of your coding to go through the GregorianCalendar gyrations. It is impossible to simply express the intent with these defunct classes.</p>
<p>I've decided to use this as an learning exercise. What is it about Date and Calendar that makes it so difficult to use? What can we do to avoid these difficulties when designing our own classes? Fortunately, there is an alternative that gets it right. When comparing java.util to <a href="http://joda-time.sourceforge.net/">Joda</a>, the problems become quite apparent.</p>
<p>The first problem is that the Date class has no useful methods. In order to use a Date, one must almost always put it into a GregorianCalendar. Most of us writing in Java are working on business applications, and business uses the Gregorian calendar. Different countries have different names for the days of the week and the months of the year, but we all have days, weeks, months, and years. The Date class should expose those concepts directly.</p>
<p>The second problem is that method calls cannot be chained. OK, I've accepted the fact that to work with a Date, I have to construct a GregorianCalendar. So I start to type something like this:</p>
<pre>int day = new GregorianCalendar(date).get(Calendar.DAY);</pre>
<p>But, no, GregorianCalendar has no constructor that takes a Date. I have to construct and initialize it in two separate steps. And then, to make matters worse, the method that initializes the GregorianCalendar is void. So I can't even chain this call with the get. I have to do in three lines what I would like to do in one.</p>
<p>The third problem is that the API provides one generic getter and setter for all fields of a Calendar. A Calendar is a collection of fields identified by constants. But I don't care how you represent a Calendar, I just want to know what day it is.<br />
The fourth problem is that there is no distinction between a date (October 17, 2006), a time of day (10:11 pm), and a moment in time (October 17, 2006 at 10:11 pm). These different concepts need to be treated differently. When working with dates, for example, you don't apply time zones or daylight savings rules. The span between October 29 and October 30 is still 1 day, even though the span between midnight on those two days may be 25 hours (depending upon where you live).</p>
<p>Joda solves all of these problems. It is easy to use right where you need it without breaking stride. Do yourself a favor and start using it now, even if you are right in the middle of a project. You'll never want to be without it.</p>
<p>But the point of this post is not to plug Joda, but to codify four rules for creating good APIs:</p>
<ol>
<li>Put the useful methods on the most used classes. Don't force your audience to bring in objects that they don't already need.</li>
<li>Promote method chaining. This is accomplished in two ways. First, all methods should return something, even if it is "this". And second, provide all necessary conversions. Overload constructors, or better yet have a good set of static methods (GregorianCalendar.fromDate() would have been nice).</li>
<li>Break down the abstraction the way your audience will use it. Don't design the API based on implementation.</li>
<li>Create a different type for each useful distinct idea, even if it appears to be a special case of another. Remember, <a href="http://ootips.org/ellipse-circle.html">a circle is <em>not</em> an ellipse</a>, no matter what you learned in geometry.</li>
</ol>
<p>While you are working on the API, remember the golden rule Necessary and Sufficient. Don't go crazy with the convenience methods or you will only sow confusion.</p>
				</div>

				<p class="postmetadata">Posted in <a href="index1cd2.html?cat=10" title="View all posts in Contracts" rel="category">Contracts</a>,  <a href="indexb0b7.html?cat=6" title="View all posts in Patterns" rel="category">Patterns</a>,  <a href="index0b40.html?cat=9" title="View all posts in Tools" rel="category">Tools</a> |   <a href="indexfbd5.html?p=42#respond" title="Comment on Four Rules for APIs">No Comments &#187;</a></p>

			</div>

				<div class="post">
				<h3 id="post-37"><a href="index4837.html?p=37" rel="bookmark" title="Permanent Link to Mathematical Where Clause">Mathematical Where Clause</a></h3>
				<small>Tuesday, October 10th, 2006</small>

				<div class="entry">
					<p>Here's a trick that I learned from a database guru: instead of using "SELECT COUNT(*) ... WHERE x", consider using "SELECT SUM(IF(x, 1, 0))". He calls this a mathematical where clause, because it simulates a where clause with an aggregate function.</p>
<p>The idea is that a SELECT statement can have only one WHERE clause. If you want to count different subsets of rows using COUNT(*), you have to run a different SELECT statement for each one. That could cost you some performance if your WHERE clauses don't line up with indexes, because each SELECT statement performs another table scan. However, you can combine multiple subsets into one SELECT statement by writing different SUMs. Then, it does all of the counting in just one table scan.</p>
<p>Today I wrote some code to aggregate logs over time. I wanted to capture the total number of requests, as well as the number of failed requests. I solved the problem using a mathematical where clause:</p>
<pre>SELECT command, COUNT(*) AS total_requests, SUM(IF(result!=200, 1, 0)) AS failed_requests
&nbsp;&nbsp;FROM log
&nbsp;&nbsp;GROUP BY command</pre>
<p>And this trick can be combined with other aggregate functions to produce even more interesting results. Instead of just adding up 1s, you can aggregate any value you want. Just put the value on the positive side of an IF. But be careful about what goes on the negative side. Whereas a 0 has no effect on a SUM, it has a devistating effect on functions like MIN or AVG. For those, use a NULL. Aggregate functions ignore NULLs.</p>
<p>For example, I added another column to my select statement to return the smallest and largest valid results. I added the following to the statement:</p>
<pre>SELECT ... MIN(IF(result=200, response_size, NULL)) AS min_result,
&nbsp;&nbsp;MAX(IF(result=200, response_size, NULL)) AS max_result ...</pre>
<p>A 0 wouldn't mess up the MAX, but I used NULL for consistency with the MIN.</p>
<p>As always, please carefully consider the impact of this technique on your performance. Mathematical where clauses cannot take advantage of indexes. So if your conditions line up with indexes, go ahead and use multiple SELECTs. That way you can avoid the table scan altogether.</p>
				</div>

				<p class="postmetadata">Posted in <a href="indexb0b7.html?cat=6" title="View all posts in Patterns" rel="category">Patterns</a> |   <a href="index4837.html?p=37#respond" title="Comment on Mathematical Where Clause">No Comments &#187;</a></p>

			</div>

				<div class="post">
				<h3 id="post-35"><a href="index5c90.html?p=35" rel="bookmark" title="Permanent Link to Separation of Concerns in Ant">Separation of Concerns in Ant</a></h3>
				<small>Monday, September 25th, 2006</small>

				<div class="entry">
					<p>In a <a href="index3c55.html?p=28">previous post</a>, I wrote about separation of concerns in various software tools. One of these was Ant. Since that time, I have come up with a solution to the problem.</p>
<p>To recap, the problem is that an Ant script defines two perpendicular dimensions of a build: actions and projects. Actions depend upon other actions, and projects on other projects. The work occurs at the intersections of these two dimensions, where an action is applied to a project.</p>
<p><strong>Here's my solution</strong><br />
The first step is to completely parameterize the actions so that they can be applied to any project. The locations of source files, the names of target jar files, and the classpath can all be specified as properties. Create a separate "actions.xml" file for these targets. The actions do not depend upon one another. These dependencies will be handled at a higher level. For example:</p>
<pre> &lt;property prefix="project" file="${home}/project.properties" /&gt;  &lt;!-- Get the source files. --&gt;
 &lt;target name="get"&gt;
  &lt;!-- Set Defaults --&gt;
  &lt;property name="branch" value="trunk" /&gt;
  &lt;property name="revision" value="HEAD" /&gt;
  &lt;svn username="${username}" password="${password}"&gt;
   &lt;checkout url="https://svn.mallardsoft.com/svn/productline/${branch}/${project}/" revision="${revision}" destPath="${temp}" /&gt;
  &lt;/svn&gt;
 &lt;/target&gt;

 &lt;!-- Compile the java sources. --&gt;
 &lt;target name="compile"&gt;
  &lt;javac srcdir="${src}" destdir="${classes}" debug="${debug}"&gt;
   &lt;classpath&gt;
    &lt;pathelement path="${project.libs}" /&gt;
    &lt;pathelement path="${project.depends}" /&gt;
   &lt;/classpath&gt;
   &lt;include name="**/*.java" /&gt;
  &lt;/javac&gt;
 &lt;/target&gt;

 &lt;!-- Jar the classes. --&gt;
 &lt;target name="jar"&gt;
  &lt;jar destfile="${dist}/${project.jar}.jar"&gt;
   &lt;fileset dir="${classes}" /&gt;
   &lt;fileset dir="${src}"&gt;
       &lt;exclude name="**/*.java"/&gt;
   &lt;/fileset&gt;
  &lt;/jar&gt;
 &lt;/target&gt;</pre>
<p>The second step is to create a properties file for each project. Paths are specified as colon-separated lists. I've already loaded two additional properties files that specify the locations of library and project jar files:</p>
<pre>jar=business_layer
libs=${lib.logging-log4j}:${lib.xerces}
depends=${proj.database_layer}</pre>
<p>The third step is to create a target for each project in your regular "build.xml" file. The target sets the "project" property and calls a target in "actions.xml":</p>
<pre> &lt;target name="database_layer"&gt;
  &lt;ant antfile="actions.xml" target="${target}"&gt;
   &lt;property name="project" value="database_layer" /&gt;
  &lt;/ant&gt;
 &lt;/target&gt;

 &lt;target name="business_layer" depends="database_layer"&gt;
  &lt;ant antfile="actions.xml" target="${target}"&gt;
   &lt;property name="project" value="business_layer" /&gt;
  &lt;/ant&gt;
 &lt;/target&gt;

 &lt;target name="web_interface" depends="business_layer"&gt;
  &lt;ant antfile="actions.xml" target="${target}"&gt;
   &lt;property name="project" value="web_interface" /&gt;
  &lt;/ant&gt;
 &lt;/target&gt;

 &lt;target name="swing_interface" depends="business_layer"&gt;
  &lt;ant antfile="actions.xml" target="${target}"&gt;
   &lt;property name="project" value="swing_interface" /&gt;
  &lt;/ant&gt;
 &lt;/target&gt;

 &lt;!-- Invoke the same target in all projects. --&gt;
 &lt;target name="all" depends="web_interface,swing_interface" /&gt;</pre>
<p>The fourth step is to define targets in build.xml that invoke the same action on all projects. These targets specify the dependencies among actions"</p>
<pre> &lt;!-- Get all projects. --&gt;
 &lt;target name="get"&gt;
  &lt;antcall target="all"&gt;
   &lt;param name="target" value="get" /&gt;
  &lt;/antcall&gt;
 &lt;/target&gt;

 &lt;!-- Compile all projects. --&gt;
 &lt;target name="compile" depends="get"&gt;
  &lt;antcall target="all"&gt;
   &lt;param name="target" value="compile" /&gt;
  &lt;/antcall&gt;
 &lt;/target&gt;

 &lt;!-- Jar all projects. --&gt;
 &lt;target name="jar" depends="compile"&gt;
  &lt;antcall target="all"&gt;
   &lt;param name="target" value="jar" /&gt;
  &lt;/antcall&gt;
 &lt;/target&gt;</pre>
<p>The designers of Ant probably never intended their tool to be used in this way, but it separates the actions from the projects. Now I can tweak an action for all projects in one place. Or I can add new projects and get all actions applied to it.</p>
				</div>

				<p class="postmetadata">Posted in <a href="indexfa64.html?cat=24" title="View all posts in Ant" rel="category">Ant</a>,  <a href="indexb0b7.html?cat=6" title="View all posts in Patterns" rel="category">Patterns</a> |   <a href="index5c90.html?p=35#comments" title="Comment on Separation of Concerns in Ant">1 Comment &#187;</a></p>

			</div>

				<div class="post">
				<h3 id="post-33"><a href="indexdd23.html?p=33" rel="bookmark" title="Permanent Link to Definitive Behavior">Definitive Behavior</a></h3>
				<small>Monday, September 18th, 2006</small>

				<div class="entry">
					<p>A constructor is often said to initialize an object. But in my experience I have found that constructors are much more than that. They are the first method to be called in an object's lifetime, and you can call only one. So these special methods have earned more respect than to be treated as mere initializers.</p>
<p>The word "initializer" implies that the method sets the initial value of member variables. It is assumed that these variables can change their values at any time. But if a constructor is an initializer, then it is merely a convenience. There is no difference, say, between these two pieces of code:</p>
<pre>Person person = new Person("Michael", "Perry);</pre>
<p>or</p>
<pre>Person person = new Person();
person.FirstName = "Michael";
person.LastName = "Perry";</pre>
<p>If there are two ways of expressing the same idea, then the object's interface is bloated (see <a href="indexc7e3.html?p=31">Necessary and Sufficient</a>). The constructor should only set a value only if it can be set in no other way. It's parameters should be those things that do not change over the course of an object's lifetime.</p>
<p>I have found that objects have three types of behavior. The kind that we are most familiar with is dynamic behavior: things that can be changed. A member variable represents dynamic behavior because I can change its value (and therefore the behavior of the object) at any time. The FirstName and LastName properties of the Person class in the above example are dynamic.</p>
<p>The second kind is dependent behavior: things that depend upon other things. Dependent behavior is usually manifested as read-only member functions. They don't change the object; they calculate some value based on the state that the object already has. We might add a read-only FullName property to the Person class that concatenates the first and last names.</p>
<p>The third kind is definitive behavior: things that don't change during an object's lifetime. An object is constructed with this behavior, and it will keep it until it is destroyed. These behaviors are represented as constructor parameters, and often as read-only properties ("getters"). If they are values, they are usually identifying attributes, such as database keys or IDs. But quite often they are references to objects of larger scope, such as a business object for a UI component, or a storage provider for a message queue.</p>
<p>The best practice I've found is to avoid overloaded constructors. Reserve the one and only constructor for definitive behavior. This clearly documents to the users of the class that you have only one chance to set these values. You can only call one constructor. Use it wisely.</p>
				</div>

				<p class="postmetadata">Posted in <a href="indexb0b7.html?cat=6" title="View all posts in Patterns" rel="category">Patterns</a> |   <a href="indexdd23.html?p=33#respond" title="Comment on Definitive Behavior">No Comments &#187;</a></p>

			</div>

				<div class="post">
				<h3 id="post-28"><a href="index3c55.html?p=28" rel="bookmark" title="Permanent Link to Separate Concerns">Separate Concerns</a></h3>
				<small>Thursday, September 7th, 2006</small>

				<div class="entry">
					<p>A spreadsheet contains both formulas and the data on which they operate. This makes it difficult to share formulas with someone else without sharing the data. If you want the same calculations performed on a different set of data, you have to make a copy of the spreadsheet. If you later need to update the calculations, you have to make the change in both places.</p>
<p>A Visual Source Safe database contains one tree of folders. A folder can represent a project, a package, a branch, or a shared library. Through discipline, programmers keep these different degrees of freedom on different levels of the tree. We will create a folder under a project to represent the trunk, and another to represent a branch. But what about branches of the shared libraries? Where do they go? Sometimes it is not easy to place one concern neatly below another.</p>
<p>An Ant build script contains several targets. A target can represent an action (clean, compile, deploy, etc.), or it can represent a project (shared library, business logic, web application, etc.). Targets depend upon other targets: deploy depends upon compile, and the web application depends upon the business logic. I need to clean and compile each of my projects, but only deploy my web applications. The web application deployment should include all dependent projects. When describing this to Ant, I end up with a cartesian product of actions for each project. If I later have to modify an action, I have to do so for every project. Similarly, to add a new project, I have to copy and paste all of the actions from another one.</p>
<p>All three of these scenarios suffer from a coupling of concerns. Different dimensions of the problem should be allowed to vary independently. But when the design of the solution mixes these dimensions, it becomes difficult to pull them apart later. Unfortunately, this sort of design flaw is usually not detected until the system has been in use for some time. Please take the time during the design phase to ask if yourself if you can separate concerns.</p>
				</div>

				<p class="postmetadata">Posted in <a href="indexfa64.html?cat=24" title="View all posts in Ant" rel="category">Ant</a>,  <a href="indexb0b7.html?cat=6" title="View all posts in Patterns" rel="category">Patterns</a>,  <a href="indexaa1e.html?cat=4" title="View all posts in VSS" rel="category">VSS</a> |   <a href="index3c55.html?p=28#comments" title="Comment on Separate Concerns">1 Comment &#187;</a></p>

			</div>

				<div class="post">
				<h3 id="post-27"><a href="index1c4a.html?p=27" rel="bookmark" title="Permanent Link to The Train-Switch Pattern">The Train-Switch Pattern</a></h3>
				<small>Tuesday, September 5th, 2006</small>

				<div class="entry">
					<p>I've often heard server maintenance compared to changing the tires on a truck going 80 miles an hour. You can't take down the datacenter to install a new build. You have to do it on the fly.</p>
<p>J2EE application servers like JBoss are supposed to be able to do this. However, in my experience, I've never seen it work reliably. We've had to fall back on using the load balancer to divert traffic away from one web server at a time in order to perform the upgrade. This is a costly and difficult chore. And if something goes wrong during the operation, you are without backup.</p>
<p>Since this is such a difficult problem, I've rewitten it -- in the true spirit of mathematics -- into one that is easier.  The computer system is not one big monolith, but many discrete transactions that each have a beginning and an end. No longer are we working on one huge semi, we are working on several small train cars, all hurtling down the same track at incredible speed.</p>
<p>The load balancer solution diverts the traffic without waiting for (or causing) a lull. But the problem with the load balancer solution is that it is performed on the socket boundary. Good socket optimizations -- like pooling, asynchronous communications, and multiplexing -- favor long-lived sockets. This means that the load balancer tends to take a long time to quiet the traffic to one machine. Sockets are also intrisicly hardware-oriented. A socket addresses an IP, which the router maps to a specific NIC. Any socket-based switching solution would place unnecessary constraints on the hardware required to run it. You can't, for example, scale it all the way down to 1 server. What we need is a switch on logical rather than physical boundaries.</p>
<p><strong>Here's my solution</strong><br />
I have started designing into my solutions a train-switch at the transaction boundary. As a request comes in (not a socket, but an individual request), I'll have an infrastructure component parse it and prepare it for the business logic. Then, it will look in a business logic registry to obtain the pointer to the current handler. That request is forwarded to the handler and the infrastructure listends for more requests.</p>
<p>What makes this a train-switch is that the infrastructure also has a background thread waiting for updates. I could detect these updates as new DLLs or JARs in a special folder, but I prefer explicit notification. When the update is available, the infrastructure loads it and gets it ready. Then, in one quick synchronized action, it replaces the pointer in the registry. Now all new requests are directed toward the new version of the business logic.</p>
<p>What happens to the requests already in progress? They continue unharmed. The train-switch is only at the head of the track. Both business logic components can run in parallel. The switch is made while the system is up with absolutely no interruption.</p>
<p>There are a few things that you need to do to make this possible. First, avoid singletons. Singletons are convenient, but you can't have two different versions of a singleton running in parallel. Instead, use dependency-injection. Instead of an object getting the instance of a singleton that it needs, give that object a pointer to its service provider. That way you tell it explicitly which instance it depends upon, and two can run in parallel with no problem.</p>
<p>Second, business components must be self-contained, except at the boundaries. If a business component reaches outside of itself for some dependencies, then you can no longer upgrade those dependencies. There are only two boundadies that the request may cross: the business entry point and the data access layer. Define an interface for the business entry point, and use dependency-injection to give the business logic access to the database connection pool.</p>
<p>Third, you need to have one entry point into the application. You can try to use the train-switch pattern to swap out socket listeners, but then you are back to the problems with the load-balancer solution. The socket boundary is bigger than the problem requires, so you will have old code running longer than is necessary. Also, the listener switch cannot be performed atomically. If you take down the first listener and then put up the second, there is a chance that a socket connection will be refused. If you try the opposite order, you will find the address already in use. The only way to achieve an atomic train-switch is to have one consistent listener that lives outside of the more volitile business logic.<br />
Fourth, define a loose interface for the business logic. Since the listener cannot be replaced, its contract with the business layer cannot be changed. So define a contract that is flexible enough to handle changes to business needs. Property bags work well on this boundary; strict business method or document definitions do not. You should definitely have a strict contract between the client and the server, but the train-switch is not the place to enforce it.</p>
<p>I'm not sure why applciation servers like JBoss fail so miserably at reliable "hot-swapping". The container implements the listener and calls servlets on request -- not socket -- boundaries. And servlets define an extremely flexible interface. Perhaps they have problems with external dependencies. At any rate, I find it best to inject dependencies across interface boundaries and implement the train-switch pattern myself.</p>
				</div>

				<p class="postmetadata">Posted in <a href="indexb0b7.html?cat=6" title="View all posts in Patterns" rel="category">Patterns</a> |   <a href="index1c4a.html?p=27#comments" title="Comment on The Train-Switch Pattern">2 Comments &#187;</a></p>

			</div>

		
		<div class="navigation">
			<div class="alignleft"><a href="indexd923.html?cat=6&amp;paged=6">&laquo; Previous Entries</a></div>
			<div class="alignright"><a href="index890d.html?cat=6&amp;paged=4">Next Entries &raquo;</a></div>
		</div>

	
	</div>
		</td>
	</tr>
</table>

<hr />
<div id="footer">
<!-- If you'd like to support WordPress, having the "powered by" link someone on your blog is the best way, it's our only promotion or advertising. -->
	<p>
		Adventures in Software is proudly powered by 
		<a href="http://wordpress.org/">WordPress</a>
		<br /><a href="indexd784.html?feed=rss2">Entries (RSS)</a>
		and <a href="indexa6da.html?feed=comments-rss2">Comments (RSS)</a>.
		<!-- 17 queries. 0.409 seconds. -->
	</p>
</div>
<script type="text/javascript">
var gaJsHost = (("https:" == document.location.protocol) ? "https://ssl." : "http://www.");
document.write(unescape("%3Cscript src='" + gaJsHost + "google-analytics.com/ga.js' type='text/javascript'%3E%3C/script%3E"));
</script>
<script type="text/javascript">
try {
var pageTracker = _gat._getTracker("UA-389401-3");
pageTracker._trackPageview();
} catch(err) {}</script></div>

<!-- Gorgeous design by Michael Heilemann - http://binarybonsai.com/kubrick/ -->

		<div id="sk2-footer" style="color:#FFF; background-color:#444; padding: 3px 2px 3px 2px; border-top: #888 solid 1px;">This blog is protected by <a href="http://unknowngenius.com/blog/" title="Dave">dr Dave</a>'s <strong><a href="http://unknowngenius.com/blog/wordpress/spam-karma/" title="SK2">Spam Karma 2</a></strong>: <strong>274531</strong>  Spams eaten and counting...</div><script type="text/javascript" src="replies.js"></script>
<script type="text/javascript" src="blogger.js"></script>
<script type="text/javascript" src="http://twitter.com/statuses/user_timeline/michaellperry.json?callback=twitterCallback2&amp;count=5"></script>
<script type="text/javascript" src="http://search.twitter.com/search.json?q=@michaellperry&amp;callback=twitterCallbackReplies&amp;rpp=5"></script>
</body>

<!-- Mirrored from adventuresinsoftware.com/blog/?cat=6&paged=5 by HTTrack Website Copier/3.x [XR&CO'2014], Fri, 13 Jan 2017 13:10:02 GMT -->
</html>
