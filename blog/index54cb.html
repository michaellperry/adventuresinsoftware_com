<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" dir="ltr">


<!-- Mirrored from adventuresinsoftware.com/blog/?cat=23 by HTTrack Website Copier/3.x [XR&CO'2014], Fri, 13 Jan 2017 12:55:52 GMT -->
<!-- Added by HTTrack --><meta http-equiv="content-type" content="text/html;charset=UTF-8" /><!-- /Added by HTTrack -->
<head profile="http://gmpg.org/xfn/11">
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8" />

<title>Adventures in Software   &raquo; Processes</title>

<meta name="generator" content="WordPress 2.3.3" /> <!-- leave this for stats -->

<link rel="stylesheet" href="wp-content/themes/ais2/style.css" type="text/css" media="screen" />
<link rel="alternate" type="application/rss+xml" title="Adventures in Software RSS Feed" href="indexd784.html?feed=rss2" />
<link rel="pingback" href="xmlrpc.html" />
    <script type="text/javascript">
        function onSilverlightError(sender, args) {
            var appSource = "";
            if (sender != null && sender != 0) {
              appSource = sender.getHost().Source;
            }
            
            var errorType = args.ErrorType;
            var iErrorCode = args.ErrorCode;

            if (errorType == "ImageError" || errorType == "MediaError") {
              return;
            }

            var errMsg = "Unhandled Error in Silverlight Application " +  appSource + "\n" ;

            errMsg += "Code: "+ iErrorCode + "    \n";
            errMsg += "Category: " + errorType + "       \n";
            errMsg += "Message: " + args.ErrorMessage + "     \n";

            if (errorType == "ParserError") {
                errMsg += "File: " + args.xamlFile + "     \n";
                errMsg += "Line: " + args.lineNumber + "     \n";
                errMsg += "Position: " + args.charPosition + "     \n";
            }
            else if (errorType == "RuntimeError") {           
                if (args.lineNumber != 0) {
                    errMsg += "Line: " + args.lineNumber + "     \n";
                    errMsg += "Position: " +  args.charPosition + "     \n";
                }
                errMsg += "MethodName: " + args.methodName + "     \n";
            }

            throw new Error(errMsg);
        }
    </script>

	<link rel="EditURI" type="application/rsd+xml" title="RSD" href="xmlrpc0db0.php?rsd" />
 <link rel="wlwmanifest" type="application/wlwmanifest+xml" href="wp-includes/wlwmanifest.xml" /> <style type='text/css'>
<!--#header { background: url('wp-content/themes/ais2/images/header-imgae03.html?upper=A7A73F&amp;lower=77773F') no-repeat bottom center; }
--></style>
</head>
<body>
<div id="page">

<div class="aisTopBar">
	<form method="get" id="searchform" action="http://adventuresinsoftware.com/blog/">
<div>
<a href="indexd784.html?feed=rss2"><img src="../images/feed-icon-28x28.png" border="0"></a>
<input type="text" value="" name="s" id="s" />
<input type="submit" id="searchsubmit" value="Search" />
</div>
</form>
</div>

<div class="aisHeaderImageRight">
	<div class="aisHeaderImage">
	<div class="aisHeaderCornerRight">
	<div class="aisHeaderCornerLeft">
	<div class="aisImageBar">
	<div class="aisSubSites">
		<a href="index.html" class="aisSubSiteLink"><span class="aisSiteTabRight"><span class="aisSiteTabLeft"><span class="aisSiteTab">
			home</span></span></span></a>
		<a class="aisSubSiteLink" href="indexb60a.html?cat=27"><span class="aisSiteTabRight"><span class="aisSiteTabLeft"><span class="aisSiteTab">
			historic modeling</span></span></span></a>
		<a class="aisSubSiteLink" href="indexa88f.html?cat=36"><span class="aisSiteTabRight"><span class="aisSiteTabLeft"><span class="aisSiteTab">
			update controls</span></span></span></a>
		<a href="index2d79.html?cat=26" class="aisSubSiteLink"><span class="aisSiteTabRight"><span class="aisSiteTabLeft"><span class="aisSiteTab">
			degrees of freedom</span></span></span></a>
		<a class="aisSubSiteLink" href="indexba53.html?page_id=2"><span class="aisSiteTabRight"><span class="aisSiteTabLeft"><span class="aisSiteTab">
			about us</span></span></span></a>

	</div>
	</div>
	</div>
	</div>
	</div>
</div>

<table style="width: 100%" cellspacing="0" cellpadding="0">
	<tr valign="top">
		<td width="210px">
<div id="sidebar">
<div class="aisLeftColumnFill">
<div class="aisLeftColumnBottom">
<div class="aisLeftColumnTop">
<div id="twitter_div" class="aisLeftNav">
<h2 class="sidebar-title">Twitter Updates</h2>
<ul id="twitter_update_list"></ul>
<a href="http://twitter.com/michaellperry" id="follow">Follow me</a>
</div>
<div id="twitter_reply_div" class="aisLeftNav">
<h2 class="sidebar-title">Twitter Replies</h2>
<ul id="twitter_reply_list"></ul>
</div>

<div class="aisLeftNav">
<a href='http://ineta.org/Speakers/SearchCommunitySpeakers.aspx?SpeakerId=c5110e21-9243-461b-a464-a6548524e885'><img alt='INETA Community Speakers Program' border='0' src='../../www.ineta.org/images/OfficialLogos/InetaCommunitySpeakersRequestMe.html' /></a>
</div>

<div class="aisLeftNav">
	<li class="pagenav"><h2>Pages</h2><ul><li class="page_item page-item-2"><a href="indexba53.html?page_id=2" title="About Us">About Us</a></li>
<li class="page_item page-item-210"><a href="index6ae3.html?page_id=210" title="Templates">Templates</a></li>
</ul></li></div>

<div class="aisLeftNav">
<h2>Archives</h2>
<ul>
	<li><a href='indexb4d5.html?m=201110' title='October 2011'>October 2011</a></li>
	<li><a href='indexc61a.html?m=201106' title='June 2011'>June 2011</a></li>
	<li><a href='indexa80d.html?m=201105' title='May 2011'>May 2011</a></li>
	<li><a href='index512b.html?m=201104' title='April 2011'>April 2011</a></li>
	<li><a href='index08fb.html?m=201103' title='March 2011'>March 2011</a></li>
	<li><a href='index52f4.html?m=201102' title='February 2011'>February 2011</a></li>
	<li><a href='index74f1.html?m=201101' title='January 2011'>January 2011</a></li>
	<li><a href='index8956.html?m=201012' title='December 2010'>December 2010</a></li>
	<li><a href='indexa1aa.html?m=201011' title='November 2010'>November 2010</a></li>
	<li><a href='indexe3d5.html?m=201010' title='October 2010'>October 2010</a></li>
	<li><a href='index9ab9.html?m=201009' title='September 2010'>September 2010</a></li>
	<li><a href='index1ff0.html?m=201008' title='August 2010'>August 2010</a></li>
	<li><a href='index9f11.html?m=201007' title='July 2010'>July 2010</a></li>
	<li><a href='index31f0.html?m=201006' title='June 2010'>June 2010</a></li>
	<li><a href='indexd189.html?m=201005' title='May 2010'>May 2010</a></li>
	<li><a href='indexb5c0.html?m=201004' title='April 2010'>April 2010</a></li>
	<li><a href='indexf258.html?m=201003' title='March 2010'>March 2010</a></li>
	<li><a href='index6e30.html?m=201002' title='February 2010'>February 2010</a></li>
	<li><a href='index6b19.html?m=201001' title='January 2010'>January 2010</a></li>
	<li><a href='index5c0a.html?m=200912' title='December 2009'>December 2009</a></li>
	<li><a href='index8f62.html?m=200911' title='November 2009'>November 2009</a></li>
	<li><a href='index451d.html?m=200910' title='October 2009'>October 2009</a></li>
	<li><a href='index3e04.html?m=200909' title='September 2009'>September 2009</a></li>
	<li><a href='index425a.html?m=200908' title='August 2009'>August 2009</a></li>
	<li><a href='index9907.html?m=200907' title='July 2009'>July 2009</a></li>
	<li><a href='index3104.html?m=200906' title='June 2009'>June 2009</a></li>
	<li><a href='indexc36d.html?m=200905' title='May 2009'>May 2009</a></li>
	<li><a href='index17e8.html?m=200904' title='April 2009'>April 2009</a></li>
	<li><a href='index10a5.html?m=200903' title='March 2009'>March 2009</a></li>
	<li><a href='index8988.html?m=200902' title='February 2009'>February 2009</a></li>
	<li><a href='index1419.html?m=200901' title='January 2009'>January 2009</a></li>
	<li><a href='index7866.html?m=200812' title='December 2008'>December 2008</a></li>
	<li><a href='index55f6.html?m=200811' title='November 2008'>November 2008</a></li>
	<li><a href='indexa7bc.html?m=200810' title='October 2008'>October 2008</a></li>
	<li><a href='indexe77c.html?m=200809' title='September 2008'>September 2008</a></li>
	<li><a href='indexcffc.html?m=200808' title='August 2008'>August 2008</a></li>
	<li><a href='index0e62.html?m=200807' title='July 2008'>July 2008</a></li>
	<li><a href='indexfda7.html?m=200806' title='June 2008'>June 2008</a></li>
	<li><a href='index7d64.html?m=200805' title='May 2008'>May 2008</a></li>
	<li><a href='index94dd.html?m=200804' title='April 2008'>April 2008</a></li>
	<li><a href='index9631.html?m=200803' title='March 2008'>March 2008</a></li>
	<li><a href='indexdd52.html?m=200802' title='February 2008'>February 2008</a></li>
	<li><a href='index21ee.html?m=200801' title='January 2008'>January 2008</a></li>
	<li><a href='index363c.html?m=200712' title='December 2007'>December 2007</a></li>
	<li><a href='index7493.html?m=200711' title='November 2007'>November 2007</a></li>
	<li><a href='index93a7.html?m=200710' title='October 2007'>October 2007</a></li>
	<li><a href='index4ca8.html?m=200709' title='September 2007'>September 2007</a></li>
	<li><a href='index6124.html?m=200708' title='August 2007'>August 2007</a></li>
	<li><a href='index6013.html?m=200707' title='July 2007'>July 2007</a></li>
	<li><a href='index2ab6.html?m=200706' title='June 2007'>June 2007</a></li>
	<li><a href='index44f0.html?m=200705' title='May 2007'>May 2007</a></li>
	<li><a href='indexf0b4.html?m=200704' title='April 2007'>April 2007</a></li>
	<li><a href='index481d.html?m=200703' title='March 2007'>March 2007</a></li>
	<li><a href='indexcbea.html?m=200702' title='February 2007'>February 2007</a></li>
	<li><a href='index9cdc.html?m=200701' title='January 2007'>January 2007</a></li>
	<li><a href='index3ea4.html?m=200612' title='December 2006'>December 2006</a></li>
	<li><a href='index67ca.html?m=200611' title='November 2006'>November 2006</a></li>
	<li><a href='indexff49.html?m=200610' title='October 2006'>October 2006</a></li>
	<li><a href='index611c.html?m=200609' title='September 2006'>September 2006</a></li>
	<li><a href='index9a21.html?m=200608' title='August 2006'>August 2006</a></li>
	<li><a href='index3ee9.html?m=200607' title='July 2006'>July 2006</a></li>
	<li><a href='indexe13a.html?m=200606' title='June 2006'>June 2006</a></li>
</ul>
</div>

<div class="aisLeftNav">
	</div>

<div class="aisLeftNav">
<h2>Books</h2>
<iframe src="http://rcm.amazon.com/e/cm?t=adventures0d2-20&amp;o=1&amp;p=8&amp;l=as1&amp;asins=0764526413&amp;fc1=000000&amp;IS2=1&amp;lt1=_blank&amp;lc1=0000ff&amp;bc1=000000&amp;bg1=ffffff&amp;f=ifr" style="width:120px;height:240px;" scrolling="no" marginwidth="0" marginheight="0" frameborder="0" name="I5" id="I5"></iframe>
<br/>
<iframe src="http://rcm.amazon.com/e/cm?t=adventures0d2-20&amp;o=1&amp;p=8&amp;l=as1&amp;asins=0201633612&amp;fc1=000000&amp;IS2=1&amp;lt1=_blank&amp;lc1=0000ff&amp;bc1=000000&amp;bg1=ffffff&amp;f=ifr" style="width:120px;height:240px;" scrolling="no" marginwidth="0" marginheight="0" frameborder="0" name="I6" id="I6"></iframe>
<br/>
<iframe src="http://rcm.amazon.com/e/cm?t=adventures0d2-20&amp;o=1&amp;p=8&amp;l=as1&amp;asins=0136291554&amp;fc1=000000&amp;IS2=1&amp;lt1=_blank&amp;lc1=0000ff&amp;bc1=000000&amp;bg1=ffffff&amp;f=ifr" style="width:120px;height:240px;" scrolling="no" marginwidth="0" marginheight="0" frameborder="0" name="I7" id="I7"></iframe>
<br/>
<iframe src="http://rcm.amazon.com/e/cm?t=adventures0d2-20&amp;o=1&amp;p=8&amp;l=as1&amp;asins=1888009195&amp;fc1=000000&amp;IS2=1&amp;lt1=_blank&amp;lc1=0000ff&amp;bc1=000000&amp;bg1=ffffff&amp;f=ifr" style="width:120px;height:240px;" scrolling="no" marginwidth="0" marginheight="0" frameborder="0" name="I8" id="I8"></iframe>
</div>
<div class="aisLeftNav">
<h2>Meta</h2>
<ul>
		<li><a href="wp-login.html">Login</a></li>
	<li><a href="http://validator.w3.org/check/referer" title="This page validates as XHTML 1.0 Transitional">Valid <abbr title="eXtensible HyperText Markup Language">XHTML</abbr></a></li>
	<li><a href="http://gmpg.org/xfn/"><abbr title="XHTML Friends Network">XFN</abbr></a></li>
	<li><a href="http://wordpress.org/" title="Powered by WordPress, state-of-the-art semantic personal publishing platform.">WordPress</a></li>
	</ul>
</div>
<div class="aisLeftContent">
<h2>Community</h2>
<ul>
	<script type="text/javascript" src="../../localhost/embed/92q2bbma.js"></script>
</ul>
</div>

</div></div></div>
</div>		</td>
		<td>

	<div id="content" class="narrowcolumn">

		
		 		<h2 class="pagetitle">Archive for the &#8216;Processes&#8217; Category</h2>

 	  

		<div class="navigation">
			<div class="alignleft"><a href="indexfcd9.html?cat=23&amp;paged=2">&laquo; Previous Entries</a></div>
			<div class="alignright"></div>
		</div>

				<div class="post">
				<h3 id="post-485"><a href="indexca96.html?p=485" rel="bookmark" title="Permanent Link to Expression of Intent">Expression of Intent</a></h3>
				<small>Monday, March 8th, 2010</small>

				<div class="entry">
					<p>This weekend I worked on the <a href="http://historicmodeling.com/book/factual" target="_blank">Factual</a> language parser. I started with a brute-force recursive descent parser, but ended up with something more elegant. The final product expresses the intent better than the original code did. It is easier to maintain, and easier to extend. You can follow along with the <a href="http://correspondence.codeplex.com/SourceControl/list/changesets">changesets on Codeplex</a>. Here’s how I did it.</p>
<p><strong>Step 1: Make it work</strong>     <br />The goal was to create a parser for a known language. It was not to create a framework for any language that you could throw at it. My constraints were well defined:</p>
<ul>
<li>Parse the Factual language </li>
<li>Produce an Abstract Syntax Tree </li>
<li>Work within an open source license </li>
</ul>
<p>These constraints defined my solution. Since I am working on an open source project, I did not want to take a dependency upon a proprietary parser generator. And since I knew the language that I was parsing, I was able to choose parser patterns that fit that language.</p>
<p>It would be foolish to take on this project without knowing the theory of compiler design. I have seen too many ad-hoc parsers created by people who did not do their research. The mistakes that they made could have easily been avoided. “Make it work” does not mean throwing together the simplest thing that would work. It means think it through, but go straight at the problem. Persistence is no substitute for understanding.</p>
<p>Knowing the theory, I knew that my language as defined was LL(4). It is unambiguous with a lookahead of only 4 tokens. I also knew that with a slight modification, I could transform it into an LL(1) grammar. This kind of grammar is easily parsable using recursive descent.</p>
<p>I started with this unit test:</p>
<pre>[<span style="color: #2b91af">TestMethod</span>]
<span style="color: blue">public</span> <span style="color: blue">void</span> WhenNamespaceHasNoDot_NamepaceIsRecognized()
{
    <span style="color: #2b91af">Parser</span> parser = <span style="color: blue">new</span> <span style="color: #2b91af">Parser</span>(<span style="color: blue">new</span> <span style="color: #2b91af">StringReader</span>(<span style="color: maroon">&quot;namespace GameModel;&quot;</span>));
    <span style="color: #2b91af">Namespace</span> result = parser.Parse();
    <span style="color: #2b91af">Pred</span>.Assert(result.Identifier, <span style="color: #2b91af">Is</span>.EqualTo(<span style="color: maroon">&quot;GameModel&quot;</span>));
    <span style="color: #2b91af">Pred</span>.Assert(result.LineNumber, <span style="color: #2b91af">Is</span>.EqualTo(<span style="color: maroon">1</span>));
}</pre>
<p>I did not write this code, as some proponents of TDD would recommend:</p>
<pre><span style="color: blue">public</span> <span style="color: #2b91af">Namespace</span> Parse()
{
    <span style="color: blue">return</span> <span style="color: blue">new</span> <span style="color: #2b91af">Namespace</span>(<span style="color: maroon">&quot;GameModel&quot;</span>, <span style="color: maroon">1</span>);
}</pre>
<p>Instead, I wrote this:</p>
<pre><span style="color: blue">public</span> <span style="color: #2b91af">Namespace</span> Parse()
{
    <span style="color: #2b91af">Consume</span>();
    <span style="color: #2b91af">Namespace</span> namespaceNode = MatchNamespace();
    <span style="color: blue">return</span> namespaceNode;
}

<span style="color: blue">private</span> <span style="color: #2b91af">Namespace</span> MatchNamespace()
{
    <span style="color: #2b91af">Token</span> namespaceToken = Expect(<span style="color: #2b91af">Symbol</span>.Namespace, <span style="color: maroon">&quot;Add a 'namespace' declaration.&quot;</span>);

    <span style="color: blue">if</span> (Lookahead.Symbol != <span style="color: #2b91af">Symbol</span>.Identifier)
        <span style="color: blue">throw</span> <span style="color: blue">new</span> <span style="color: #2b91af">FactualException</span>(<span style="color: maroon">&quot;Provide a dotted identifier for the namespace.&quot;</span>, <span style="color: #2b91af">Lookahead</span>.LineNumber);
    <span style="color: blue">string</span> namespaceIdentifier = MatchDottedIdentifier();

    Expect(<span style="color: #2b91af">Symbol</span>.Semicolon, <span style="color: maroon">&quot;Terminate the namespace declaration with a semicolon.&quot;</span>);

    <span style="color: blue">return</span> <span style="color: blue">new</span> <span style="color: #2b91af">Namespace</span>(namespaceIdentifier, namespaceToken.LineNumber);
}</pre>
<p>That first method would have made the test pass, but it represents none of the understanding of the problem space. I find it better to capture that understanding in code as soon as possible, rather than writing a foolish method that I will throw away later.</p>
<p>After getting it working, I had a suite of unit tests. Each subsequent step was performed while keeping that same test suite passing.</p>
<p><strong>Step 2: Clean up the working code</strong> </p>
<p>It bothered me that MatchNamespace knew that MatchDottedIdentifier expected an Identifier. So I did a quick refactoring to move that knowledge closer to the right place.</p>
<pre><span style="color: blue">private</span> <span style="color: #2b91af">Namespace</span> MatchNamespace()
{
    ...

    <span style="color: blue">if</span> (<strong>!StartOfDottedIdentifier()</strong>)
        <span style="color: blue">throw</span> <span style="color: blue">new</span> <span style="color: #2b91af">FactualException</span>(<span style="color: maroon">&quot;Provide a dotted identifier for the namespace.&quot;</span>, Lookahead.LineNumber);
    <span style="color: blue">string</span> namespaceIdentifier = MatchDottedIdentifier();

    ...
}

<span style="color: blue">private</span> <span style="color: blue">bool</span> StartOfDottedIdentifier()
{
    <span style="color: blue">return</span> Lookahead.Symbol == <span style="color: #2b91af">Symbol</span>.Identifier;
}

<span style="color: blue">private</span> <span style="color: blue">string</span> MatchDottedIdentifier()
{
    <span style="color: #2b91af">StringBuilder</span> result = <span style="color: blue">new</span> <span style="color: #2b91af">StringBuilder</span>();

    <span style="color: #2b91af">Token</span> idenifier = Expect(<span style="color: #2b91af">Symbol</span>.Identifier, <span style="color: maroon">&quot;Begin with an identifier.&quot;</span>);
    result.Append(idenifier.Value);

    ...
}</pre>
<p><strong>Step 3: Find the patterns</strong> </p>
<p>After cleaning the code in a similar way in several places, I noticed that there were Start and Match pairs for almost every rule. I compared this with my knowledge of parsers, and found that it is a valid generalization.</p>
<p>In an LL(1) grammar, you can calculate the First and Follow sets of every production. The First set is the set of tokens that could appear at the beginning of the production. The Follow set is the set that could appear after the production has been reduced. I recognized that Start represented the First set. The Follow set is useful for generating the First set (First includes Follow if the production could be empty), but was not strictly required for my grammar.</p>
<p>Having discovered that pattern, I extracted a common interface (actually an abstract base class).</p>
<pre><span style="color: blue">public</span> <span style="color: blue">abstract</span> <span style="color: blue">class</span> <span style="color: #2b91af">Rule</span>&lt;T&gt;
{
    <span style="color: blue">public</span> <span style="color: blue">abstract</span> <span style="color: blue">bool</span> Start(<span style="color: #2b91af">Symbol</span> symbol);
    <span style="color: blue">public</span> <span style="color: blue">abstract</span> T Match(<span style="color: #2b91af">TokenStream</span> tokenStream);
}</pre>
<p>I implemented this interface with one derived class per production.</p>
<p><strong>Step 4: Find the common intent</strong> </p>
<p>Several of the rules had a common structure. They each called a sequence of other rules in turn. Each time, they would check the Start, and then call Match. This commonality was not accidental. Each of these rules intended to represent a sequence. They only differed in which sequence, and what was done with it. So I factored out that intent.</p>
<pre><span style="color: blue">public</span> <span style="color: blue">class</span> <span style="color: #2b91af">RuleSequence3</span>&lt;<span style="color: #2b91af">T1</span>, <span style="color: #2b91af">T2</span>, <span style="color: #2b91af">T3</span>, <span style="color: #2b91af">T</span>&gt; : <span style="color: #2b91af">Rule</span>&lt;<span style="color: #2b91af">T</span>&gt;
{
    <span style="color: blue">private</span> <span style="color: #2b91af">Rule</span>&lt;<span style="color: #2b91af">T1</span>&gt; _rule1;
    <span style="color: blue">private</span> <span style="color: #2b91af">Rule</span>&lt;<span style="color: #2b91af">T2</span>&gt; _rule2;
    <span style="color: blue">private</span> <span style="color: blue">string</span> _error2;
    <span style="color: blue">private</span> <span style="color: #2b91af">Rule</span>&lt;<span style="color: #2b91af">T3</span>&gt; _rule3;
    <span style="color: blue">private</span> <span style="color: blue">string</span> _error3;
    <span style="color: blue">private</span> <span style="color: #2b91af">Func</span>&lt;<span style="color: #2b91af">T1</span>, <span style="color: #2b91af">T2</span>, <span style="color: #2b91af">T3</span>, <span style="color: #2b91af">T</span>&gt; _reduce;

    <span style="color: blue">public</span> <span style="color: #2b91af">RuleSequence3</span>(<span style="color: #2b91af">Rule</span>&lt;<span style="color: #2b91af">T1</span>&gt; rule1, <span style="color: #2b91af">Rule</span>&lt;<span style="color: #2b91af">T2</span>&gt; rule2, <span style="color: blue">string</span> error2, <span style="color: #2b91af">Rule</span>&lt;<span style="color: #2b91af">T3</span>&gt; rule3, <span style="color: blue">string</span> error3, <span style="color: #2b91af">Func</span>&lt;<span style="color: #2b91af">T1</span>, <span style="color: #2b91af">T2</span>, <span style="color: #2b91af">T3</span>, <span style="color: #2b91af">T</span>&gt; reduce)
    {
        _rule1 = rule1;
        _rule2 = rule2;
        _error2 = error2;
        _rule3 = rule3;
        _error3 = error3;
        _reduce = reduce;
    }

    <span style="color: blue">public</span> <span style="color: blue">override</span> <span style="color: blue">bool</span> Start(<span style="color: #2b91af">Symbol</span> symbol)
    {
        <span style="color: blue">return</span> _rule1.Start(symbol);
    }

    <span style="color: blue">public</span> <span style="color: blue">override</span> <span style="color: #2b91af">T</span> Match(<span style="color: #2b91af">TokenStream</span> tokenStream)
    {
        <span style="color: #2b91af">T1</span> value1 = _rule1.Match(tokenStream);

        <span style="color: blue">if</span> (!_rule2.Start(tokenStream.Lookahead.Symbol))
            <span style="color: blue">throw</span> <span style="color: blue">new</span> <span style="color: #2b91af">FactualException</span>(_error2, tokenStream.Lookahead.LineNumber);
        <span style="color: #2b91af">T2</span> value2 = _rule2.Match(tokenStream);

        <span style="color: blue">if</span> (!_rule3.Start(tokenStream.Lookahead.Symbol))
            <span style="color: blue">throw</span> <span style="color: blue">new</span> <span style="color: #2b91af">FactualException</span>(_error3, tokenStream.Lookahead.LineNumber);
        <span style="color: #2b91af">T3</span> value3 = _rule3.Match(tokenStream);

        <span style="color: blue">return</span> _reduce(value1, value2, value3);
    }
}</pre>
<p><strong>Step 5: Express the intent<br />
    <br /></strong>Now that rules can be built from the outside rather than coded from within, I had the opportunity to create a fluent interface. The code that uses this interface expresses the grammar of the language, rather than the steps required to parse it. The resulting code reads like a specification rather than an implementation.</p>
<pre><span style="color: green">// dotted_identifier -&gt; identifier (&quot;.&quot; identifier)*</span>
<span style="color: green">// namespace_declaration -&gt; &quot;namespace&quot; dotted_identifier &quot;;&quot;</span>
var dottedIdentifier = Separated(
    Terminal(<span style="color: #2b91af">Symbol</span>.Identifier),
    <span style="color: #2b91af">Symbol</span>.Dot,
    identifier =&gt; <span style="color: blue">new</span> <span style="color: #2b91af">StringBuilder</span>().Append(identifier.Value),
    (stringBuilder, identifier) =&gt; stringBuilder.Append(<span style="color: maroon">&quot;.&quot;</span>).Append(identifier.Value));
var namespaceRule = Sequence(
    Terminal(<span style="color: #2b91af">Symbol</span>.Namespace),
    dottedIdentifier, <span style="color: maroon">&quot;Provide a dotted identifier for the namespace.&quot;</span>,
    Terminal(<span style="color: #2b91af">Symbol</span>.Semicolon), <span style="color: maroon">&quot;Terminate the namespace declaration with a semicolon.&quot;</span>,
    (namespaceToken, identifier, ignored) =&gt; <span style="color: blue">new</span> <span style="color: #2b91af">Namespace</span>(identifier.ToString(), namespaceToken.LineNumber));</pre>
<p>I find that this code is much easier to maintain and extend. The engineering of getting the parser right has been done once. Additional productions can take advantage of that engineering, so that simple mistakes are avoided. The goal was no reuse, but in the end I had created a reusable parser generator.</p>
<p>I might have been able to go straight there, but only at the risk of over engineering the solution. By refactoring my way from a working system toward an expression of intent, I was able to bring in just the theory that this particular problem requires. I know the limitations of my parser, and I can live within them.</p>
				</div>

				<p class="postmetadata">Posted in <a href="index54cb.html?cat=23" title="View all posts in Processes" rel="category">Processes</a> |   <a href="indexca96.html?p=485#respond" title="Comment on Expression of Intent">No Comments &#187;</a></p>

			</div>

				<div class="post">
				<h3 id="post-459"><a href="index6595.html?p=459" rel="bookmark" title="Permanent Link to The Proportional Change Principle">The Proportional Change Principle</a></h3>
				<small>Thursday, October 29th, 2009</small>

				<div class="entry">
					<p>The change in the solution should be proportional to the change in the problem.</p>
<p><strong>Demoware</strong><br />Have you ever attended one of these demos? "No code required!" "Drag and drop!" "It's automagic!"</p>
<p>The presenter points and clicks his way through a canned problem and creates a solution extremely rapidly. He data binds to an Access database. He lays out a report. He generates a web site directly from tables. Then he walks off stage.</p>
<p>If you've tried to use VB 6 data binding or Dynamic Data in a production system, you know the problem with demoware. It only works for a simple problem. Once the problem becomes complex, the demoware does not work. Your only recourse is to rewrite.</p>
<p>If you were to plot the total amount of work against features, you might see something like this:</p>
<p><a href="wp-content/uploads/2009/10/rewrite.jpg"><img style="border-top-width: 0px; border-left-width: 0px; border-bottom-width: 0px; border-right-width: 0px" height="500" alt="Rewrite" src="wp-content/uploads/2009/10/rewrite-thumb.jpg" width="660" border="0"></a> </p>
<p>The slope of the line before the rewrite, when you were relying upon automagic demoware,&nbsp; is fairly constant. Each new feature you added required you to drag a new column onto the designer. Not only is it easy to perform each change, each change is roughly the same size.</p>
<p>The slope of the line after the rewrite is also fairly constant. Here you are no longer using the automagic demoware framework. You have switched to a production-ready framework. Even though have to actually write code for each feature, the amount of code per feature is about the same. Moreover, since you've learned the new framework and the pattern that it demands, it's really not that hard to write that code. The slope is steeper than it was with the automagic demoware, but at least it's constant.</p>
<p><strong>Up front design</strong><br />Let's imagine that we skipped that demo and instead designed the infrastructure that our problem demands. Our total effort vs. features might look like this:</p>
<p><a href="wp-content/uploads/2009/10/design.jpg"><img style="border-top-width: 0px; border-left-width: 0px; border-bottom-width: 0px; border-right-width: 0px" height="500" alt="Design" src="wp-content/uploads/2009/10/design-thumb.jpg" width="660" border="0"></a> </p>
<p>We spend significantly more hours before we can deliver the first feature. But once we do, the effort per new feature is constant. We avoid the big rewrite cliff because we create a framework that can handle all of features that we'll need to write. We don't know ahead of time what all those features will be, but we do know that our chosen framework will handle whatever we throw at it.</p>
<p>I evaluate everything from the principle of Proportional Change. When the problem changes a little, I should only need a small change in the solution. Big changes in the solution should only occur when there are big changes in the problem. I've found that many things violate this principle, not just demoware. Here's a few more examples:</p>
<ul>
<li>YAGNI - Yes, you really are gonna need it.</li>
<li>Refactoring to a design - Small steps cannot always get you to your goal.</li>
<li>Code generation</li>
<li>Event-driven code</li>
</ul>
				</div>

				<p class="postmetadata">Posted in <a href="index54cb.html?cat=23" title="View all posts in Processes" rel="category">Processes</a> |   <a href="index6595.html?p=459#respond" title="Comment on The Proportional Change Principle">No Comments &#187;</a></p>

			</div>

				<div class="post">
				<h3 id="post-320"><a href="indexe513.html?p=320" rel="bookmark" title="Permanent Link to Excel as Specification">Excel as Specification</a></h3>
				<small>Thursday, April 9th, 2009</small>

				<div class="entry">
					<p>I used to work with engineers. These are people who, like me, think in equations. Until moving on to other domains, I never realized just how lucky I was to work with these people.</p>
<p>A common practice among the engineers was to try out new analysis methods in Excel. It was really easy to put in some data, graph it, write equations against it, and iterate over the problem. If you needed to find a root, "Goal Seek" was right there. If you needed something more powerful, you could drop down into VBA.</p>
<p>On more than one occasion, I received an Excel worksheet along with the instruction to "make the program do this." Those were some of the easiest specifications to follow. First, the math was right there; it just had to be translated from Excel to C++. Second, test data could be plugged into both systems, and their results compared. And third, if there was a problem, I could always go back to the engineer and ask questions while pointing to the worksheet.</p>
<p>Fast forward to today. I'm working for business people, not engineers. They use Excel, but not in the same way. They think in numbers, not equations. Their specifications are written in a different Office product, are less precise, and are not executable.</p>
<p><strong>Turning it around</strong><br /><a href="wp-content/uploads/2009/04/inputsandoutputs6.png"><img style="border-right: 0px; border-top: 0px; border-left: 0px; border-bottom: 0px" height="225" alt="InputsAndOutputs" src="wp-content/uploads/2009/04/inputsandoutputs-thumb1.png" width="469" align="right" border="0"></a> Since my customer is not going to give me an Excel worksheet, I decided to give one to them. I received a Word document describing some complex interactions among several pieces of data. Some were coming from our ERP system (Baan), some from a site administrator, and some from the user. Many of the fields had different names, depending upon who was looking at it. Some of the rules were contradictory, others were ambiguous, and a few were missing. After several mutually frustrating conversations with the business trying to understand this spec, I took matters into my own hands.</p>
<p>I created an Excel worksheet that has all of the inputs and outputs. These are organized according to the UI screens on which they appear, and are named according to the spec. Database and code names are not used.</p>
<p>Using this worksheet, the business can try out different scenarios and determine whether it does what they expect. If not, they can point to the worksheet and tell me what it should do. It may be asking too much for this group to fix the spreadsheet themselves, but at least we have a precise and executable communication tool.</p>
				</div>

				<p class="postmetadata">Posted in <a href="index54cb.html?cat=23" title="View all posts in Processes" rel="category">Processes</a> |   <a href="indexe513.html?p=320#respond" title="Comment on Excel as Specification">No Comments &#187;</a></p>

			</div>

				<div class="post">
				<h3 id="post-229"><a href="index4580.html?p=229" rel="bookmark" title="Permanent Link to AiS 41: Scrum Doesn&#8217;t Suck">AiS 41: Scrum Doesn&#8217;t Suck</a></h3>
				<small>Friday, March 28th, 2008</small>

				<div class="entry">
					<p><a href="http://media.libsyn.com/media/ais/AiS41.mp3">Listen Now</a></p>
<p><a href="http://www.ddj.com/architect/206501655" title="Agile is Relative" id="l_g6">Agile is Relative</a> by Scott Ambler.<br id="wp_r" /><a href="http://agilemanifesto.org/" title="The Agile Manifesto" id="pd8d">The Agile Manifesto</a>.<br id="docz" /><a href="http://en.wikipedia.org/wiki/Scrum_(development)" title="Scrum on Wikipedia" id="qriy">Scrum on Wikipedia</a>.<br id="pmg:" /></p>
				</div>

				<p class="postmetadata">Posted in <a href="index9035.html?cat=22" title="View all posts in Agile" rel="category">Agile</a>,  <a href="index54cb.html?cat=23" title="View all posts in Processes" rel="category">Processes</a>,  <a href="indexb5e7.html?cat=15" title="View all posts in Shows" rel="category">Shows</a> |   <a href="index4580.html?p=229#respond" title="Comment on AiS 41: Scrum Doesn&#8217;t Suck">No Comments &#187;</a></p>

			</div>

				<div class="post">
				<h3 id="post-219"><a href="index50f6.html?p=219" rel="bookmark" title="Permanent Link to Joint application design">Joint application design</a></h3>
				<small>Thursday, March 13th, 2008</small>

				<div class="entry">
					<p>Despite all expectations, today was incredibly productive.</p>
<p>I've been meeting with the other partners in this large integration project to try to reach some consensus. The grand-client has scheduled these &quot;joint application design sessions&quot;. Sounds suspiciously like design-by-committee.</p>
<p><strong>Off to a bad start</strong>    <br />I flew into town yesterday thinking that we were not far enough along in the project to have anything useful to share with each other. We're supposed to be jointly designing this application, but we haven't even nailed down the business requirements.</p>
<p>Because of a delayed flight, I missed yesterday's session and ended up in a project planning meeting (see yesterday's post). I heard from others present that there was not much content that pertained to us. Then I heard from the PM that we would be &quot;observers&quot; in the sessions for the next two days. That did not set the stage well.</p>
<p>Nevertheless, I decided to go in and make the most of it. Being the BA, I had with me a nice long list of open issues. I'm keeping these issues in an Access database tagged by functional area so I could quickly query for the questions I needed to ask at each point. Since the business requirements are not yet complete, most of these were business questions.</p>
<p><strong>Unexpected progress</strong>    <br />It turned out that we were better prepared than I thought. The other partners were similarly prepared, and everyone had business questions to get resolved. These are issues that have been open for months. We could not reach consensus with email or conference calls. But get everyone in a room, uncomfortable, with a limited amount of time, and things got done.</p>
<p>After closing many of my open issues, and assigning a few more to various people as action items, we were able to settle into more technical discussions. We agreed upon a high-level data interchange design and required data elements, with XML schemas to be provided within a week.</p>
<p>We were not mere observers. We had answers that they needed, and they had answers that we needed. And this was not design-by-committee. Instead of a lukewarm mixture of everybody's ideas, we each identified our own unique place in the system.</p>
<p>So don't underestimate the value of getting partners together. In just a few hours, you can accomplish what months worth of emails just can't get done. And even though design-by-committee yields mediocre results, integration of system requires some integration of teams.</p>
				</div>

				<p class="postmetadata">Posted in <a href="index54cb.html?cat=23" title="View all posts in Processes" rel="category">Processes</a> |   <a href="index50f6.html?p=219#respond" title="Comment on Joint application design">No Comments &#187;</a></p>

			</div>

				<div class="post">
				<h3 id="post-218"><a href="index5034.html?p=218" rel="bookmark" title="Permanent Link to Visit with the grand-client">Visit with the grand-client</a></h3>
				<small>Wednesday, March 12th, 2008</small>

				<div class="entry">
					<p>I'm traveling again, but this time not for fun like the ODC. This is work. I'm traveling to represent one of SSG's clients to one of <em>their</em> clients. The &quot;grand-client&quot;, if you will. SSG has asked that I don't blog company names, but you'd know them if I told you.</p>
<p><strong>A tale of two cultures</strong>     <br />The grand-client has a very comprehensive software development lifecycle. It grew out of their Y2K effort. The process is heavy, but it helps them to mitigate risk.</p>
<p>My client, on the other hand, has been trying to define their process. Traditionally, they use RUP, but have had issues in the past with generating useful documentation from this process. They've evaluated agile, but could not get it to work within their corporate culture. Most recently, they've described their process as &quot;agile RUP&quot;. I'm sure that such a combination could be achieved, but this seems more like a compromise than an actual plan.</p>
<p>This is a large integration project. The grand-client has identified several partners that will work together to create a new product offering, my client being just one of them.</p>
<p>The grand-client is running this project by tracking each of the partners with their own methodology. Instead of expecting deliverables from each provider at certain milestones, they are integrating the project plans.</p>
<p><strong>Project management tooling</strong>     <br />The project management tools couldn't be more different. The grand-client uses a centralized task management system. Engineers enter time against these tasks, and the tool compares those against the plan to automatically update the schedule.</p>
<p>On the other hand, my client manages everything with Microsoft Project. Engineers enter time against milestones, not tasks. The project is manually updated at status meetings, not automatically based on the time entry system.</p>
<p>The goal from the grand-client's point of view is to create a synergy of processes. They want to map all of the artifacts in the client's process into their own process. With that mapping, they can measure all partner's progress with their own tool, and identify each one's impact on other partner's schedules.</p>
<p>This might be a brilliant way of managing a project of this scale. Or it might be a train-wreck in progress. Either way, I expect to learn quite a bit from this engagement.</p>
				</div>

				<p class="postmetadata">Posted in <a href="index54cb.html?cat=23" title="View all posts in Processes" rel="category">Processes</a> |   <a href="index5034.html?p=218#respond" title="Comment on Visit with the grand-client">No Comments &#187;</a></p>

			</div>

				<div class="post">
				<h3 id="post-216"><a href="index4659.html?p=216" rel="bookmark" title="Permanent Link to Microsoft Project(or)">Microsoft Project(or)</a></h3>
				<small>Tuesday, March 4th, 2008</small>

				<div class="entry">
					<p>I just left a project planning meeting in which Microsoft Project was projected on the wall. As often happens in these kinds of meetings, the project manager walked through the tasks and milestones and edited dates and dependencies as we talked. As also often happens, the participants zoned out while the PM tweaked the schedule.</p>
<p>To break from tradition, as well as monotony, the technical lead stood up and went to the whiteboard on the opposite side of the room. There he drew a calendar and laid out the plan. It was very telling that we turned our attention away from the Gantt chart and toward the calendar. Microsoft Project does not communicate, whereas a hand-drawn calendar does.</p>
<p>Once we all had agreed on the schedule, the lead turned it back over to the PM. The PM updated Project to match the calendar while the rest of us wrapped up. Because the lead took the initiative, we had a productive planning meeting. Microsoft Project may be a useful tool for project management, but it should never be projected.</p>
				</div>

				<p class="postmetadata">Posted in <a href="index54cb.html?cat=23" title="View all posts in Processes" rel="category">Processes</a> |   <a href="index4659.html?p=216#comments" title="Comment on Microsoft Project(or)">1 Comment &#187;</a></p>

			</div>

				<div class="post">
				<h3 id="post-201"><a href="index5721.html?p=201" rel="bookmark" title="Permanent Link to Doing things badly with SharePoint">Doing things badly with SharePoint</a></h3>
				<small>Monday, January 28th, 2008</small>

				<div class="entry">
					<p>I'm currently recovering from the <a href="http://infusion.com/sleepless">Infusion Sleepless Roadshow</a>, where we collectively hacked SharePoint beyond recognition. I've recorded some interesting conversations, and I'll be bringing those to you very shortly. But in the mean time, let me tell you what I've learned about SharePoint.</p>
<p>You've probably used SharePoint as a document management system. It's a fantastic repository for Word documents. It handles organization, security, and versioning out-of-the-box. But for most organizations (including mine), that is all that SharePoint is used for: a shared folder with benefits.</p>
<p>What I learned this weekend is that Microsoft's vision for SharePoint is so much larger. It has a workflow engine that can track a work item through a long-running business process. It has Office integration beyond the publishing capabilities we've all used, including custom task panes and ribbons. And it has all the customizability that you need to create fantastic looking public-facing sites.</p>
<p>The problem is that not many people know how to do these things with SharePoint. Or, rather, that's the opportunity. This event demonstrates that it is possible to create a brand new web application overnight ... literally. And the people who can do that are in high demand.</p>
<p><strong>Think differently</strong><br />
Before the competition, we had 12 hours of intense training. During this training, one thing became quite clear. SharePoint development is not like your typical application development. You have to approach the problem from a completely different angle.</p>
<p>In typical application development, you'll set up a code-build-deploy cycle from the beginning. Developers will go through several small iterations of this cycle every day. A slightly longer version of the cycle pushes weekly builds to QA. And an even longer cycle promotes releases to production.</p>
<p>In SharePoint, many of the development artifacts are in the site itself. You add custom lists to define new data types. You build workflows directly within the site. You create web part pages in place. And finally, you package all of this up as a template.</p>
<p>So just like a spreadsheet where cells contain either data or functions, code artifacts are intermingled with data. It is common practice to put pages into lists, along side documents and items. Furthermore, there is no apparent difference between the list and the type of data it contains. You add columns to the list in order to define its "type". Finally, you define workflows within a site so that they have access to those columns. It is difficult to separate code from data in order to deploy.</p>
<p><strong>In search of the repeatable process</strong><br />
I like the repeatable process of the code-build-deploy cycle. During the training, there were glimpses of this cycle when they showed Visual Studio projects that produced WSP files. There is an event that you can handle within your code to provision a site upon deployment. If used properly, I'm sure that a repeatable process could be achieved.</p>
<p>During the competition, however, I found that this is not easy. I wasted three hours of our precious time fighting with Visual Studio, IIS, and SharePoint to get this process to work. I finally abandoned this effort in order to help my team.</p>
<p>So if you remember what SharePoint is good at, you can do quite well. Don't look to SharePoint as a typical development platform. It is a place where your application can grow up gradually over time. It can get your site up and running with a very small investment, and then expand it to add more features. Maybe that's not the "right" way to develop software, but it satisfies a business need. As G. K. Chesterton famously wrote: "Anything worth doing is worth doing badly."</p>
				</div>

				<p class="postmetadata">Posted in <a href="index54cb.html?cat=23" title="View all posts in Processes" rel="category">Processes</a>,  <a href="indexaeb3.html?cat=29" title="View all posts in SharePoint" rel="category">SharePoint</a> |   <a href="index5721.html?p=201#comments" title="Comment on Doing things badly with SharePoint">5 Comments &#187;</a></p>

			</div>

				<div class="post">
				<h3 id="post-200"><a href="indexdc0d.html?p=200" rel="bookmark" title="Permanent Link to AiS 38: Use Cases">AiS 38: Use Cases</a></h3>
				<small>Thursday, January 24th, 2008</small>

				<div class="entry">
					<p><a href="http://media.libsyn.com/media/ais/AiS38.mp3">Listen Now</a></p>
<p>Ivar Jacobson codified <a href="http://en.wikipedia.org/wiki/Use_case" title="Use Case" id="nvxg">Use Case</a> Analysis in 1986 as a way of expressing functional requirements. Since that time, the technique has been improved and formalized. It is now part of the <a href="http://en.wikipedia.org/wiki/Rational_Unified_Process" title="Rational Unified Process" id="jhb8">Rational Unified Process</a>.</p>
<p>Why should I write use cases?</p>
<ol>
<li>Use Cases help the systems analyst or software designer to understand the system under construction.</li>
<li>Help customers understand the system being built.  Users can validate that the use cases are correct.</li>
<li>Use cases are an easy to understand and interpret way of communication the functionality of a system to an implementor.</li>
</ol>
<p>What goes into a use case?</p>
<ol>
<li>The name of the use case</li>
<li>An identification number that will uniquely identify the use case.  This number WILL NOT CHANGE, even if the use case is modified or deleted.  This is important for tracking history.</li>
<li>Actor - What actor or actors are going to be the focus of this use case?</li>
<li>Goal - What is the end result of this use case.</li>
<li>Preconditions - What must already be true about the actor or system before this use case is valid.</li>
<li>Triggers - What triggers this use case?  A user inserting their ATM card?  The predetermined nightly batch processing time?  etc.</li>
<li>The Success Path - What happens when everything goes right with this use case.  This description should start with the trigger and tell the story of how the state of the target system changes.</li>
<li>Alternate Paths - This section talks about what can go wrong and how the system will respond to those error conditions.</li>
<li>Post Conditions - This describes what state the system will be in once the use case has been executed to completion.</li>
<li>Business Rules - Call out any business rules that apply to this use case.  <font color="#3366ff">(RE:  I'm not sure about this one...I got this from Wikipedia...not sure I like it)</font></li>
</ol>
<p>What is the scope of a use case?</p>
<p>How does a use case compare to a <a href="http://martinfowler.com/bliki/UseCasesAndStories.html" title="story" id="l2of">story</a> in agile methodologies like Scrum?<br />
<a href="http://www.mountaingoatsoftware.com/article_view/27-advantages-of-user-stories-for-requirements" title="Advantages of User Stories" id="dscf">Advantages of User Stories</a><br />
Do I have to choose one or the other?</p>
<p>Should I strive for 100% feature coverage with use cases?</p>
<p>As a developer, if my company doesn't perform use case analysis, can I write use cases on my own?</p>
<p>When you have all of your use cases, what next?  (discussion about dynamic behavior running through static strcuture)</p>
<p>Good Links:<br />
<a href="http://readysetpro.com/whitepapers/usecasetut.html">Use Case Tutorial</a></p>
<p>Update<br />
We've started a <a href="index6ae3.html?page_id=210">document template library</a>. There you can find the Use Case template that we promised you.</p>
				</div>

				<p class="postmetadata">Posted in <a href="index54cb.html?cat=23" title="View all posts in Processes" rel="category">Processes</a>,  <a href="indexb5e7.html?cat=15" title="View all posts in Shows" rel="category">Shows</a> |   <a href="indexdc0d.html?p=200#respond" title="Comment on AiS 38: Use Cases">No Comments &#187;</a></p>

			</div>

				<div class="post">
				<h3 id="post-192"><a href="index5a6a.html?p=192" rel="bookmark" title="Permanent Link to Entity Fact Diagrams">Entity Fact Diagrams</a></h3>
				<small>Thursday, January 17th, 2008</small>

				<div class="entry">
					<p><a href="indexb7c7.html?p=177">Historic modeling</a> is the technique of representing a solution as a history of discrete events. This differs from static modeling, which represents the solution as a snapshot. The static model is concerned with the state of the system, whereas the historic model is more concerned with how it got there.</p>
<p>A historic model can be represented in an Entity Fact diagram. This is analogous to the Entity Relationship diagram used in static models. The difference is that you represent historic facts instead of static relationships. Relationships can change over time, but facts are always true.</p>
<p><strong>Automotive Wireless</strong><br />
I am currently working on an automotive wireless system that provides an excellent example of an Entity Fact diagram. This system tracks wireless devices such as OnStar modules that are installed in vehicles. The entities in this domain are things like the phone number (MDN/MIN), the wireless unit, the vehicle, the customer, and the service. We can draw an ERD to represent the relationships among these entities.</p>
<p><a href="../../www.adventuresinsoftware.com/blog/wp-content/uploads/2008/01/auto_erd.png"><img src="../../www.adventuresinsoftware.com/blog/wp-content/uploads/2008/01/auto-erd-thumb.png" style="border-width: 0px" alt="auto_erd" border="0" height="77" width="503" /></a></p>
<p>In this ERD, we represent entities as rectangles, relationships as diamonds, and properties as ellipses. We are particularly concerned with the status of a wireless account (active, suspended, inactive, etc.) and the status of a wireless device (scrap, replacement, defective, etc.) The account status is a property of the relationship between phone number and device.</p>
<p>In this ERD, relationships can come and go. A unit can be removed from a vehicle and a replacement installed. A customer can enroll in a service, and later cancel their subscription. In a typical static model, these relationships are created and destroyed to represent the current state.</p>
<p><strong>Expand to an EFD</strong><br />
To model the system historically, we make note of all the events that could occur. Each of these events is one fact: it occurred at some point in time. Whether the effect of that event is still present is less important. The fact is, and always will be, that it happened.</p>
<p>The facts in this system are things like:</p>
<ul>
<li>An MDN/MIN was paired with a unit.</li>
<li>The MDN/MIN pairing was removed (the account was closed).</li>
<li>A customer took delivery of a vehicle.</li>
<li>A customer enrolled in a service for a vehicle.</li>
<li>A service enrollment was canceled.</li>
</ul>
<p>There are many others as well. Here is the complete diagram.</p>
<p><a href="../../www.adventuresinsoftware.com/blog/wp-content/uploads/2008/01/auto_efd.png"><img src="../../www.adventuresinsoftware.com/blog/wp-content/uploads/2008/01/auto-efd-thumb.png" style="border-width: 0px" alt="auto_efd" border="0" height="180" width="491" /></a></p>
<p>You'll notice that these facts usually relate two or more entities. In fact, they usually create or destroy relationships between those entities. When one fact modifies the effect of another fact, it references the original. So, for example, an Unpairing destroys the relationship established by a Pairing.</p>
<p><strong>Prerequisites</strong><br />
A fact cannot exist until its referenced entities exist. An MDN/MIN must be assigned by the phone company before it can be paired with the MEID of a device. Both the vehicle and the customer must exist before the customer can take delivery of the vehicle.</p>
<p>This prerequisite relationship is also true for facts. An MDN/MIN pairing must occur before they can be unpaired. A customer must take delivery of a vehicle before enrolling in services for that vehicle. So the arrows not only indicate references, but also define a partial order. The referenced fact must occur before the referencing fact.</p>
<p><strong>Atomicity</strong><br />
Facts are either true or not. The event has either occurred or it hasn't. There is no intermediate state.</p>
<p>Notice the history formed by Manufacture and Replacement. A vehicle is manufactured with one unit. At some time later, that unit is replaced with another unit. The replacement destroys the vehicle-unit relationship created by the manufacture, and <strong>simultaneously creates another relationship</strong>. That replacement unit can later be replaced by yet another replacement unit, and so on.</p>
<p><strong>The source of truth</strong><br />
This ERD is color coded to indicate the source of each of these facts. Blue facts come from the phone company, green from the device supplier, and red from the auto manufacturer. This helps us see interactions between various parties. We can see, for example, that the device supplier can't tell us that a pairing will not be used until the phone company tells us that it exists. This helps us see that we have to wait for the phone company to tell us that the number is paired before we send an unpairing request, thus avoiding a race condition.</p>
<p>Whether the program is written historically, an Entity Fact Diagram can help us capture important information. It is more complete than the ERD alone, as it shows all the ways in which relationships can come and go. It helps us communicate the order in which events can occur, and gives us guidance on transaction scope and system interactions.</p>
				</div>

				<p class="postmetadata">Posted in <a href="indexb60a.html?cat=27" title="View all posts in Historic Modeling" rel="category">Historic Modeling</a>,  <a href="index54cb.html?cat=23" title="View all posts in Processes" rel="category">Processes</a> |   <a href="index5a6a.html?p=192#respond" title="Comment on Entity Fact Diagrams">No Comments &#187;</a></p>

			</div>

		
		<div class="navigation">
			<div class="alignleft"><a href="indexfcd9.html?cat=23&amp;paged=2">&laquo; Previous Entries</a></div>
			<div class="alignright"></div>
		</div>

	
	</div>
		</td>
	</tr>
</table>

<hr />
<div id="footer">
<!-- If you'd like to support WordPress, having the "powered by" link someone on your blog is the best way, it's our only promotion or advertising. -->
	<p>
		Adventures in Software is proudly powered by 
		<a href="http://wordpress.org/">WordPress</a>
		<br /><a href="indexd784.html?feed=rss2">Entries (RSS)</a>
		and <a href="indexa6da.html?feed=comments-rss2">Comments (RSS)</a>.
		<!-- 17 queries. 0.397 seconds. -->
	</p>
</div>
<script type="text/javascript">
var gaJsHost = (("https:" == document.location.protocol) ? "https://ssl." : "http://www.");
document.write(unescape("%3Cscript src='" + gaJsHost + "google-analytics.com/ga.js' type='text/javascript'%3E%3C/script%3E"));
</script>
<script type="text/javascript">
try {
var pageTracker = _gat._getTracker("UA-389401-3");
pageTracker._trackPageview();
} catch(err) {}</script></div>

<!-- Gorgeous design by Michael Heilemann - http://binarybonsai.com/kubrick/ -->

		<div id="sk2-footer" style="color:#FFF; background-color:#444; padding: 3px 2px 3px 2px; border-top: #888 solid 1px;">This blog is protected by <a href="http://unknowngenius.com/blog/" title="Dave">dr Dave</a>'s <strong><a href="http://unknowngenius.com/blog/wordpress/spam-karma/" title="SK2">Spam Karma 2</a></strong>: <strong>274531</strong>  Spams eaten and counting...</div><script type="text/javascript" src="replies.js"></script>
<script type="text/javascript" src="blogger.js"></script>
<script type="text/javascript" src="http://twitter.com/statuses/user_timeline/michaellperry.json?callback=twitterCallback2&amp;count=5"></script>
<script type="text/javascript" src="http://search.twitter.com/search.json?q=@michaellperry&amp;callback=twitterCallbackReplies&amp;rpp=5"></script>
</body>

<!-- Mirrored from adventuresinsoftware.com/blog/?cat=23 by HTTrack Website Copier/3.x [XR&CO'2014], Fri, 13 Jan 2017 12:55:52 GMT -->
</html>
