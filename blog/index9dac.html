<?xml version="1.0" encoding="UTF-8"?><!-- generator="wordpress/2.3.3" -->
<rss version="2.0"
	xmlns:content="http://purl.org/rss/1.0/modules/content/"
	xmlns:dc="http://purl.org/dc/elements/1.1/"
	>
<channel>
	<title>Comments on: Visualize project dependencies in Visual Studio</title>
	<link>http://adventuresinsoftware.com/blog/?p=285</link>
	<description>Lessons learned on the road to quality computing</description>
	<pubDate>Fri, 13 Jan 2017 12:57:20 +0000</pubDate>
	<generator>http://wordpress.org/?v=2.3.3</generator>
		<item>
		<title>By: Michael L Perry</title>
		<link>http://adventuresinsoftware.com/blog/?p=285#comment-212099</link>
		<dc:creator>Michael L Perry</dc:creator>
		<pubDate>Fri, 13 Jan 2012 02:23:47 +0000</pubDate>
		<guid>http://adventuresinsoftware.com/blog/?p=285#comment-212099</guid>
		<description>Hi, Tim. I haven't tried this macro on C++ projects, so I can't promise that it works. But I don't think there is anything language specific in the macro. Can you debug and step through it to see where it goes wrong?</description>
		<content:encoded><![CDATA[<p>Hi, Tim. I haven't tried this macro on C++ projects, so I can't promise that it works. But I don't think there is anything language specific in the macro. Can you debug and step through it to see where it goes wrong?</p>
]]></content:encoded>
	</item>
	<item>
		<title>By: tim</title>
		<link>http://adventuresinsoftware.com/blog/?p=285#comment-211985</link>
		<dc:creator>tim</dc:creator>
		<pubDate>Thu, 12 Jan 2012 11:21:13 +0000</pubDate>
		<guid>http://adventuresinsoftware.com/blog/?p=285#comment-211985</guid>
		<description>Hello Michael,

Does your macro also work for C++-solutions. I tried yours and Stuart's solution, but no .dot file was generated when running the macro neither in visual studio's macro editor nor when selecting the solution in the solution explorer and running a shortcut for the macro. Any ideas?


Cheers,
Tim</description>
		<content:encoded><![CDATA[<p>Hello Michael,</p>
<p>Does your macro also work for C++-solutions. I tried yours and Stuart's solution, but no .dot file was generated when running the macro neither in visual studio's macro editor nor when selecting the solution in the solution explorer and running a shortcut for the macro. Any ideas?</p>
<p>Cheers,<br />
Tim</p>
]]></content:encoded>
	</item>
	<item>
		<title>By: Bon</title>
		<link>http://adventuresinsoftware.com/blog/?p=285#comment-199215</link>
		<dc:creator>Bon</dc:creator>
		<pubDate>Tue, 15 Nov 2011 09:26:44 +0000</pubDate>
		<guid>http://adventuresinsoftware.com/blog/?p=285#comment-199215</guid>
		<description>Thank you for for this article</description>
		<content:encoded><![CDATA[<p>Thank you for for this article</p>
]]></content:encoded>
	</item>
	<item>
		<title>By: Michael L Perry</title>
		<link>http://adventuresinsoftware.com/blog/?p=285#comment-141696</link>
		<dc:creator>Michael L Perry</dc:creator>
		<pubDate>Thu, 14 Apr 2011 15:12:11 +0000</pubDate>
		<guid>http://adventuresinsoftware.com/blog/?p=285#comment-141696</guid>
		<description>Bojan,

Please share the changes you made to the dot files. How did you make it look better?</description>
		<content:encoded><![CDATA[<p>Bojan,</p>
<p>Please share the changes you made to the dot files. How did you make it look better?</p>
]]></content:encoded>
	</item>
	<item>
		<title>By: Bojan</title>
		<link>http://adventuresinsoftware.com/blog/?p=285#comment-141292</link>
		<dc:creator>Bojan</dc:creator>
		<pubDate>Wed, 13 Apr 2011 15:57:36 +0000</pubDate>
		<guid>http://adventuresinsoftware.com/blog/?p=285#comment-141292</guid>
		<description>Found the way - edited the produced files, they have solid documentation on GraphViz project site.
Good stuff, produced an awesome graph from the solution with 20 something projects. :D
Thanks once again. 
:)</description>
		<content:encoded><![CDATA[<p>Found the way - edited the produced files, they have solid documentation on GraphViz project site.<br />
Good stuff, produced an awesome graph from the solution with 20 something projects. <img src='http://adventuresinsoftware.com/blog/wp-includes/images/smilies/icon_biggrin.gif' alt=':D' class='wp-smiley' /><br />
Thanks once again.<br />
 <img src='http://adventuresinsoftware.com/blog/wp-includes/images/smilies/icon_smile.gif' alt=':)' class='wp-smiley' /></p>
]]></content:encoded>
	</item>
	<item>
		<title>By: Bojan</title>
		<link>http://adventuresinsoftware.com/blog/?p=285#comment-141259</link>
		<dc:creator>Bojan</dc:creator>
		<pubDate>Wed, 13 Apr 2011 13:25:11 +0000</pubDate>
		<guid>http://adventuresinsoftware.com/blog/?p=285#comment-141259</guid>
		<description>Works in Visual Studio 2010 as well. Thanks a lot! 

Any ideas how to make it look a bit nicer? :)

Anyway, good stuff... Cheers.</description>
		<content:encoded><![CDATA[<p>Works in Visual Studio 2010 as well. Thanks a lot! </p>
<p>Any ideas how to make it look a bit nicer? <img src='http://adventuresinsoftware.com/blog/wp-includes/images/smilies/icon_smile.gif' alt=':)' class='wp-smiley' /> </p>
<p>Anyway, good stuff... Cheers.</p>
]]></content:encoded>
	</item>
	<item>
		<title>By: Stuart</title>
		<link>http://adventuresinsoftware.com/blog/?p=285#comment-44463</link>
		<dc:creator>Stuart</dc:creator>
		<pubDate>Fri, 04 Sep 2009 02:51:27 +0000</pubDate>
		<guid>http://adventuresinsoftware.com/blog/?p=285#comment-44463</guid>
		<description>If you have solution folders then this code will not work. I hacked it to work using code below:
Imports System
Imports EnvDTE
Imports EnvDTE80
Imports EnvDTE90
Imports System.Diagnostics
Imports VSLangProj
Imports System.IO

Public Module Module2

    Public Sub ProjectDependency()

        Dim file As Integer
        Dim writer As New StreamWriter(DTE.Solution.FileName &#38; ".dot")

        writer.WriteLine("digraph """ &#38; DTE.Solution.FullName &#38; """ {")
        writer.WriteLine("  rankdir=LR")

        For Each project As Project In DTE.Solution.Projects
            NavProj(project, writer)
        Next

        writer.WriteLine("}")
        writer.Dispose()
    End Sub

    Sub NavProj(ByVal proj As Project, ByVal writer As StreamWriter)
        Dim outputPathProperty As EnvDTE.Property
        Dim outputPath As String
        Dim vsProject As VSProject

        If Not (proj.ConfigurationManager Is Nothing) Then
            ' It's a project!
            outputPathProperty = proj.ConfigurationManager.ActiveConfiguration.Properties.Item("OutputPath")
            If Not (outputPathProperty Is Nothing) Then
                vsProject = TryCast(proj.Object, VSProject)
                If Not vsProject Is Nothing Then
                    For Each reference As Reference In vsProject.References
                        If Not reference.SourceProject Is Nothing Then
                            writer.WriteLine("  """ &#38; proj.Name &#38; """-&#62;""" &#38; reference.SourceProject.Name &#38; """")
                        End If
                    Next
                End If
            End If
        Else
            NavProjItems(proj.ProjectItems, writer)
        End If
    End Sub
    Sub NavProjItems(ByVal projItems As ProjectItems, ByVal writer As StreamWriter)
        Dim projectItem As EnvDTE.ProjectItem

        If Not (projItems Is Nothing) Then
            For Each projectItem In projItems
                If Not (projectItem.SubProject Is Nothing) Then
                    ' Recurse, can be an Enterprise project in 
                    ' Visual Studio .NET 2002/2003 or a solution folder in VS 2005
                    NavProj(projectItem.SubProject, writer)
                End If
            Next
        End If
    End Sub

End Module</description>
		<content:encoded><![CDATA[<p>If you have solution folders then this code will not work. I hacked it to work using code below:<br />
Imports System<br />
Imports EnvDTE<br />
Imports EnvDTE80<br />
Imports EnvDTE90<br />
Imports System.Diagnostics<br />
Imports VSLangProj<br />
Imports System.IO</p>
<p>Public Module Module2</p>
<p>    Public Sub ProjectDependency()</p>
<p>        Dim file As Integer<br />
        Dim writer As New StreamWriter(DTE.Solution.FileName &amp; ".dot")</p>
<p>        writer.WriteLine("digraph """ &amp; DTE.Solution.FullName &amp; """ {")<br />
        writer.WriteLine("  rankdir=LR")</p>
<p>        For Each project As Project In DTE.Solution.Projects<br />
            NavProj(project, writer)<br />
        Next</p>
<p>        writer.WriteLine("}")<br />
        writer.Dispose()<br />
    End Sub</p>
<p>    Sub NavProj(ByVal proj As Project, ByVal writer As StreamWriter)<br />
        Dim outputPathProperty As EnvDTE.Property<br />
        Dim outputPath As String<br />
        Dim vsProject As VSProject</p>
<p>        If Not (proj.ConfigurationManager Is Nothing) Then<br />
            ' It's a project!<br />
            outputPathProperty = proj.ConfigurationManager.ActiveConfiguration.Properties.Item("OutputPath")<br />
            If Not (outputPathProperty Is Nothing) Then<br />
                vsProject = TryCast(proj.Object, VSProject)<br />
                If Not vsProject Is Nothing Then<br />
                    For Each reference As Reference In vsProject.References<br />
                        If Not reference.SourceProject Is Nothing Then<br />
                            writer.WriteLine("  """ &amp; proj.Name &amp; """-&gt;""" &amp; reference.SourceProject.Name &amp; """")<br />
                        End If<br />
                    Next<br />
                End If<br />
            End If<br />
        Else<br />
            NavProjItems(proj.ProjectItems, writer)<br />
        End If<br />
    End Sub<br />
    Sub NavProjItems(ByVal projItems As ProjectItems, ByVal writer As StreamWriter)<br />
        Dim projectItem As EnvDTE.ProjectItem</p>
<p>        If Not (projItems Is Nothing) Then<br />
            For Each projectItem In projItems<br />
                If Not (projectItem.SubProject Is Nothing) Then<br />
                    ' Recurse, can be an Enterprise project in<br />
                    ' Visual Studio .NET 2002/2003 or a solution folder in VS 2005<br />
                    NavProj(projectItem.SubProject, writer)<br />
                End If<br />
            Next<br />
        End If<br />
    End Sub</p>
<p>End Module</p>
]]></content:encoded>
	</item>
	<item>
		<title>By: Michael L Perry</title>
		<link>http://adventuresinsoftware.com/blog/?p=285#comment-41247</link>
		<dc:creator>Michael L Perry</dc:creator>
		<pubDate>Fri, 21 Aug 2009 22:17:22 +0000</pubDate>
		<guid>http://adventuresinsoftware.com/blog/?p=285#comment-41247</guid>
		<description>Chris,

It looks like you didn't have any projects that reference other projects in your solution. References to outside assemblies are not captured.

The generated file should have some arrows in it, like this:

digraph "C:\svn_repos\branches\path\to\solution\SolutionName.sln" {
rankdir=LR
ProjectA-&gt;ProjectB
ProjectA-&gt;ProjectC
ProjectB-&gt;ProjectC
}

ProjectA, ProjectB, and ProjectC are all in the same sln.</description>
		<content:encoded><![CDATA[<p>Chris,</p>
<p>It looks like you didn't have any projects that reference other projects in your solution. References to outside assemblies are not captured.</p>
<p>The generated file should have some arrows in it, like this:</p>
<p>digraph "C:\svn_repos\branches\path\to\solution\SolutionName.sln" {<br />
rankdir=LR<br />
ProjectA->ProjectB<br />
ProjectA->ProjectC<br />
ProjectB->ProjectC<br />
}</p>
<p>ProjectA, ProjectB, and ProjectC are all in the same sln.</p>
]]></content:encoded>
	</item>
	<item>
		<title>By: Chris</title>
		<link>http://adventuresinsoftware.com/blog/?p=285#comment-41084</link>
		<dc:creator>Chris</dc:creator>
		<pubDate>Thu, 20 Aug 2009 15:54:17 +0000</pubDate>
		<guid>http://adventuresinsoftware.com/blog/?p=285#comment-41084</guid>
		<description>I'm having a few problems as well.  I *think* it's working on the VS side, but I'm not sure what the results should look like.  I'm not familiar with GraphViz at all, and that actually may be where the problem is.  I did the following on VS08:  
Step 1: New Macro Project (named: ProjectReferenceMap)
Step 2: Renamed Module1 to CreateFile
Step 3: Double click it, opens new instance
Step 4: Copy/Paste your code into it, save
Step 5: Click F5/Green Arrow
Step 6: Generates a SolutionFileName.sln.dot file in the same directory as the solution file itself.
I opened up the .dot file it generated as this is what it put out.
digraph "C:\svn_repos\branches\path\to\solution\SolutionName.sln" {
  rankdir=LR
}

I tried opening GraphViz -&#62; GVedit.exe and opened the generated .dot file into it, clicked the Run button, and all it created was a small white box of an image.

I'm not sure where I went wrong, any help would be greatly appreciated.</description>
		<content:encoded><![CDATA[<p>I'm having a few problems as well.  I *think* it's working on the VS side, but I'm not sure what the results should look like.  I'm not familiar with GraphViz at all, and that actually may be where the problem is.  I did the following on VS08:<br />
Step 1: New Macro Project (named: ProjectReferenceMap)<br />
Step 2: Renamed Module1 to CreateFile<br />
Step 3: Double click it, opens new instance<br />
Step 4: Copy/Paste your code into it, save<br />
Step 5: Click F5/Green Arrow<br />
Step 6: Generates a SolutionFileName.sln.dot file in the same directory as the solution file itself.<br />
I opened up the .dot file it generated as this is what it put out.<br />
digraph "C:\svn_repos\branches\path\to\solution\SolutionName.sln" {<br />
  rankdir=LR<br />
}</p>
<p>I tried opening GraphViz -&gt; GVedit.exe and opened the generated .dot file into it, clicked the Run button, and all it created was a small white box of an image.</p>
<p>I'm not sure where I went wrong, any help would be greatly appreciated.</p>
]]></content:encoded>
	</item>
	<item>
		<title>By: Michael L Perry</title>
		<link>http://adventuresinsoftware.com/blog/?p=285#comment-35782</link>
		<dc:creator>Michael L Perry</dc:creator>
		<pubDate>Sat, 01 Aug 2009 14:56:59 +0000</pubDate>
		<guid>http://adventuresinsoftware.com/blog/?p=285#comment-35782</guid>
		<description>Strange. I developed this macro in VS 2008. Can you tell me what it's doing?</description>
		<content:encoded><![CDATA[<p>Strange. I developed this macro in VS 2008. Can you tell me what it's doing?</p>
]]></content:encoded>
	</item>
</channel>
</rss>
