<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" dir="ltr">


<!-- Mirrored from adventuresinsoftware.com/blog/?m=200812 by HTTrack Website Copier/3.x [XR&CO'2014], Fri, 13 Jan 2017 12:46:36 GMT -->
<!-- Added by HTTrack --><meta http-equiv="content-type" content="text/html;charset=UTF-8" /><!-- /Added by HTTrack -->
<head profile="http://gmpg.org/xfn/11">
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8" />

<title>Adventures in Software   &raquo; 2008&raquo; December</title>

<meta name="generator" content="WordPress 2.3.3" /> <!-- leave this for stats -->

<link rel="stylesheet" href="wp-content/themes/ais2/style.css" type="text/css" media="screen" />
<link rel="alternate" type="application/rss+xml" title="Adventures in Software RSS Feed" href="indexd784.html?feed=rss2" />
<link rel="pingback" href="xmlrpc.html" />
    <script type="text/javascript">
        function onSilverlightError(sender, args) {
            var appSource = "";
            if (sender != null && sender != 0) {
              appSource = sender.getHost().Source;
            }
            
            var errorType = args.ErrorType;
            var iErrorCode = args.ErrorCode;

            if (errorType == "ImageError" || errorType == "MediaError") {
              return;
            }

            var errMsg = "Unhandled Error in Silverlight Application " +  appSource + "\n" ;

            errMsg += "Code: "+ iErrorCode + "    \n";
            errMsg += "Category: " + errorType + "       \n";
            errMsg += "Message: " + args.ErrorMessage + "     \n";

            if (errorType == "ParserError") {
                errMsg += "File: " + args.xamlFile + "     \n";
                errMsg += "Line: " + args.lineNumber + "     \n";
                errMsg += "Position: " + args.charPosition + "     \n";
            }
            else if (errorType == "RuntimeError") {           
                if (args.lineNumber != 0) {
                    errMsg += "Line: " + args.lineNumber + "     \n";
                    errMsg += "Position: " +  args.charPosition + "     \n";
                }
                errMsg += "MethodName: " + args.methodName + "     \n";
            }

            throw new Error(errMsg);
        }
    </script>

	<link rel="EditURI" type="application/rsd+xml" title="RSD" href="xmlrpc0db0.php?rsd" />
 <link rel="wlwmanifest" type="application/wlwmanifest+xml" href="wp-includes/wlwmanifest.xml" /> <style type='text/css'>
<!--#header { background: url('wp-content/themes/ais2/images/header-imgae03.html?upper=A7A73F&amp;lower=77773F') no-repeat bottom center; }
--></style>
</head>
<body>
<div id="page">

<div class="aisTopBar">
	<form method="get" id="searchform" action="http://adventuresinsoftware.com/blog/">
<div>
<a href="indexd784.html?feed=rss2"><img src="../images/feed-icon-28x28.png" border="0"></a>
<input type="text" value="" name="s" id="s" />
<input type="submit" id="searchsubmit" value="Search" />
</div>
</form>
</div>

<div class="aisHeaderImageRight">
	<div class="aisHeaderImage">
	<div class="aisHeaderCornerRight">
	<div class="aisHeaderCornerLeft">
	<div class="aisImageBar">
	<div class="aisSubSites">
		<a href="index.html" class="aisSubSiteLink"><span class="aisSiteTabRight"><span class="aisSiteTabLeft"><span class="aisSiteTab">
			home</span></span></span></a>
		<a class="aisSubSiteLink" href="indexb60a.html?cat=27"><span class="aisSiteTabRight"><span class="aisSiteTabLeft"><span class="aisSiteTab">
			historic modeling</span></span></span></a>
		<a class="aisSubSiteLink" href="indexa88f.html?cat=36"><span class="aisSiteTabRight"><span class="aisSiteTabLeft"><span class="aisSiteTab">
			update controls</span></span></span></a>
		<a href="index2d79.html?cat=26" class="aisSubSiteLink"><span class="aisSiteTabRight"><span class="aisSiteTabLeft"><span class="aisSiteTab">
			degrees of freedom</span></span></span></a>
		<a class="aisSubSiteLink" href="indexba53.html?page_id=2"><span class="aisSiteTabRight"><span class="aisSiteTabLeft"><span class="aisSiteTab">
			about us</span></span></span></a>

	</div>
	</div>
	</div>
	</div>
	</div>
</div>

<table style="width: 100%" cellspacing="0" cellpadding="0">
	<tr valign="top">
		<td width="210px">
<div id="sidebar">
<div class="aisLeftColumnFill">
<div class="aisLeftColumnBottom">
<div class="aisLeftColumnTop">
<div id="twitter_div" class="aisLeftNav">
<h2 class="sidebar-title">Twitter Updates</h2>
<ul id="twitter_update_list"></ul>
<a href="http://twitter.com/michaellperry" id="follow">Follow me</a>
</div>
<div id="twitter_reply_div" class="aisLeftNav">
<h2 class="sidebar-title">Twitter Replies</h2>
<ul id="twitter_reply_list"></ul>
</div>

<div class="aisLeftNav">
<a href='http://ineta.org/Speakers/SearchCommunitySpeakers.aspx?SpeakerId=c5110e21-9243-461b-a464-a6548524e885'><img alt='INETA Community Speakers Program' border='0' src='../../www.ineta.org/images/OfficialLogos/InetaCommunitySpeakersRequestMe.html' /></a>
</div>

<div class="aisLeftNav">
	<li class="pagenav"><h2>Pages</h2><ul><li class="page_item page-item-2"><a href="indexba53.html?page_id=2" title="About Us">About Us</a></li>
<li class="page_item page-item-210"><a href="index6ae3.html?page_id=210" title="Templates">Templates</a></li>
</ul></li></div>

<div class="aisLeftNav">
<h2>Archives</h2>
<ul>
	<li><a href='indexb4d5.html?m=201110' title='October 2011'>October 2011</a></li>
	<li><a href='indexc61a.html?m=201106' title='June 2011'>June 2011</a></li>
	<li><a href='indexa80d.html?m=201105' title='May 2011'>May 2011</a></li>
	<li><a href='index512b.html?m=201104' title='April 2011'>April 2011</a></li>
	<li><a href='index08fb.html?m=201103' title='March 2011'>March 2011</a></li>
	<li><a href='index52f4.html?m=201102' title='February 2011'>February 2011</a></li>
	<li><a href='index74f1.html?m=201101' title='January 2011'>January 2011</a></li>
	<li><a href='index8956.html?m=201012' title='December 2010'>December 2010</a></li>
	<li><a href='indexa1aa.html?m=201011' title='November 2010'>November 2010</a></li>
	<li><a href='indexe3d5.html?m=201010' title='October 2010'>October 2010</a></li>
	<li><a href='index9ab9.html?m=201009' title='September 2010'>September 2010</a></li>
	<li><a href='index1ff0.html?m=201008' title='August 2010'>August 2010</a></li>
	<li><a href='index9f11.html?m=201007' title='July 2010'>July 2010</a></li>
	<li><a href='index31f0.html?m=201006' title='June 2010'>June 2010</a></li>
	<li><a href='indexd189.html?m=201005' title='May 2010'>May 2010</a></li>
	<li><a href='indexb5c0.html?m=201004' title='April 2010'>April 2010</a></li>
	<li><a href='indexf258.html?m=201003' title='March 2010'>March 2010</a></li>
	<li><a href='index6e30.html?m=201002' title='February 2010'>February 2010</a></li>
	<li><a href='index6b19.html?m=201001' title='January 2010'>January 2010</a></li>
	<li><a href='index5c0a.html?m=200912' title='December 2009'>December 2009</a></li>
	<li><a href='index8f62.html?m=200911' title='November 2009'>November 2009</a></li>
	<li><a href='index451d.html?m=200910' title='October 2009'>October 2009</a></li>
	<li><a href='index3e04.html?m=200909' title='September 2009'>September 2009</a></li>
	<li><a href='index425a.html?m=200908' title='August 2009'>August 2009</a></li>
	<li><a href='index9907.html?m=200907' title='July 2009'>July 2009</a></li>
	<li><a href='index3104.html?m=200906' title='June 2009'>June 2009</a></li>
	<li><a href='indexc36d.html?m=200905' title='May 2009'>May 2009</a></li>
	<li><a href='index17e8.html?m=200904' title='April 2009'>April 2009</a></li>
	<li><a href='index10a5.html?m=200903' title='March 2009'>March 2009</a></li>
	<li><a href='index8988.html?m=200902' title='February 2009'>February 2009</a></li>
	<li><a href='index1419.html?m=200901' title='January 2009'>January 2009</a></li>
	<li><a href='index7866.html?m=200812' title='December 2008'>December 2008</a></li>
	<li><a href='index55f6.html?m=200811' title='November 2008'>November 2008</a></li>
	<li><a href='indexa7bc.html?m=200810' title='October 2008'>October 2008</a></li>
	<li><a href='indexe77c.html?m=200809' title='September 2008'>September 2008</a></li>
	<li><a href='indexcffc.html?m=200808' title='August 2008'>August 2008</a></li>
	<li><a href='index0e62.html?m=200807' title='July 2008'>July 2008</a></li>
	<li><a href='indexfda7.html?m=200806' title='June 2008'>June 2008</a></li>
	<li><a href='index7d64.html?m=200805' title='May 2008'>May 2008</a></li>
	<li><a href='index94dd.html?m=200804' title='April 2008'>April 2008</a></li>
	<li><a href='index9631.html?m=200803' title='March 2008'>March 2008</a></li>
	<li><a href='indexdd52.html?m=200802' title='February 2008'>February 2008</a></li>
	<li><a href='index21ee.html?m=200801' title='January 2008'>January 2008</a></li>
	<li><a href='index363c.html?m=200712' title='December 2007'>December 2007</a></li>
	<li><a href='index7493.html?m=200711' title='November 2007'>November 2007</a></li>
	<li><a href='index93a7.html?m=200710' title='October 2007'>October 2007</a></li>
	<li><a href='index4ca8.html?m=200709' title='September 2007'>September 2007</a></li>
	<li><a href='index6124.html?m=200708' title='August 2007'>August 2007</a></li>
	<li><a href='index6013.html?m=200707' title='July 2007'>July 2007</a></li>
	<li><a href='index2ab6.html?m=200706' title='June 2007'>June 2007</a></li>
	<li><a href='index44f0.html?m=200705' title='May 2007'>May 2007</a></li>
	<li><a href='indexf0b4.html?m=200704' title='April 2007'>April 2007</a></li>
	<li><a href='index481d.html?m=200703' title='March 2007'>March 2007</a></li>
	<li><a href='indexcbea.html?m=200702' title='February 2007'>February 2007</a></li>
	<li><a href='index9cdc.html?m=200701' title='January 2007'>January 2007</a></li>
	<li><a href='index3ea4.html?m=200612' title='December 2006'>December 2006</a></li>
	<li><a href='index67ca.html?m=200611' title='November 2006'>November 2006</a></li>
	<li><a href='indexff49.html?m=200610' title='October 2006'>October 2006</a></li>
	<li><a href='index611c.html?m=200609' title='September 2006'>September 2006</a></li>
	<li><a href='index9a21.html?m=200608' title='August 2006'>August 2006</a></li>
	<li><a href='index3ee9.html?m=200607' title='July 2006'>July 2006</a></li>
	<li><a href='indexe13a.html?m=200606' title='June 2006'>June 2006</a></li>
</ul>
</div>

<div class="aisLeftNav">
	</div>

<div class="aisLeftNav">
<h2>Books</h2>
<iframe src="http://rcm.amazon.com/e/cm?t=adventures0d2-20&amp;o=1&amp;p=8&amp;l=as1&amp;asins=0764526413&amp;fc1=000000&amp;IS2=1&amp;lt1=_blank&amp;lc1=0000ff&amp;bc1=000000&amp;bg1=ffffff&amp;f=ifr" style="width:120px;height:240px;" scrolling="no" marginwidth="0" marginheight="0" frameborder="0" name="I5" id="I5"></iframe>
<br/>
<iframe src="http://rcm.amazon.com/e/cm?t=adventures0d2-20&amp;o=1&amp;p=8&amp;l=as1&amp;asins=0201633612&amp;fc1=000000&amp;IS2=1&amp;lt1=_blank&amp;lc1=0000ff&amp;bc1=000000&amp;bg1=ffffff&amp;f=ifr" style="width:120px;height:240px;" scrolling="no" marginwidth="0" marginheight="0" frameborder="0" name="I6" id="I6"></iframe>
<br/>
<iframe src="http://rcm.amazon.com/e/cm?t=adventures0d2-20&amp;o=1&amp;p=8&amp;l=as1&amp;asins=0136291554&amp;fc1=000000&amp;IS2=1&amp;lt1=_blank&amp;lc1=0000ff&amp;bc1=000000&amp;bg1=ffffff&amp;f=ifr" style="width:120px;height:240px;" scrolling="no" marginwidth="0" marginheight="0" frameborder="0" name="I7" id="I7"></iframe>
<br/>
<iframe src="http://rcm.amazon.com/e/cm?t=adventures0d2-20&amp;o=1&amp;p=8&amp;l=as1&amp;asins=1888009195&amp;fc1=000000&amp;IS2=1&amp;lt1=_blank&amp;lc1=0000ff&amp;bc1=000000&amp;bg1=ffffff&amp;f=ifr" style="width:120px;height:240px;" scrolling="no" marginwidth="0" marginheight="0" frameborder="0" name="I8" id="I8"></iframe>
</div>
<div class="aisLeftNav">
<h2>Meta</h2>
<ul>
		<li><a href="wp-login.html">Login</a></li>
	<li><a href="http://validator.w3.org/check/referer" title="This page validates as XHTML 1.0 Transitional">Valid <abbr title="eXtensible HyperText Markup Language">XHTML</abbr></a></li>
	<li><a href="http://gmpg.org/xfn/"><abbr title="XHTML Friends Network">XFN</abbr></a></li>
	<li><a href="http://wordpress.org/" title="Powered by WordPress, state-of-the-art semantic personal publishing platform.">WordPress</a></li>
	</ul>
</div>
<div class="aisLeftContent">
<h2>Community</h2>
<ul>
	<script type="text/javascript" src="../../localhost/embed/92q2bbma.js"></script>
</ul>
</div>

</div></div></div>
</div>		</td>
		<td>

	<div id="content" class="narrowcolumn">

		
		 		<h2 class="pagetitle">Archive for December, 2008</h2>

		

		<div class="navigation">
			<div class="alignleft"></div>
			<div class="alignright"></div>
		</div>

				<div class="post">
				<h3 id="post-285"><a href="indexd0b8.html?p=285" rel="bookmark" title="Permanent Link to Visualize project dependencies in Visual Studio">Visualize project dependencies in Visual Studio</a></h3>
				<small>Wednesday, December 31st, 2008</small>

				<div class="entry">
					<p>When approaching a new body of code, I like to have a map. This helps me see where to start looking, what avenues to ignore for now, and why the previous authors made the decisions they did.</p>
<p>Accurate documentation is never available. It's just too costly to maintain. I think we've finally stopped beating the "not enough documentation" drum. Now we turn to the code itself.</p>
<p>For a quick first glance at a Visual Studio solution, I run this handy macro.</p>
<pre><span style="color: blue">Imports</span> System
<span style="color: blue">Imports</span> EnvDTE
<span style="color: blue">Imports</span> EnvDTE80
<span style="color: blue">Imports</span> EnvDTE90
<span style="color: blue">Imports</span> System.Diagnostics
<span style="color: blue">Imports</span> VSLangProj
<span style="color: blue">Imports</span> System.IO

<span style="color: blue">Public</span> <span style="color: blue">Module</span> Diagram

    <span style="color: blue">Sub</span> ProjectDependency()
        <span style="color: blue">Dim</span> vsProject <span style="color: blue">As</span> VSProject
        <span style="color: blue">Dim</span> file <span style="color: blue">As</span> <span style="color: blue">Integer</span>
        <span style="color: blue">Dim</span> writer <span style="color: blue">As</span> <span style="color: blue">New</span> StreamWriter(DTE.Solution.FileName &amp; <span style="color: maroon">".dot"</span>)

        writer.WriteLine(<span style="color: maroon">"digraph """</span> &amp; DTE.Solution.FullName &amp; <span style="color: maroon">""" {"</span>)
        writer.WriteLine(<span style="color: maroon">"  rankdir=LR"</span>)

        <span style="color: blue">For</span> <span style="color: blue">Each</span> project <span style="color: blue">As</span> Project <span style="color: blue">In</span> DTE.Solution.Projects
            vsProject = TryCast(project.<span style="color: blue">Object</span>, VSProject)
            <span style="color: blue">If</span> <span style="color: blue">Not</span> vsProject <span style="color: blue">Is</span> <span style="color: blue">Nothing</span> <span style="color: blue">Then</span>
                <span style="color: blue">For</span> <span style="color: blue">Each</span> reference <span style="color: blue">As</span> Reference <span style="color: blue">In</span> vsProject.References
                    <span style="color: blue">If</span> <span style="color: blue">Not</span> reference.SourceProject <span style="color: blue">Is</span> <span style="color: blue">Nothing</span> <span style="color: blue">Then</span>
                        writer.WriteLine(<span style="color: maroon">"  """</span> &amp; project.Name &amp; <span style="color: maroon">"""-&gt;"""</span> &amp; reference.SourceProject.Name &amp; <span style="color: maroon">""""</span>)
                    <span style="color: blue">End</span> <span style="color: blue">If</span>
                <span style="color: blue">Next</span>
            <span style="color: blue">End</span> <span style="color: blue">If</span>
        <span style="color: blue">Next</span>

        writer.WriteLine(<span style="color: maroon">"}"</span>)
        writer.Dispose()
    <span style="color: blue">End</span> <span style="color: blue">Sub</span>

<span style="color: blue">End</span> <span style="color: blue">Module</span>
</pre>
<p>This generates a ".dot" file in the solution's folder. Run this through <a href="http://graphviz.org/">GraphViz</a> to generate a graphical dependency map of the projects in the solution.</p>
<p>Then I start at the left side of the graph, which is where the entry points end up. I work my way down through the layers in a more-or-less breadth-first search of the project space. Tightly coupled project groups end up looking messy, and loosely coupled project groups end up looking neat.</p>
<p>Once I've oriented myself with this coarse map, I'll get more fine grained with a tool like <a href="http://www.ndepend.com/">NDepend</a>. But this is a great first step.</p>
				</div>

				<p class="postmetadata">Posted in <a href="index0b40.html?cat=9" title="View all posts in Tools" rel="category">Tools</a> |   <a href="indexd0b8.html?p=285#comments" title="Comment on Visualize project dependencies in Visual Studio">12 Comments &#187;</a></p>

			</div>

				<div class="post">
				<h3 id="post-284"><a href="index7b2c.html?p=284" rel="bookmark" title="Permanent Link to Presentation Model in WPF without INotifyPropertyChanged">Presentation Model in WPF without INotifyPropertyChanged</a></h3>
				<small>Saturday, December 27th, 2008</small>

				<div class="entry">
					<p>View a <a href="http://updatecontrols.net/videos/PresentationModel/PresentationModel.html">video</a> of this demo.</p>
<p>The <a href="http://martinfowler.com/eaaDev/PresentationModel.html">Presentation Model</a> pattern, otherwise known as <a href="http://blogs.msdn.com/johngossman/archive/2005/10/08/478683.aspx">Model/View/ViewModel</a>, inserts an intermediate class between your data model and your view. This intermediate class implements presentation logic, behavior directly related to user interaction. This logic doesn't belong in the data model, because it is not related to business logic. Nor does it belong in the view, because the view is difficult to unit test, and is more concerned with style and layout.</p>
<p><a href="http://www.codeproject.com/KB/smart/PMinAction.aspx">Current implementations of Presentation Model in WPF</a> rely on data binding, which <a href="http://blogs.msdn.com/mattdotson/archive/2008/07/09/presentation-model-pattern-in-wpf-part-2.aspx">requires you to implement INotifyPropertyChanged</a>. While this is just a minor inconvenience when binding directly to data objects, it is particularly troublesome to a presentation model. Since a presentation model consumes properties of a data model, it must register for PropertyChanged events. And since the view binds to the presentation model rather than the data model, it must turn around and fire those events again.</p>
<p><strong>Here's my solution</strong><br />As I <a href="http://www.adventuresinsoftware.com/blog/?p=283">posted earlier</a>, Update Controls replaces WPF data binding and does not require you to implement INotifyPropertyChanged. I've just published a new version of Update Controls (2.0.2), which adds a feature especially useful for the Presentation Model pattern. You can now use dotted identifier syntax to reference objects indirectly. Now the presentation model doesn't have to pass through all of the properties of the data model. It only needs to implement those that it intends to tweak for the UI, and expose a reference to the data model for access to all the others.</p>
<p><strong>Wrap the data object</strong><br />In the previous post, we created a Person data object and some XAML that bound to it. We'll keep the same Person object, but wrap it in a PersonPresentation object. This object exposes the Person as a property, and adds UI logic for the window title.</p>
<pre><span style="color: blue">public</span> <span style="color: blue">class</span> PersonPresentation
{
    <span style="color: blue">private</span> Person _person;

    <span style="color: blue">public</span> PersonPresentation(Person person)
    {
        _person = person;
    }

    <span style="color: blue">public</span> Person Person
    {
        <span style="color: blue">get</span> { <span style="color: blue">return</span> _person; }
    }

    <span style="color: blue">public</span> <span style="color: blue">string</span> Title
    {
        <span style="color: blue">get</span> { <span style="color: blue">return</span> <span style="color: maroon">"Person - "</span> + _person.Display; }
    }
}
</pre>
<p>Instead of directly using Person as the DataContext for the window, use a PersonPresentation.</p>
<pre><span style="color: blue">public</span> <span style="color: blue">partial</span> <span style="color: blue">class</span> Window1 : Window
{
    <span style="color: blue">public</span> Window1()
    {
        InitializeComponent();
        DataContext = <strong><span style="color: blue">new</span> PersonPresentation(</strong><span style="color: blue">new</span> Person()<strong>)</strong>;
    }
}
</pre>
<p>Now use dotted-identifier syntax in the XAML to access the Person for data properties. But for UI properties, like the window title, go directly after the PersonPresentation object.</p>
<pre><span style="color: blue">&lt;</span><span style="color: maroon">Window</span> <span style="color: red">x:Class</span>="<span style="color: blue">UpdateControls.XAML.Test.Window1</span>"
    <span style="color: red">xmlns</span>="<span style="color: blue">http://schemas.microsoft.com/winfx/2006/xaml/presentation</span>"
    <span style="color: red">xmlns:x</span>="<span style="color: blue">http://schemas.microsoft.com/winfx/2006/xaml</span>"
    <span style="color: red">xmlns:u</span>="<span style="color: blue">clr-namespace:UpdateControls.XAML;assembly=UpdateControls.XAML</span>"
    <span style="color: red">Title</span>="<span style="color: blue">{u:Update <strong>Title</strong>}</span>" <span style="color: red">Height</span>="<span style="color: blue">300</span>" <span style="color: red">Width</span>="<span style="color: blue">300</span>"<span style="color: blue">&gt;</span>
    <span style="color: blue">&lt;</span><span style="color: maroon">StackPanel</span><span style="color: blue">&gt;</span>
        <span style="color: blue">&lt;</span><span style="color: maroon">StackPanel</span> <span style="color: red">Orientation</span>="<span style="color: blue">Horizontal</span>"<span style="color: blue">&gt;</span>
            <span style="color: blue">&lt;</span><span style="color: maroon">Label</span> <span style="color: red">Content</span>="<span style="color: blue">First Name:</span>" <span style="color: red">Width</span>="<span style="color: blue">100</span>"/<span style="color: blue">&gt;</span>
            <span style="color: blue">&lt;</span><span style="color: maroon">TextBox</span> <span style="color: red">Text</span>="<span style="color: blue">{u:Update <strong>Person.FirstName</strong>}</span>" <span style="color: red">Width</span>="<span style="color: blue">170</span>"/<span style="color: blue">&gt;</span>
        <span style="color: blue">&lt;</span>/<span style="color: maroon">StackPanel</span><span style="color: blue">&gt;</span>
        <span style="color: blue">&lt;</span><span style="color: maroon">StackPanel</span> <span style="color: red">Orientation</span>="<span style="color: blue">Horizontal</span>"<span style="color: blue">&gt;</span>
            <span style="color: blue">&lt;</span><span style="color: maroon">Label</span> <span style="color: red">Content</span>="<span style="color: blue">Last Name:</span>" <span style="color: red">Width</span>="<span style="color: blue">100</span>"/<span style="color: blue">&gt;</span>
            <span style="color: blue">&lt;</span><span style="color: maroon">TextBox</span> <span style="color: red">Text</span>="<span style="color: blue">{u:Update <strong>Person.LastName</strong>}</span>" <span style="color: red">Width</span>="<span style="color: blue">170</span>"/<span style="color: blue">&gt;</span>
        <span style="color: blue">&lt;</span>/<span style="color: maroon">StackPanel</span><span style="color: blue">&gt;</span>
        <span style="color: blue">&lt;</span><span style="color: maroon">StackPanel</span> <span style="color: red">Orientation</span>="<span style="color: blue">Horizontal</span>"<span style="color: blue">&gt;</span>
            <span style="color: blue">&lt;</span><span style="color: maroon">Label</span> <span style="color: red">Content</span>="<span style="color: blue">Display As:</span>" <span style="color: red">Width</span>="<span style="color: blue">100</span>"/<span style="color: blue">&gt;</span>
                <span style="color: blue">&lt;</span><span style="color: maroon">ComboBox</span> <span style="color: red">SelectedIndex</span>="<span style="color: blue">{u:Update <strong>Person.DisplayStrategy</strong>}</span>" <span style="color: red">Width</span>="<span style="color: blue">170</span>"<span style="color: blue">&gt;</span>
                    <span style="color: blue">&lt;</span><span style="color: maroon">ComboBoxItem</span> <span style="color: red">Content</span>="<span style="color: blue">{u:Update <strong>Person.FirstLast</strong>}</span>" /<span style="color: blue">&gt;</span>
                    <span style="color: blue">&lt;</span><span style="color: maroon">ComboBoxItem</span> <span style="color: red">Content</span>="<span style="color: blue">{u:Update <strong>Person.LastFirst</strong>}</span>"/<span style="color: blue">&gt;</span>
                <span style="color: blue">&lt;</span>/<span style="color: maroon">ComboBox</span><span style="color: blue">&gt;</span>
        <span style="color: blue">&lt;</span>/<span style="color: maroon">StackPanel</span><span style="color: blue">&gt;</span>
    <span style="color: blue">&lt;</span>/<span style="color: maroon">StackPanel</span><span style="color: blue">&gt;</span>
<span style="color: blue">&lt;</span>/<span style="color: maroon">Window</span><span style="color: blue">&gt;</span>
</pre>
<p>With the Presentation Model pattern, you achieve separation of concerns. Business logic is encapsulated in the data model, style and layout are in the view, and interaction logic is in the presentation model.</p>
				</div>

				<p class="postmetadata">Posted in <a href="indexb0b7.html?cat=6" title="View all posts in Patterns" rel="category">Patterns</a>,  <a href="indexa88f.html?cat=36" title="View all posts in Update Controls" rel="category">Update Controls</a> |   <a href="index7b2c.html?p=284#respond" title="Comment on Presentation Model in WPF without INotifyPropertyChanged">No Comments &#187;</a></p>

			</div>

				<div class="post">
				<h3 id="post-283"><a href="index30e3.html?p=283" rel="bookmark" title="Permanent Link to Update Controls for WPF">Update Controls for WPF</a></h3>
				<small>Wednesday, December 24th, 2008</small>

				<div class="entry">
					<p>I've released Update Controls support for WPF. You can see a <a href="http://updatecontrols.net/videos/XAML/XAML.html">quick demo video</a> that demonstrates building a WPF application from scratch using the new markup extension. It's better than data binding.</p>
<p>With this release, you can bind WPF controls directly to CLR properties without implementing INotifyPropertyChanged. All you do is use the Independent class to keep track of gets and sets. And the Visual Studio add-in will even do that for you when you select the properties and hit Ctrl+D, G.</p>
<div style="font-family: courier new"><span style="color: blue">public</span>&nbsp;<span style="color: blue">class</span> Person <br />{ <br />&nbsp;&nbsp;&nbsp; <span style="color: blue">private</span>&nbsp;<span style="color: blue">string</span> _firstName; <br />&nbsp;&nbsp;&nbsp; <span style="color: blue">private</span>&nbsp;<span style="color: blue">string</span> _lastName; <br />&nbsp;&nbsp;&nbsp; <span style="color: blue">private</span>&nbsp;<span style="color: blue">int</span> _displayStrategy; </p>
<p>&nbsp;&nbsp;&nbsp; <span style="color: blue">#region</span> Independent properties <br />&nbsp;&nbsp;&nbsp; <span style="color: green">// Generated by Update Controls --------------------------------</span> <br />&nbsp;&nbsp;&nbsp; <span style="color: blue">private</span> Independent _indDisplayStrategy = <span style="color: blue">new</span> Independent(); <br />&nbsp;&nbsp;&nbsp; <span style="color: blue">private</span> Independent _indFirstName = <span style="color: blue">new</span> Independent(); <br />&nbsp;&nbsp;&nbsp; <span style="color: blue">private</span> Independent _indLastName = <span style="color: blue">new</span> Independent(); </p>
<p>&nbsp;&nbsp;&nbsp; <span style="color: blue">public</span>&nbsp;<span style="color: blue">string</span> FirstName <br />&nbsp;&nbsp;&nbsp; { <br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <span style="color: blue">get</span> { _indFirstName.OnGet(); <span style="color: blue">return</span> _firstName; } <br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <span style="color: blue">set</span> { _indFirstName.OnSet(); _firstName = value; } <br />&nbsp;&nbsp;&nbsp; } </p>
<p>&nbsp;&nbsp;&nbsp; <span style="color: blue">public</span>&nbsp;<span style="color: blue">string</span> LastName <br />&nbsp;&nbsp;&nbsp; { <br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <span style="color: blue">get</span> { _indLastName.OnGet(); <span style="color: blue">return</span> _lastName; } <br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <span style="color: blue">set</span> { _indLastName.OnSet(); _lastName = value; } <br />&nbsp;&nbsp;&nbsp; } </p>
<p>&nbsp;&nbsp;&nbsp; <span style="color: blue">public</span>&nbsp;<span style="color: blue">int</span> DisplayStrategy <br />&nbsp;&nbsp;&nbsp; { <br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <span style="color: blue">get</span> { _indDisplayStrategy.OnGet(); <span style="color: blue">return</span> _displayStrategy; } <br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <span style="color: blue">set</span> { _indDisplayStrategy.OnSet(); _displayStrategy = value; } <br />&nbsp;&nbsp;&nbsp; } <br />&nbsp;&nbsp;&nbsp; <span style="color: green">// End generated code --------------------------------</span> <br />&nbsp;&nbsp;&nbsp; <span style="color: blue">#endregion</span> </p>
<p>&nbsp;&nbsp;&nbsp; <span style="color: blue">public</span>&nbsp;<span style="color: blue">string</span> FirstLast <br />&nbsp;&nbsp;&nbsp; { <br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <span style="color: blue">get</span> { <span style="color: blue">return</span> FirstName + <span style="color: maroon">" "</span> + LastName; } <br />&nbsp;&nbsp;&nbsp; } </p>
<p>&nbsp;&nbsp;&nbsp; <span style="color: blue">public</span>&nbsp;<span style="color: blue">string</span> LastFirst <br />&nbsp;&nbsp;&nbsp; { <br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <span style="color: blue">get</span> { <span style="color: blue">return</span> LastName + <span style="color: maroon">", "</span> + FirstName; } <br />&nbsp;&nbsp;&nbsp; } </p>
<p>&nbsp;&nbsp;&nbsp; <span style="color: blue">public</span>&nbsp;<span style="color: blue">string</span> Display <br />&nbsp;&nbsp;&nbsp; { <br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <span style="color: blue">get</span> { <span style="color: blue">return</span> DisplayStrategy == <span style="color: maroon">0</span> ? FirstLast : LastFirst; } <br />&nbsp;&nbsp;&nbsp; } <br />} </div>
<p>The FirstName, LastName, and DisplayStrategy properties are all independent. Their values are determined by the user. The FirstLast, LastFirst, and Display properties are all dependent. Their values are determined by code. Notice that there is absolutely no bookkeeping code around the dependent properties. Yet you can still bind to them using u:Update.</p>
<pre><span style="color: blue">&lt;</span><span style="color: maroon">Window</span> <span style="color: red">x:Class</span>="<span style="color: blue">UpdateControls.XAML.Test.Window1</span>"
    <span style="color: red">xmlns</span>="<span style="color: blue">http://schemas.microsoft.com/winfx/2006/xaml/presentation</span>"
    <span style="color: red">xmlns:x</span>="<span style="color: blue">http://schemas.microsoft.com/winfx/2006/xaml</span>"
    <span style="color: red">xmlns:u="clr-namespace:UpdateControls.XAML;assembly</span>=UpdateControls.XAML"
    <span style="color: red">Title</span>="<span style="color: blue">{u:Update Display}</span>" <span style="color: red">Height</span>="<span style="color: blue">300</span>" <span style="color: red">Width</span>="<span style="color: blue">300</span>"<span style="color: blue">&gt;</span>
	<span style="color: blue">&lt;</span><span style="color: maroon">StackPanel</span><span style="color: blue">&gt;</span>
		<span style="color: blue">&lt;</span><span style="color: maroon">StackPanel</span> <span style="color: red">Orientation</span>="<span style="color: blue">Horizontal</span>"<span style="color: blue">&gt;</span>
			<span style="color: blue">&lt;</span><span style="color: maroon">Label</span> <span style="color: red">Content</span>="<span style="color: blue">First Name:</span>" <span style="color: red">Width</span>="<span style="color: blue">100</span>"/<span style="color: blue">&gt;</span>
			<span style="color: blue">&lt;</span><span style="color: maroon">TextBox</span> <span style="color: red">Text</span>="<span style="color: blue">{u:Update FirstName}</span>" <span style="color: red">Width</span>="<span style="color: blue">170</span>"/<span style="color: blue">&gt;</span>
		<span style="color: blue">&lt;</span>/<span style="color: maroon">StackPanel</span><span style="color: blue">&gt;</span>
		<span style="color: blue">&lt;</span><span style="color: maroon">StackPanel</span> <span style="color: red">Orientation</span>="<span style="color: blue">Horizontal</span>"<span style="color: blue">&gt;</span>
			<span style="color: blue">&lt;</span><span style="color: maroon">Label</span> <span style="color: red">Content</span>="<span style="color: blue">Last Name:</span>" <span style="color: red">Width</span>="<span style="color: blue">100</span>"/<span style="color: blue">&gt;</span>
			<span style="color: blue">&lt;</span><span style="color: maroon">TextBox</span> <span style="color: red">Text</span>="<span style="color: blue">{u:Update LastName}</span>" <span style="color: red">Width</span>="<span style="color: blue">170</span>"/<span style="color: blue">&gt;</span>
		<span style="color: blue">&lt;</span>/<span style="color: maroon">StackPanel</span><span style="color: blue">&gt;</span>
		<span style="color: blue">&lt;</span><span style="color: maroon">StackPanel</span> <span style="color: red">Orientation</span>="<span style="color: blue">Horizontal</span>"<span style="color: blue">&gt;</span>
			<span style="color: blue">&lt;</span><span style="color: maroon">Label</span> <span style="color: red">Content</span>="<span style="color: blue">Display As:</span>" <span style="color: red">Width</span>="<span style="color: blue">100</span>"/<span style="color: blue">&gt;</span>
			<span style="color: blue">&lt;</span><span style="color: maroon">ComboBox</span> <span style="color: red">SelectedIndex</span>="<span style="color: blue">{u:Update DisplayStrategy}</span>" <span style="color: red">Width</span>="<span style="color: blue">170</span>"<span style="color: blue">&gt;</span>
				<span style="color: blue">&lt;</span><span style="color: maroon">ComboBoxItem</span> <span style="color: red">Content</span>="<span style="color: blue">{u:Update FirstLast}</span>" /<span style="color: blue">&gt;</span>
				<span style="color: blue">&lt;</span><span style="color: maroon">ComboBoxItem</span> <span style="color: red">Content</span>="<span style="color: blue">{u:Update LastFirst}</span>"/<span style="color: blue">&gt;</span>
			<span style="color: blue">&lt;</span>/<span style="color: maroon">ComboBox</span><span style="color: blue">&gt;</span>
		<span style="color: blue">&lt;</span>/<span style="color: maroon">StackPanel</span><span style="color: blue">&gt;</span>
	<span style="color: blue">&lt;</span>/<span style="color: maroon">StackPanel</span><span style="color: blue">&gt;</span>
<span style="color: blue">&lt;</span>/<span style="color: maroon">Window</span><span style="color: blue">&gt;</span></pre>
<p><span style="color: blue"></span></p>
<div style="font-family: courier new"><span style="color: blue">public</span>&nbsp;<span style="color: blue">partial</span>&nbsp;<span style="color: blue">class</span> Window1 : Window <br />{ <br />&nbsp;&nbsp;&nbsp; <span style="color: blue">public</span> Window1() <br />&nbsp;&nbsp;&nbsp; { <br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; InitializeComponent(); <br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; DataContext = <span style="color: blue">new</span> Person(); <br />&nbsp;&nbsp;&nbsp; } <br />} </div>
<p>And, by the way, it still supports Winforms.</p>
<p><a href="http://updatecontrols.net/cs/download20.shtml">Download</a> it and try it in your next WPF application. You'll never want to go back to plain-old data binding again.</p>
				</div>

				<p class="postmetadata">Posted in <a href="indexa88f.html?cat=36" title="View all posts in Update Controls" rel="category">Update Controls</a> |   <a href="index30e3.html?p=283#respond" title="Comment on Update Controls for WPF">No Comments &#187;</a></p>

			</div>

				<div class="post">
				<h3 id="post-282"><a href="indexa8da.html?p=282" rel="bookmark" title="Permanent Link to Update Controls in WPF and Silverlight">Update Controls in WPF and Silverlight</a></h3>
				<small>Wednesday, December 10th, 2008</small>

				<div class="entry">
					<p><a href="http://updatecontrols.net/">Update Controls .NET</a> is a library of controls for Windows Forms that automatically update themselves. They are superior to data binding because they can see through layers of business logic and respond to changes in the underlying data. It is not necessary to implement INotifyPropertyChanged, or to bubble up state-change events by any means.</p>
<p>In WPF, and now in Silverlight 2.0, Microsoft has provided a significant improvement to data binding. It is now easy to add data binding to any user control. Data binding can now be expressed declaratively within XAML. And it is trivially simple for one dependency property to depend upon another one. The improvements are so great that it is difficult for people to see the pain that is still there.</p>
<p><strong>INotifyPropertyChanged and ObservableCollection&lt;T&gt;</strong><br />In WPF and Silverlight data binding, it is still necessary for the developer to fire property changed events. These events are fired by an object that implements INotifyPropertyChanged. The interface makes it possible for dependency properties to register for these events.</p>
<p>Some helper classes implement this interface on your behalf. For example, ObservableCollection&lt;T&gt; is a generic container that fires property changed events when items are added or removed. By exposing these helper classes from your own business class, you can offload the responsibility of notification.</p>
<p>Typically, you use ObservableCollection&lt;T&gt; in your data objects. If you bind your user interface directly to your data objects, then everything works just fine. But if you want a layer of business logic between the data layer and the UI, ObservableCollection&lt;T&gt; is no longer helpful to you. What you want is an intermediate collection that can filter the source, or wrap adapters around each of the items. ObservableCollection&lt;T&gt; only provides a way to bind directly to the source collection without modification.</p>
<p><strong>Presentation Model pattern</strong><br />The <a href="http://blogs.msdn.com/johngossman/archive/2005/10/08/478683.aspx">Model/View/ViewModel</a> pattern was created by the Blend team to separate user interface logic from business logic. In this pattern, the view model transforms the raw data from the model into the visible data shown to the user. The view model observes the underlying data model and notifies the view when it changes.</p>
<p>Martin Fowler documents a similar pattern called the <a href="http://martinfowler.com/eaaDev/PresentationModel.html">Presentation Model</a>. In his document, the role of the ViewModel is played by the Presentation Model. I find this a more descriptive term, so it is the one I adopt. He calls out synchronization between the presentation model and view is the most annoying part of the pattern. While .NET data binding attempts to solve this problem, it still requires that the presentation model subscribe to notifications from the model and forward them to the view.</p>
<p><strong>Update Controls Presentation Model</strong><br />I am currently working on full support of the Presentation Model pattern in Update Controls. Since the strong point of Update Controls is tracking dependency through layers of business logic, it closes this annoying gap in Fowler's pattern. I will be releasing source code shortly, but here's what I have so far:</p>
<div style="font-family: courier new">&nbsp;&nbsp;&nbsp; <span style="color: blue">public</span>&nbsp;<span style="color: blue">class</span> PersonPresentation : PresentationObject&lt;Person&gt; <br />&nbsp;&nbsp;&nbsp; { <br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <span style="color: blue">private</span> PresentationProperty&lt;<span style="color: blue">string</span>&gt; _firstName; <br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <span style="color: blue">private</span> PresentationProperty&lt;<span style="color: blue">string</span>&gt; _lastName; <br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <span style="color: blue">private</span> PresentationProperty&lt;<span style="color: blue">string</span>&gt; _firstLast; <br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <span style="color: blue">private</span> PresentationProperty&lt;<span style="color: blue">string</span>&gt; _lastFirst; <br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <span style="color: blue">private</span> PresentationProperty&lt;<span style="color: blue">int</span>&gt; _displayStrategy; <br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <span style="color: blue">private</span> PresentationProperty&lt;<span style="color: blue">string</span>&gt; _title; </p>
<p>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <span style="color: blue">public</span> PersonPresentation(Person person) : <br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <span style="color: blue">base</span>(person) <br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; { <br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; _firstName = <span style="color: blue">new</span> PresentationProperty&lt;<span style="color: blue">string</span>&gt;(<span style="color: blue">this</span>, <span style="color: maroon">"FirstName"</span>,</div>
<div style="font-family: courier new">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; () =&gt; BusinessObject.FirstName); <br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; _lastName = <span style="color: blue">new</span> PresentationProperty&lt;<span style="color: blue">string</span>&gt;(<span style="color: blue">this</span>, <span style="color: maroon">"LastName"</span>,</div>
<div style="font-family: courier new">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; () =&gt; BusinessObject.LastName); <br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; _firstLast = <span style="color: blue">new</span> PresentationProperty&lt;<span style="color: blue">string</span>&gt;(<span style="color: blue">this</span>, <span style="color: maroon">"FirstLast"</span>,</div>
<div style="font-family: courier new">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; () =&gt; CalculateFirstLast()); <br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; _lastFirst = <span style="color: blue">new</span> PresentationProperty&lt;<span style="color: blue">string</span>&gt;(<span style="color: blue">this</span>, <span style="color: maroon">"LastFirst"</span>,</div>
<div style="font-family: courier new">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; () =&gt; CalculateLastFirst()); <br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; _displayStrategy = <span style="color: blue">new</span> PresentationProperty&lt;<span style="color: blue">int</span>&gt;(<span style="color: blue">this</span>, <span style="color: maroon">"DisplayStrategy"</span>,</div>
<div style="font-family: courier new">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; () =&gt; BusinessObject.DisplayStrategy); <br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; _title = <span style="color: blue">new</span> PresentationProperty&lt;<span style="color: blue">string</span>&gt;(<span style="color: blue">this</span>, <span style="color: maroon">"Title"</span>, <br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; () =&gt; <span style="color: maroon">"Person - "</span> + (BusinessObject.DisplayStrategy == <span style="color: maroon">0</span> ? CalculateFirstLast() : CalculateLastFirst())); <br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; } </p>
<p>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <span style="color: blue">private</span>&nbsp;<span style="color: blue">string</span> CalculateLastFirst() <br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; { <br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <span style="color: blue">return</span> BusinessObject.LastName + <span style="color: maroon">", "</span> + BusinessObject.FirstName; <br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; } </p>
<p>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <span style="color: blue">private</span>&nbsp;<span style="color: blue">string</span> CalculateFirstLast() <br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; { <br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <span style="color: blue">return</span> BusinessObject.FirstName + <span style="color: maroon">" "</span> + BusinessObject.LastName; <br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; } </p>
<p>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <span style="color: blue">public</span>&nbsp;<span style="color: blue">string</span> FirstName <br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; { <br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <span style="color: blue">get</span> { <span style="color: blue">return</span> _firstName.Value; } <br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <span style="color: blue">set</span> { BusinessObject.FirstName = value; } <br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; } </p>
<p>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <span style="color: blue">public</span>&nbsp;<span style="color: blue">string</span> LastName <br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; { <br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <span style="color: blue">get</span> { <span style="color: blue">return</span> _lastName.Value; } <br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <span style="color: blue">set</span> { BusinessObject.LastName = value; } <br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; } </p>
<p>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <span style="color: blue">public</span>&nbsp;<span style="color: blue">int</span> DisplayStrategy <br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; { <br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <span style="color: blue">get</span> { <span style="color: blue">return</span> _displayStrategy.Value; } <br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <span style="color: blue">set</span> { BusinessObject.DisplayStrategy = value; } <br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; } </p>
<p>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <span style="color: blue">public</span>&nbsp;<span style="color: blue">string</span> FirstLast <br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; { <br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <span style="color: blue">get</span> { <span style="color: blue">return</span> _firstLast.Value; } <br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; } </p>
<p>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <span style="color: blue">public</span>&nbsp;<span style="color: blue">string</span> LastFirst <br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; { <br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <span style="color: blue">get</span> { <span style="color: blue">return</span> _lastFirst.Value; } <br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; } </p>
<p>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <span style="color: blue">public</span>&nbsp;<span style="color: blue">string</span> Title <br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; { <br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <span style="color: blue">get</span> { <span style="color: blue">return</span> _title.Value; } <br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; } <br />&nbsp;&nbsp;&nbsp; } </div>
<p>The PersonPresentation object (presentation model) wraps the Person business object (data model). The PresentationObject base class implements INotifyPropertyChanged on your behalf. PresentationProperty is a wrapper around a data type that calls a provided Action when the property is out-of-date. You expose the value of each presentation property through a CLR property getter, and pass the setter through to the underlying business object. This allows you to specify attributes like "{Binding FirstName}" in your WPF or Silverlight.</p>
<p>Collections are handled in a similar fashion:</p>
<div style="font-family: courier new">&nbsp;&nbsp;&nbsp; <span style="color: blue">public</span>&nbsp;<span style="color: blue">class</span> PresentationAddressBook : PresentationObject&lt;AddressBook&gt; <br />&nbsp;&nbsp;&nbsp; { <br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <span style="color: blue">private</span> PresentationCollection&lt;Person, PresentationPerson&gt; _people; </p>
<p>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <span style="color: blue">public</span> PresentationAddressBook(AddressBook addressBook) : <br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <span style="color: blue">base</span>(addressBook) <br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; { <br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; _people = <span style="color: blue">new</span> PresentationCollection&lt;Person, PresentationPerson&gt;(<span style="color: blue">this</span>, <span style="color: maroon">"People"</span>, <br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; () =&gt; BusinessObject.People, <br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; person =&gt; <span style="color: blue">new</span> PresentationPerson(person)); <br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; } </p>
<p>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <span style="color: blue">public</span> ICollection&lt;PresentationPerson&gt; People <br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; { <br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <span style="color: blue">get</span> { <span style="color: blue">return</span> _people.Value; } <br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; } </p>
<p>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <span style="color: blue">public</span>&nbsp;<span style="color: blue">void</span> AddPerson() <br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; { <br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; BusinessObject.AddPerson(); <br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; } <br />&nbsp;&nbsp;&nbsp; } </div>
<p>The PresentationCollection performs two actions rather than just one. It first gets the collection of business objects from the parent business object. Then, it wraps each business object in another presentation object. In the process, it performs object recycling so that you reuse a presentation object for a given business object.</p>
<p><strong>Coming soon</strong><br />I am still refining this mechanism. When it is finished, it will be part of the new Update Controls .NET 2.0 release. I would like to reduce the amount of code necessary to write a presentation object. Ideally, you would need no base class and no members (besides the business object reference). A presentation model should be as simple as this:</p>
<div style="font-family: courier new">&nbsp;&nbsp;&nbsp; <span style="color: blue">public</span>&nbsp;<span style="color: blue">class</span> PersonPresentation <br />&nbsp;&nbsp;&nbsp; { <br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <span style="color: blue">private</span> Person _person; </p>
<p>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <span style="color: blue">public</span> PersonPresentation(Person person) <br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; { <br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; _person = person; <br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; } </p>
<p>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <span style="color: blue">public</span>&nbsp;<span style="color: blue">string</span> FirstName <br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; { <br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <span style="color: blue">get</span> { <span style="color: blue">return</span> _person.FirstName; } <br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <span style="color: blue">set</span> { _person.FirstName = value; } <br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; } </p>
<p>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <span style="color: blue">public</span>&nbsp;<span style="color: blue">string</span> LastName <br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; { <br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <span style="color: blue">get</span> { <span style="color: blue">return</span> _person.LastName; } <br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <span style="color: blue">set</span> { _person.LastName = value; } <br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; } </p>
<p>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <span style="color: blue">public</span>&nbsp;<span style="color: blue">int</span> DisplayStrategy <br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; { <br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <span style="color: blue">get</span> { <span style="color: blue">return</span> _person.DisplayStrategy; } <br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <span style="color: blue">set</span> { _person.DisplayStrategy = value; } <br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; } </p>
<p>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <span style="color: blue">public</span>&nbsp;<span style="color: blue">string</span> FirstLast <br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; { <br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <span style="color: blue">get</span> { <span style="color: blue">return</span> _person.FirstName + <span style="color: maroon">" "</span> + _person.LastName; } <br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; } </p>
<p>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <span style="color: blue">public</span>&nbsp;<span style="color: blue">string</span> LastFirst <br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; { <br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <span style="color: blue">get</span> { <span style="color: blue">return</span> _person.LastName + <span style="color: maroon">", "</span> + _person.FirstName; } <br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; } </p>
<p>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <span style="color: blue">public</span>&nbsp;<span style="color: blue">string</span> Title <br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; { <br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <span style="color: blue">get</span> { <span style="color: blue">return</span>&nbsp;<span style="color: maroon">"Person - "</span> + (DisplayStrategy == <span style="color: maroon">0</span> ? FirstLast : LastFirst); } <br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; } <br />&nbsp;&nbsp;&nbsp; } </div>
<p>That's my goal. Let's see how close I get.</p>
				</div>

				<p class="postmetadata">Posted in <a href="indexa88f.html?cat=36" title="View all posts in Update Controls" rel="category">Update Controls</a> |   <a href="indexa8da.html?p=282#respond" title="Comment on Update Controls in WPF and Silverlight">No Comments &#187;</a></p>

			</div>

				<div class="post">
				<h3 id="post-281"><a href="index73fa.html?p=281" rel="bookmark" title="Permanent Link to Using the generic type &#8216;System.Action&lt;T&gt;&#8217; requires &#8216;1&#8242; type arguments">Using the generic type &#8216;System.Action&lt;T&gt;&#8217; requires &#8216;1&#8242; type arguments</a></h3>
				<small>Sunday, December 7th, 2008</small>

				<div class="entry">
					<p>The Action and Func delegates are brilliant -- if late -- additions to the .NET framework. A delegate is a method that can be passed as a parameter. They can be used anywhere that you could use an interface with only one method. But delegate syntax is lighter weight than interface syntax.</p>
<p>The type of a delegate is really nothing more than a function signature. But even though the syntax for declaring a delegate is simpler than the syntax for declaring an interface, it is still more complex than it needs to be. Like any other type, a delegate is given a name. But the name is not important, only the signature.</p>
<p>The Action and Func generic delegates were added to the .NET framework in 2.0, which was the first version of the framework to support generics. Using these generics, the signature of a delegate can be declared in line. No separate type needs to be declared, no name needs to be specified, and all information is visible via intellisense.</p>
<p>One problem, however, was that no Action could be specified taking no arguments and returning no value. At least not until .NET 3.5. My guess is that Microsoft left this out so that the compiler wouldn't get confused having a class and a generic with the same name. But .NET 3.5 includes a compiler upgrade (for features like Linq, extension methods, and many more), so they probably fixed this minor issue at the same time. I haven't taken the time to test this theory.</p>
<p>Regardless the reason, if you need an Action with no parameters and no return type, then you have to target .NET 3.5. If you ever get this error message, check your Target Framework setting in the project properties.</p>
				</div>

				<p class="postmetadata">Posted in <a href="index81ea.html?cat=3" title="View all posts in Error messages" rel="category">Error messages</a> |   <a href="index73fa.html?p=281#comments" title="Comment on Using the generic type &#8216;System.Action&lt;T&gt;&#8217; requires &#8216;1&#8242; type arguments">2 Comments &#187;</a></p>

			</div>

				<div class="post">
				<h3 id="post-280"><a href="index90dd.html?p=280" rel="bookmark" title="Permanent Link to Correspondence preview drop">Correspondence preview drop</a></h3>
				<small>Thursday, December 4th, 2008</small>

				<div class="entry">
					<p>It is with pride (and not a little fear) that I release a preview of Correspondence. Please <a href="../bin/bugtracker.zip">download</a> and follow along with the discussion.</p>
<p>The preview drop includes the bug tracker sample model that we've been building over the past month. It also includes a unit test that exercises that model using the Postgres storage strategy. I have not yet decided on a license model for the Correspondence library itself. As it is now, it is not yet suitable for production use. So the library is provided for demonstration purposes only, without warrantee, and without license for use in any product or derived work.</p>
<p>The contents of the zip file are an Eclipse project. My preferred distribution of Eclipse is <a href="http://eclipse.org/ganymede">Ganymede</a>, which is ideally suited to building web applications. If you are not an Eclipse user, you can port the project to your environment of choice. I have not included an Ant script, but feel free to do so if that's how you work.</p>
<p>You will have to install <a href="http://www.postgresql.org/">Postgres</a> to run the test. Please drop the postgresql jar file in the lib folder and update the reference in bugtracker_model_test. You will then need to run the correspondence.sql script to build the Correspondence database. I could have used the in-memory storage strategy, but I thought you would get more out of seeing an actual working database.</p>
<p>Please give this preview a try and let me know how it goes. This will allow us to continue the conversation about Correspondence by exchanging working source code. Enjoy!</p>
				</div>

				<p class="postmetadata">Posted in <a href="indexb60a.html?cat=27" title="View all posts in Historic Modeling" rel="category">Historic Modeling</a> |   <a href="index90dd.html?p=280#respond" title="Comment on Correspondence preview drop">No Comments &#187;</a></p>

			</div>

		
		<div class="navigation">
			<div class="alignleft"></div>
			<div class="alignright"></div>
		</div>

	
	</div>
		</td>
	</tr>
</table>

<hr />
<div id="footer">
<!-- If you'd like to support WordPress, having the "powered by" link someone on your blog is the best way, it's our only promotion or advertising. -->
	<p>
		Adventures in Software is proudly powered by 
		<a href="http://wordpress.org/">WordPress</a>
		<br /><a href="indexd784.html?feed=rss2">Entries (RSS)</a>
		and <a href="indexa6da.html?feed=comments-rss2">Comments (RSS)</a>.
		<!-- 17 queries. 0.391 seconds. -->
	</p>
</div>
<script type="text/javascript">
var gaJsHost = (("https:" == document.location.protocol) ? "https://ssl." : "http://www.");
document.write(unescape("%3Cscript src='" + gaJsHost + "google-analytics.com/ga.js' type='text/javascript'%3E%3C/script%3E"));
</script>
<script type="text/javascript">
try {
var pageTracker = _gat._getTracker("UA-389401-3");
pageTracker._trackPageview();
} catch(err) {}</script></div>

<!-- Gorgeous design by Michael Heilemann - http://binarybonsai.com/kubrick/ -->

		<div id="sk2-footer" style="color:#FFF; background-color:#444; padding: 3px 2px 3px 2px; border-top: #888 solid 1px;">This blog is protected by <a href="http://unknowngenius.com/blog/" title="Dave">dr Dave</a>'s <strong><a href="http://unknowngenius.com/blog/wordpress/spam-karma/" title="SK2">Spam Karma 2</a></strong>: <strong>274531</strong>  Spams eaten and counting...</div><script type="text/javascript" src="replies.js"></script>
<script type="text/javascript" src="blogger.js"></script>
<script type="text/javascript" src="http://twitter.com/statuses/user_timeline/michaellperry.json?callback=twitterCallback2&amp;count=5"></script>
<script type="text/javascript" src="http://search.twitter.com/search.json?q=@michaellperry&amp;callback=twitterCallbackReplies&amp;rpp=5"></script>
</body>

<!-- Mirrored from adventuresinsoftware.com/blog/?m=200812 by HTTrack Website Copier/3.x [XR&CO'2014], Fri, 13 Jan 2017 12:47:00 GMT -->
</html>
