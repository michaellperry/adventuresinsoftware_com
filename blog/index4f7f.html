<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" dir="ltr">


<!-- Mirrored from adventuresinsoftware.com/blog/?paged=37 by HTTrack Website Copier/3.x [XR&CO'2014], Fri, 13 Jan 2017 13:11:21 GMT -->
<!-- Added by HTTrack --><meta http-equiv="content-type" content="text/html;charset=UTF-8" /><!-- /Added by HTTrack -->
<head profile="http://gmpg.org/xfn/11">
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8" />

<title>Adventures in Software  </title>

<meta name="generator" content="WordPress 2.3.3" /> <!-- leave this for stats -->

<link rel="stylesheet" href="wp-content/themes/ais2/style.css" type="text/css" media="screen" />
<link rel="alternate" type="application/rss+xml" title="Adventures in Software RSS Feed" href="indexd784.html?feed=rss2" />
<link rel="pingback" href="xmlrpc.html" />
    <script type="text/javascript">
        function onSilverlightError(sender, args) {
            var appSource = "";
            if (sender != null && sender != 0) {
              appSource = sender.getHost().Source;
            }
            
            var errorType = args.ErrorType;
            var iErrorCode = args.ErrorCode;

            if (errorType == "ImageError" || errorType == "MediaError") {
              return;
            }

            var errMsg = "Unhandled Error in Silverlight Application " +  appSource + "\n" ;

            errMsg += "Code: "+ iErrorCode + "    \n";
            errMsg += "Category: " + errorType + "       \n";
            errMsg += "Message: " + args.ErrorMessage + "     \n";

            if (errorType == "ParserError") {
                errMsg += "File: " + args.xamlFile + "     \n";
                errMsg += "Line: " + args.lineNumber + "     \n";
                errMsg += "Position: " + args.charPosition + "     \n";
            }
            else if (errorType == "RuntimeError") {           
                if (args.lineNumber != 0) {
                    errMsg += "Line: " + args.lineNumber + "     \n";
                    errMsg += "Position: " +  args.charPosition + "     \n";
                }
                errMsg += "MethodName: " + args.methodName + "     \n";
            }

            throw new Error(errMsg);
        }
    </script>

	<link rel="EditURI" type="application/rsd+xml" title="RSD" href="xmlrpc0db0.php?rsd" />
 <link rel="wlwmanifest" type="application/wlwmanifest+xml" href="wp-includes/wlwmanifest.xml" /> <style type='text/css'>
<!--#header { background: url('wp-content/themes/ais2/images/header-imgae03.html?upper=A7A73F&amp;lower=77773F') no-repeat bottom center; }
--></style>
</head>
<body>
<div id="page">

<div class="aisTopBar">
	<form method="get" id="searchform" action="http://adventuresinsoftware.com/blog/">
<div>
<a href="indexd784.html?feed=rss2"><img src="../images/feed-icon-28x28.png" border="0"></a>
<input type="text" value="" name="s" id="s" />
<input type="submit" id="searchsubmit" value="Search" />
</div>
</form>
</div>

<div class="aisHeaderImageRight">
	<div class="aisHeaderImage">
	<div class="aisHeaderCornerRight">
	<div class="aisHeaderCornerLeft">
	<div class="aisImageBar">
	<div class="aisSubSites">
		<a href="index.html" class="aisSubSiteLink"><span class="aisSiteTabRight"><span class="aisSiteTabLeft"><span class="aisSiteTab">
			home</span></span></span></a>
		<a class="aisSubSiteLink" href="indexb60a.html?cat=27"><span class="aisSiteTabRight"><span class="aisSiteTabLeft"><span class="aisSiteTab">
			historic modeling</span></span></span></a>
		<a class="aisSubSiteLink" href="indexa88f.html?cat=36"><span class="aisSiteTabRight"><span class="aisSiteTabLeft"><span class="aisSiteTab">
			update controls</span></span></span></a>
		<a href="index2d79.html?cat=26" class="aisSubSiteLink"><span class="aisSiteTabRight"><span class="aisSiteTabLeft"><span class="aisSiteTab">
			degrees of freedom</span></span></span></a>
		<a class="aisSubSiteLink" href="indexba53.html?page_id=2"><span class="aisSiteTabRight"><span class="aisSiteTabLeft"><span class="aisSiteTab">
			about us</span></span></span></a>

	</div>
	</div>
	</div>
	</div>
	</div>
</div>

<table style="width: 100%" cellspacing="0" cellpadding="0">
	<tr valign="top">
		<td width="210px">
<div id="sidebar">
<div class="aisLeftColumnFill">
<div class="aisLeftColumnBottom">
<div class="aisLeftColumnTop">
<div id="twitter_div" class="aisLeftNav">
<h2 class="sidebar-title">Twitter Updates</h2>
<ul id="twitter_update_list"></ul>
<a href="http://twitter.com/michaellperry" id="follow">Follow me</a>
</div>
<div id="twitter_reply_div" class="aisLeftNav">
<h2 class="sidebar-title">Twitter Replies</h2>
<ul id="twitter_reply_list"></ul>
</div>

<div class="aisLeftNav">
<a href='http://ineta.org/Speakers/SearchCommunitySpeakers.aspx?SpeakerId=c5110e21-9243-461b-a464-a6548524e885'><img alt='INETA Community Speakers Program' border='0' src='../../www.ineta.org/images/OfficialLogos/InetaCommunitySpeakersRequestMe.html' /></a>
</div>

<div class="aisLeftNav">
	<li class="pagenav"><h2>Pages</h2><ul><li class="page_item page-item-2"><a href="indexba53.html?page_id=2" title="About Us">About Us</a></li>
<li class="page_item page-item-210"><a href="index6ae3.html?page_id=210" title="Templates">Templates</a></li>
</ul></li></div>

<div class="aisLeftNav">
<h2>Archives</h2>
<ul>
	<li><a href='indexb4d5.html?m=201110' title='October 2011'>October 2011</a></li>
	<li><a href='indexc61a.html?m=201106' title='June 2011'>June 2011</a></li>
	<li><a href='indexa80d.html?m=201105' title='May 2011'>May 2011</a></li>
	<li><a href='index512b.html?m=201104' title='April 2011'>April 2011</a></li>
	<li><a href='index08fb.html?m=201103' title='March 2011'>March 2011</a></li>
	<li><a href='index52f4.html?m=201102' title='February 2011'>February 2011</a></li>
	<li><a href='index74f1.html?m=201101' title='January 2011'>January 2011</a></li>
	<li><a href='index8956.html?m=201012' title='December 2010'>December 2010</a></li>
	<li><a href='indexa1aa.html?m=201011' title='November 2010'>November 2010</a></li>
	<li><a href='indexe3d5.html?m=201010' title='October 2010'>October 2010</a></li>
	<li><a href='index9ab9.html?m=201009' title='September 2010'>September 2010</a></li>
	<li><a href='index1ff0.html?m=201008' title='August 2010'>August 2010</a></li>
	<li><a href='index9f11.html?m=201007' title='July 2010'>July 2010</a></li>
	<li><a href='index31f0.html?m=201006' title='June 2010'>June 2010</a></li>
	<li><a href='indexd189.html?m=201005' title='May 2010'>May 2010</a></li>
	<li><a href='indexb5c0.html?m=201004' title='April 2010'>April 2010</a></li>
	<li><a href='indexf258.html?m=201003' title='March 2010'>March 2010</a></li>
	<li><a href='index6e30.html?m=201002' title='February 2010'>February 2010</a></li>
	<li><a href='index6b19.html?m=201001' title='January 2010'>January 2010</a></li>
	<li><a href='index5c0a.html?m=200912' title='December 2009'>December 2009</a></li>
	<li><a href='index8f62.html?m=200911' title='November 2009'>November 2009</a></li>
	<li><a href='index451d.html?m=200910' title='October 2009'>October 2009</a></li>
	<li><a href='index3e04.html?m=200909' title='September 2009'>September 2009</a></li>
	<li><a href='index425a.html?m=200908' title='August 2009'>August 2009</a></li>
	<li><a href='index9907.html?m=200907' title='July 2009'>July 2009</a></li>
	<li><a href='index3104.html?m=200906' title='June 2009'>June 2009</a></li>
	<li><a href='indexc36d.html?m=200905' title='May 2009'>May 2009</a></li>
	<li><a href='index17e8.html?m=200904' title='April 2009'>April 2009</a></li>
	<li><a href='index10a5.html?m=200903' title='March 2009'>March 2009</a></li>
	<li><a href='index8988.html?m=200902' title='February 2009'>February 2009</a></li>
	<li><a href='index1419.html?m=200901' title='January 2009'>January 2009</a></li>
	<li><a href='index7866.html?m=200812' title='December 2008'>December 2008</a></li>
	<li><a href='index55f6.html?m=200811' title='November 2008'>November 2008</a></li>
	<li><a href='indexa7bc.html?m=200810' title='October 2008'>October 2008</a></li>
	<li><a href='indexe77c.html?m=200809' title='September 2008'>September 2008</a></li>
	<li><a href='indexcffc.html?m=200808' title='August 2008'>August 2008</a></li>
	<li><a href='index0e62.html?m=200807' title='July 2008'>July 2008</a></li>
	<li><a href='indexfda7.html?m=200806' title='June 2008'>June 2008</a></li>
	<li><a href='index7d64.html?m=200805' title='May 2008'>May 2008</a></li>
	<li><a href='index94dd.html?m=200804' title='April 2008'>April 2008</a></li>
	<li><a href='index9631.html?m=200803' title='March 2008'>March 2008</a></li>
	<li><a href='indexdd52.html?m=200802' title='February 2008'>February 2008</a></li>
	<li><a href='index21ee.html?m=200801' title='January 2008'>January 2008</a></li>
	<li><a href='index363c.html?m=200712' title='December 2007'>December 2007</a></li>
	<li><a href='index7493.html?m=200711' title='November 2007'>November 2007</a></li>
	<li><a href='index93a7.html?m=200710' title='October 2007'>October 2007</a></li>
	<li><a href='index4ca8.html?m=200709' title='September 2007'>September 2007</a></li>
	<li><a href='index6124.html?m=200708' title='August 2007'>August 2007</a></li>
	<li><a href='index6013.html?m=200707' title='July 2007'>July 2007</a></li>
	<li><a href='index2ab6.html?m=200706' title='June 2007'>June 2007</a></li>
	<li><a href='index44f0.html?m=200705' title='May 2007'>May 2007</a></li>
	<li><a href='indexf0b4.html?m=200704' title='April 2007'>April 2007</a></li>
	<li><a href='index481d.html?m=200703' title='March 2007'>March 2007</a></li>
	<li><a href='indexcbea.html?m=200702' title='February 2007'>February 2007</a></li>
	<li><a href='index9cdc.html?m=200701' title='January 2007'>January 2007</a></li>
	<li><a href='index3ea4.html?m=200612' title='December 2006'>December 2006</a></li>
	<li><a href='index67ca.html?m=200611' title='November 2006'>November 2006</a></li>
	<li><a href='indexff49.html?m=200610' title='October 2006'>October 2006</a></li>
	<li><a href='index611c.html?m=200609' title='September 2006'>September 2006</a></li>
	<li><a href='index9a21.html?m=200608' title='August 2006'>August 2006</a></li>
	<li><a href='index3ee9.html?m=200607' title='July 2006'>July 2006</a></li>
	<li><a href='indexe13a.html?m=200606' title='June 2006'>June 2006</a></li>
</ul>
</div>

<div class="aisLeftNav">
			<li id="linkcat-16" class="linkcat"><h2>Blogroll</h2>
	<ul>
<li><a href="http://ayende.com/Blog">Ayende Rahien</a></li>
<li><a href="http://www.softinsight.com/bnoyes/default.aspx">Brian Noyes</a></li>
<li><a href="http://chriskoenig.net/">Chris Koenig</a></li>
<li><a href="http://scienceblogs.com/goodmath/" title="MarkCC reveals the beauty in mathematics and exposes its misuse.">Good Math, Bad Math</a></li>
<li><a href="http://joshsmithonwpf.wordpress.com/">Josh Smith on WPF</a></li>
<li><a href="http://west-wind.com/Weblog/default.aspx">Rick Strahl</a></li>
<li><a href="http://www.udidahan.com/?blog=true">Udi Dahan</a></li>

	</ul>
</li>
<li id="linkcat-17" class="linkcat"><h2>Links</h2>
	<ul>
<li><a href="http://www.absg.com/" title="my day job">ABSG</a></li>
<li><a href="http://www.d20universe.com/" title="my friends boostrap">d20 Universe</a></li>
<li><a href="http://updatecontrols.net/" title="my open source project">Update Controls .NET</a></li>

	</ul>
</li>
<li id="linkcat-32" class="linkcat"><h2>Podroll</h2>
	<ul>
<li><a href="http://dotnetrocks.com/" title="Interviews with leaders in the .NET community.">.NET Rocks!</a></li>
<li><a href="http://hanselminutes.com/" title="News and interviews from all aspects of software, with an insider&#039;s view of Microsoft.">Hanselminutes</a></li>

	</ul>
</li>
	</div>

<div class="aisLeftNav">
<h2>Books</h2>
<iframe src="http://rcm.amazon.com/e/cm?t=adventures0d2-20&amp;o=1&amp;p=8&amp;l=as1&amp;asins=0764526413&amp;fc1=000000&amp;IS2=1&amp;lt1=_blank&amp;lc1=0000ff&amp;bc1=000000&amp;bg1=ffffff&amp;f=ifr" style="width:120px;height:240px;" scrolling="no" marginwidth="0" marginheight="0" frameborder="0" name="I5" id="I5"></iframe>
<br/>
<iframe src="http://rcm.amazon.com/e/cm?t=adventures0d2-20&amp;o=1&amp;p=8&amp;l=as1&amp;asins=0201633612&amp;fc1=000000&amp;IS2=1&amp;lt1=_blank&amp;lc1=0000ff&amp;bc1=000000&amp;bg1=ffffff&amp;f=ifr" style="width:120px;height:240px;" scrolling="no" marginwidth="0" marginheight="0" frameborder="0" name="I6" id="I6"></iframe>
<br/>
<iframe src="http://rcm.amazon.com/e/cm?t=adventures0d2-20&amp;o=1&amp;p=8&amp;l=as1&amp;asins=0136291554&amp;fc1=000000&amp;IS2=1&amp;lt1=_blank&amp;lc1=0000ff&amp;bc1=000000&amp;bg1=ffffff&amp;f=ifr" style="width:120px;height:240px;" scrolling="no" marginwidth="0" marginheight="0" frameborder="0" name="I7" id="I7"></iframe>
<br/>
<iframe src="http://rcm.amazon.com/e/cm?t=adventures0d2-20&amp;o=1&amp;p=8&amp;l=as1&amp;asins=1888009195&amp;fc1=000000&amp;IS2=1&amp;lt1=_blank&amp;lc1=0000ff&amp;bc1=000000&amp;bg1=ffffff&amp;f=ifr" style="width:120px;height:240px;" scrolling="no" marginwidth="0" marginheight="0" frameborder="0" name="I8" id="I8"></iframe>
</div>
<div class="aisLeftNav">
<h2>Meta</h2>
<ul>
		<li><a href="wp-login.html">Login</a></li>
	<li><a href="http://validator.w3.org/check/referer" title="This page validates as XHTML 1.0 Transitional">Valid <abbr title="eXtensible HyperText Markup Language">XHTML</abbr></a></li>
	<li><a href="http://gmpg.org/xfn/"><abbr title="XHTML Friends Network">XFN</abbr></a></li>
	<li><a href="http://wordpress.org/" title="Powered by WordPress, state-of-the-art semantic personal publishing platform.">WordPress</a></li>
	</ul>
</div>
<div class="aisLeftContent">
<h2>Community</h2>
<ul>
	<script type="text/javascript" src="../../localhost/embed/92q2bbma.js"></script>
</ul>
</div>

</div></div></div>
</div>		</td>
		<td>

	<div id="content" class="narrowcolumn">

	
		
			<div class="post" id="post-28">
				<h2><a href="index3c55.html?p=28" rel="bookmark" title="Permanent Link to Separate Concerns">Separate Concerns</a></h2>
				<small>September 7th, 2006 <!-- by Michael L Perry --></small>

				<div class="entry">
					<p>A spreadsheet contains both formulas and the data on which they operate. This makes it difficult to share formulas with someone else without sharing the data. If you want the same calculations performed on a different set of data, you have to make a copy of the spreadsheet. If you later need to update the calculations, you have to make the change in both places.</p>
<p>A Visual Source Safe database contains one tree of folders. A folder can represent a project, a package, a branch, or a shared library. Through discipline, programmers keep these different degrees of freedom on different levels of the tree. We will create a folder under a project to represent the trunk, and another to represent a branch. But what about branches of the shared libraries? Where do they go? Sometimes it is not easy to place one concern neatly below another.</p>
<p>An Ant build script contains several targets. A target can represent an action (clean, compile, deploy, etc.), or it can represent a project (shared library, business logic, web application, etc.). Targets depend upon other targets: deploy depends upon compile, and the web application depends upon the business logic. I need to clean and compile each of my projects, but only deploy my web applications. The web application deployment should include all dependent projects. When describing this to Ant, I end up with a cartesian product of actions for each project. If I later have to modify an action, I have to do so for every project. Similarly, to add a new project, I have to copy and paste all of the actions from another one.</p>
<p>All three of these scenarios suffer from a coupling of concerns. Different dimensions of the problem should be allowed to vary independently. But when the design of the solution mixes these dimensions, it becomes difficult to pull them apart later. Unfortunately, this sort of design flaw is usually not detected until the system has been in use for some time. Please take the time during the design phase to ask if yourself if you can separate concerns.</p>
				</div>

				<p class="postmetadata">Posted in <a href="indexfa64.html?cat=24" title="View all posts in Ant" rel="category">Ant</a>,  <a href="indexb0b7.html?cat=6" title="View all posts in Patterns" rel="category">Patterns</a>,  <a href="indexaa1e.html?cat=4" title="View all posts in VSS" rel="category">VSS</a> |   <a href="index3c55.html?p=28#comments" title="Comment on Separate Concerns">1 Comment &#187;</a></p>
			</div>

		
			<div class="post" id="post-27">
				<h2><a href="index1c4a.html?p=27" rel="bookmark" title="Permanent Link to The Train-Switch Pattern">The Train-Switch Pattern</a></h2>
				<small>September 5th, 2006 <!-- by Michael L Perry --></small>

				<div class="entry">
					<p>I've often heard server maintenance compared to changing the tires on a truck going 80 miles an hour. You can't take down the datacenter to install a new build. You have to do it on the fly.</p>
<p>J2EE application servers like JBoss are supposed to be able to do this. However, in my experience, I've never seen it work reliably. We've had to fall back on using the load balancer to divert traffic away from one web server at a time in order to perform the upgrade. This is a costly and difficult chore. And if something goes wrong during the operation, you are without backup.</p>
<p>Since this is such a difficult problem, I've rewitten it -- in the true spirit of mathematics -- into one that is easier.  The computer system is not one big monolith, but many discrete transactions that each have a beginning and an end. No longer are we working on one huge semi, we are working on several small train cars, all hurtling down the same track at incredible speed.</p>
<p>The load balancer solution diverts the traffic without waiting for (or causing) a lull. But the problem with the load balancer solution is that it is performed on the socket boundary. Good socket optimizations -- like pooling, asynchronous communications, and multiplexing -- favor long-lived sockets. This means that the load balancer tends to take a long time to quiet the traffic to one machine. Sockets are also intrisicly hardware-oriented. A socket addresses an IP, which the router maps to a specific NIC. Any socket-based switching solution would place unnecessary constraints on the hardware required to run it. You can't, for example, scale it all the way down to 1 server. What we need is a switch on logical rather than physical boundaries.</p>
<p><strong>Here's my solution</strong><br />
I have started designing into my solutions a train-switch at the transaction boundary. As a request comes in (not a socket, but an individual request), I'll have an infrastructure component parse it and prepare it for the business logic. Then, it will look in a business logic registry to obtain the pointer to the current handler. That request is forwarded to the handler and the infrastructure listends for more requests.</p>
<p>What makes this a train-switch is that the infrastructure also has a background thread waiting for updates. I could detect these updates as new DLLs or JARs in a special folder, but I prefer explicit notification. When the update is available, the infrastructure loads it and gets it ready. Then, in one quick synchronized action, it replaces the pointer in the registry. Now all new requests are directed toward the new version of the business logic.</p>
<p>What happens to the requests already in progress? They continue unharmed. The train-switch is only at the head of the track. Both business logic components can run in parallel. The switch is made while the system is up with absolutely no interruption.</p>
<p>There are a few things that you need to do to make this possible. First, avoid singletons. Singletons are convenient, but you can't have two different versions of a singleton running in parallel. Instead, use dependency-injection. Instead of an object getting the instance of a singleton that it needs, give that object a pointer to its service provider. That way you tell it explicitly which instance it depends upon, and two can run in parallel with no problem.</p>
<p>Second, business components must be self-contained, except at the boundaries. If a business component reaches outside of itself for some dependencies, then you can no longer upgrade those dependencies. There are only two boundadies that the request may cross: the business entry point and the data access layer. Define an interface for the business entry point, and use dependency-injection to give the business logic access to the database connection pool.</p>
<p>Third, you need to have one entry point into the application. You can try to use the train-switch pattern to swap out socket listeners, but then you are back to the problems with the load-balancer solution. The socket boundary is bigger than the problem requires, so you will have old code running longer than is necessary. Also, the listener switch cannot be performed atomically. If you take down the first listener and then put up the second, there is a chance that a socket connection will be refused. If you try the opposite order, you will find the address already in use. The only way to achieve an atomic train-switch is to have one consistent listener that lives outside of the more volitile business logic.<br />
Fourth, define a loose interface for the business logic. Since the listener cannot be replaced, its contract with the business layer cannot be changed. So define a contract that is flexible enough to handle changes to business needs. Property bags work well on this boundary; strict business method or document definitions do not. You should definitely have a strict contract between the client and the server, but the train-switch is not the place to enforce it.</p>
<p>I'm not sure why applciation servers like JBoss fail so miserably at reliable "hot-swapping". The container implements the listener and calls servlets on request -- not socket -- boundaries. And servlets define an extremely flexible interface. Perhaps they have problems with external dependencies. At any rate, I find it best to inject dependencies across interface boundaries and implement the train-switch pattern myself.</p>
				</div>

				<p class="postmetadata">Posted in <a href="indexb0b7.html?cat=6" title="View all posts in Patterns" rel="category">Patterns</a> |   <a href="index1c4a.html?p=27#comments" title="Comment on The Train-Switch Pattern">2 Comments &#187;</a></p>
			</div>

		
			<div class="post" id="post-26">
				<h2><a href="index88b9.html?p=26" rel="bookmark" title="Permanent Link to Building Bridges">Building Bridges</a></h2>
				<small>August 30th, 2006 <!-- by Michael L Perry --></small>

				<div class="entry">
					<p>What is an architect? That's easy. It's someone who builds bridges. My 10 year old can tell you that.</p>
<p>When it comes to software architecture, the industry has had a hard time nailing down a definition of the role. But even in software, it amounts to the same thing. An architect is someone who bridges the gap between business needs and technological solutions.</p>
<p>Some of my friends at Radiant considered an architect to be a lot like a conductor of an orchestra. He's the guy who stands at the front of the room with the baton (or dry-erase marker), waiving his arms, and not actually producing any music (or code). Then, when the performance (project) is done, he's the guy who turns to the audience and takes a bow.</p>
<p>Being a good architect, I would occasionally oblige them by waiving my arms in big circles as I made some grand pronouncement about how our systems should be continuously-integrated, service-oriented, test-driven masterpieces. But all the while I believe that we all understood the role that I played as architect.</p>
<p>As an architect, I was principally responsible to the business for technological decisions, even those I did not make myself. It was my duty to ensure that the business needs were met while preserving the integrity of the solution. I was tasked with weighing the cost of a technology with the benefits of its solution. At the end of the day, it was my assessment that helped the business analysts to decide the best course.</p>
<p>My responsability was also to the engineers. I had to recommend the patterns, practices, and tools that were suitable to the task that the development engineers had to perform. I had to ensure that operations had the visibility and control that they needed to run the system. I had to oversee a smooth transition of a product from development through production and into maintenance.</p>
<p>So my definition of a software architect is someone who builds bridges. Between business and technology. Between analysis and implementation. Between development and operations. You have to waive your arms pretty wide to reach all those places at once.</p>
				</div>

				<p class="postmetadata">Posted in <a href="indexb31a.html?cat=1" title="View all posts in Uncategorized" rel="category">Uncategorized</a> |   <a href="index88b9.html?p=26#comments" title="Comment on Building Bridges">1 Comment &#187;</a></p>
			</div>

		
			<div class="post" id="post-25">
				<h2><a href="index970c.html?p=25" rel="bookmark" title="Permanent Link to Cygwin Makes it Easy">Cygwin Makes it Easy</a></h2>
				<small>August 29th, 2006 <!-- by Michael L Perry --></small>

				<div class="entry">
					<p>To be effective at my new job, I have learned my way around a Linux box. For my entire career so far, I've lived in an exclusively Windows environment. But now I've been introduced to a whole new world. I confess that it has been quite exhilarating.</p>
<p>The transition from Windows to Linux was a bit daunting at first, but one product helped me bridge the gap. Cygwin is a Unix shell that runs within Windows. You don't have to dual-boot. You don't have to install a new OS. You don't have to install a virtual machine. It just presents a bash shell as if it were a DOS command window.  (Other shells are available, too.)</p>
<p>What really makes Cygwin a winner is the ease with which you can install and upgrade it. Just go to cygwin.com, find a mirror near you, and run setup.exe. It will present you with a set of packages that you can install. Then it downloads only what you choose, so you don't waste time or bandwidth on features you won't use.</p>
<p>Don't worry about the shear number of packages available. If you don't know what you need, just take the defaults. When you discover that you need a new package, you can always run setup.exe again. It will remeber which mirror you chose last time, and will only download and install the new packages that you select. It couldn't be any easier.</p>
<p>Here are the packages that I use:</p>
<p>OpenSSH - secure shell and file transfer. I use this to access Linux servers running in the datacenter.</p>
<p>Nano - a simple text editor.</p>
<p>gcc - a C/C++ compiler. We use Java at work, but I expect to start a Linux C++ project at home.</p>
<p>Some friends from Radiant tried to convince me to use Cygwin before. I wish I had listened then. Sorry, John and Daniel!</p>
				</div>

				<p class="postmetadata">Posted in <a href="indexd65e.html?cat=8" title="View all posts in User Interface" rel="category">User Interface</a> |   <a href="index970c.html?p=25#comments" title="Comment on Cygwin Makes it Easy">2 Comments &#187;</a></p>
			</div>

		
			<div class="post" id="post-24">
				<h2><a href="index2cf9.html?p=24" rel="bookmark" title="Permanent Link to The Self-Important Application">The Self-Important Application</a></h2>
				<small>August 27th, 2006 <!-- by Michael L Perry --></small>

				<div class="entry">
					<p>I love Cucusoft's iPod video converter. I can download movies from Channel 9 as WMV and convert them to MP4 for my video iPod. And for the most part their UI is fantastic. They provide a simple drag-and-drop mechanism for getting my videos into the pipeline.</p>
<p>But when they bundled two of their converters together into one suite, they made a big UI mistake in the process. Now when you close the main window, the following prompt appears:</p>
<p><img alt="Are you sure you want to quit?" title="Are you sure you want to quit?" src="../../www.adventuresinsoftware.com/blog/wp-content/uploads/2006/08/areyousure.jpg" /></p>
<p>This is a wonderful application, but it is not so wonderful that I would never want to close it. There is no loss of information when the program shuts down, so this prompt is not protecting me from an irreversable operation. It's just an annoyance.</p>
<p>Cucusoft's is not the first app that I've seen make this mistake. My wife still uses B's Recorder Gold to back up her machine, and it has the same problem. I also remember this prompt from several early Visual Basic apps, but the community seems to have learned since then. I just wish everyone would take the lesson to heart.</p>
				</div>

				<p class="postmetadata">Posted in <a href="indexd65e.html?cat=8" title="View all posts in User Interface" rel="category">User Interface</a> |   <a href="index2cf9.html?p=24#comments" title="Comment on The Self-Important Application">1 Comment &#187;</a></p>
			</div>

		
			<div class="post" id="post-22">
				<h2><a href="index0345.html?p=22" rel="bookmark" title="Permanent Link to Problems with Naming">Problems with Naming</a></h2>
				<small>August 24th, 2006 <!-- by Michael L Perry --></small>

				<div class="entry">
					<p>As you probably know, DNS is the way that computers turn names (like mallardsoft.com) into addresses (like 216.154.223.70). The DNS system was invented as a convenience to TCP/IP network users so that they wouldn't have to remember numbers or maintain their own hosts file. It has since become something much bigger.</p>
<p>The assignment of names and numbers is controlled by ICANN, the Internet Corporation for Assigned Names and Numbers. As their name implies, ICANN is a corporation, so it is controlled by US law. Other nations have very little influence in the way they conduct business, which is obviously a cause for concern. The Internet may have been born here, but it is now very much an international platform. Considering how much business is done online, I can understand the concern.</p>
<p>What is most troublesome is the way that the business of naming has evolved. ICANN controls the central registry of names. Somebody has to, since the name mallardsoft.com must always resolve to the same address no matter who types it in. DNS itself is a peer-to-peer protocol that distributes the registry, but the problem of naming demands that one organization must resolve conflicts.</p>
<p>ICANN outsources the actual registration process to other corporations, the registrars. These include some big names like Namesecure, AOL, NetworkSolutions, and GoDaddy. But many smaller corporations have also gotten into the registration business. (For an entertaining look inside the business of registration, please listen to <a href="http://www.bobparsons.com/" target="_blank">Bob Parsons</a>, CEO of GoDaddy). Not all of these registrars provide the same level of service. Some don't service customers at all.</p>
<p>Names have become hot property. Common words are especially valuable. According to <a href="http://www.active-domain.com/resources/million-dollar-domains.htm" target="_blank">one registrar</a>, "Business.com" sold for $8 million. That's a lot to pay for a part of the English language. If you check out the site, you will find a search engine. This is the unfortunate reality of naming: the owners of these names do not need to add value to them. Someone who has a legitimate desire to provide value on line has to pay one of these squatters for the name they want, or make up some obscure name that isn't yet taken.</p>
<p>I have been concerned about this problem for a while. When ICANN started to charge for names, I thought that it would be less of an issue. As long as the resource is not free, you have to add value in order to recoup your investment, right? No. In his last podcast episode, Bob Parsons talks about Kiting or Tasting names. Domain registrars can obtain domain names from ICANN, put up a search page, and then return it to ICANN after a few days for a full refund. If they get enough traffic with that name, they'll keep it. If not, they haven't lost anything.</p>
<p>Another disturbing behavior is to register common misspellings of popular sites. This usually brings you to a page that tries to make money through some other means, like paid advertisements or sales of spyware blockers. Occasionally, though, the fake site will mimic the real one that you tried to visit, and may entice you to reveal passwords or personal data.</p>
<p>I am a capitalist at heart. I don't begrudge anyone doing anything legal and ethical to make money. These practice -- while robbing value-providing entrepreneurs of the resource of domain names -- are usually neither illegal, nor unethical. However, any system that rewards this kind of behavior is broken. The cornerstone of capitalism is that the market rewards businesses according to the value that they provide. If you can make money without providing value, then the system that you are using is ultimately not market-driven.</p>
<p><strong>So here's my solution</strong></p>
<p>This is one I learned from my wife. I Google everything, even known domain names. I never type names into the address bar of my browser. Google has very effective page ranking algorithms and an incredibly large user base from which to glean data. Theirs is not a centrally managed naming system. Theirs is a community ranking system. If I'm looking for youtube.com and I accidentally search for "utube", the first link in Google will take me to the right place. If I enter the same thing into the address bar I end up at Universal Tube and Rollform Equipment Corporation. Obviously, they are providing value with their site, but that isn't where I wanted to go.</p>
<p>The idea that a corporation owns a domain name is fundamentally flawed, especially in today's international marketplace. Naming implies registration, which implies that someone controls the names. How is this central registrar supposed to decide who provides value with that name and who is just squatting? ICANN can't do it, and doesn't even try. But the market can. Search engines like Google that use community data enable us, the market, to decide who is providing value. If DNS were to stop working tomorrow, searching would still work. Only the squatters and kiters that would loose out.</p>
				</div>

				<p class="postmetadata">Posted in <a href="index29c7.html?cat=11" title="View all posts in Naming" rel="category">Naming</a> |   <a href="index0345.html?p=22#respond" title="Comment on Problems with Naming">No Comments &#187;</a></p>
			</div>

		
			<div class="post" id="post-21">
				<h2><a href="index3965.html?p=21" rel="bookmark" title="Permanent Link to What kind of combo box is it?">What kind of combo box is it?</a></h2>
				<small>August 21st, 2006 <!-- by Michael L Perry --></small>

				<div class="entry">
					<p>Does anyone else remember Windows 3.1? So much has changed since then, and most of it for the better. But there is one thing that has bugged me ever since Windows 95. Microsoft messed up the combo box control.</p>
<p>A combo box control is a combination edit control and list box. It can be used in one of three ways. A simple combo box displays both the edit control and the list box at all times, and the text is editable. A drop-down combo box displays the list only when you click the button, and the text is still editable. A drop-down list displays the list when you click the button, but the text is not editable: you can only pick something from the list.</p>
<p>Yes, I agree that those three names are poorly chosen. It has taken me 12 years to remember which one is a drop-down and which is a drop-down list.</p>
<p>But what's worse than that is that a user cannot see the difference. Both a drop-down and a drop-down list appear as a box containing text with a button off to the right. The user has to hover over the control to see if the arrow turns into an I beam, or click on the control to see if a blinking cursor appears. A user should never have to interact with a control to discover its function.</p>
<p>Do you remember what the combo box looked like in Windows 3.1? Yes, it was flat instead of being chiseled into the gunmetal of the dialog box, but there was something else. Give up?</p>
<p>In Windows 3.1, a drop-down combo box (which allows editing of the text) had a gap between the edit control and the button. A drop-down list (which does not) had the two stuck together as they are today. This made it immediately obvious which kind of combo box control it was. If the text box stood alone, then it was independently editable. If the text box was stuck to a button, then you were stuck with the choices in the list. Simple.</p>
<p>I wish Microsoft would correct their error and bring back the visually discoverable combo box. I could create my own custom control to fix the problem, but since it is no longer standard I would just end up causing more confusion.</p>
				</div>

				<p class="postmetadata">Posted in <a href="indexd65e.html?cat=8" title="View all posts in User Interface" rel="category">User Interface</a> |   <a href="index3965.html?p=21#respond" title="Comment on What kind of combo box is it?">No Comments &#187;</a></p>
			</div>

		
			<div class="post" id="post-20">
				<h2><a href="index341b.html?p=20" rel="bookmark" title="Permanent Link to Scroll within a scroll">Scroll within a scroll</a></h2>
				<small>August 18th, 2006 <!-- by Michael L Perry --></small>

				<div class="entry">
					<p>As I've said before, I'm a big fan of WordPress. However, they did make one big user interface mistake. They have the dreaded scroll bar on a scrollable page. As I am typing this post, I can scroll down to see a preview of my article. This preview is itself scrollable.</p>
<p>As programmers we are used to thinking recursively. We often have to write nested loops or call recursive functions. So when we see one thing nested within another, we don't think twice about it. But users don't think like us. Nested scroll bars confuse most people.</p>
<p>But even if the UI is not confusing, there are a couple of practical usability issues that generaly arise when you nest scroll bars. First is the horizontal size. If the inner scroll region is wider than the outer scroll region, the user has to scroll right to even see the inner scroll bar. While the inner scroll bar is off the screen, the user doesn't even realize that there is a problem. They might scroll down to the bottom of the outer region and see that their data is cut off. If they could see the inner scroll bar, they would know that more data appears below, off screen.</p>
<p>Another common usability issue with the nested scroll bar is the behavior of the scroll wheel. The wheel will usually scroll through the outer region until the inner region happens to move up under the mouse. At that point, the scroll wheel will operate on the inner region. When that one gets to the end of the document, it again operates on the outer region. This is quite disconcerting.</p>
<p>The nested scroll bar is hard to avoid in web based applications. The best practice, I believe is to define a frame set, and have each scrollable region within a frame. This allows the user to resize and scroll each frame individually. Unfortunately, this is difficult to code for, but your users will appreciate the effort.</p>
<p>When a rich client has nested scroll bars, the application developer has no excuse. No matter what the development environment, split frames are easy on the desktop. Take, for example, JMeter (http://jakarta.apache.org/jmeter/). This is an extremely useful program that I rely upon day after day, yet it has an infuriating nested scroll bar in the view results tree. I have to maximize the window in order to see the scroll bar for the results of my HTTP request.</p>
<p>So please do your users a favor and avoid the nested scroll bar.</p>
				</div>

				<p class="postmetadata">Posted in <a href="indexd65e.html?cat=8" title="View all posts in User Interface" rel="category">User Interface</a> |   <a href="index341b.html?p=20#respond" title="Comment on Scroll within a scroll">No Comments &#187;</a></p>
			</div>

		
			<div class="post" id="post-19">
				<h2><a href="index5831.html?p=19" rel="bookmark" title="Permanent Link to The first tenet of object-oriented programming">The first tenet of object-oriented programming</a></h2>
				<small>August 16th, 2006 <!-- by Michael L Perry --></small>

				<div class="entry">
					<p>What are the tenets of object-oriented programming? This was a popular interview question back in the early 90's. And the expected answer was: encapsulation, inheritance, and polymorphism.</p>
<p>But go back and read Rumbaugh, OOM&#038;D. In chapter 3 where he begins to build the Object Modeling Technique, he starts with the idea of identity. Identity is the inherent uniqueness of objects, independent of any attributes. Two objects may look the same, act the same, and have the same state, but an action performed on one does not affect the other. They are two distinct objects.</p>
<p>This fundamental idea is the keystone of object-oriented analysis, design, and programming. I argue that it is the most important of the four (not three) tenets of OO. And yet it is the one that people often neglect.</p>
<p>If you program in any object-oriented language, I challenge you to really think about how identity manifests itself in your code and designs. Consider how you use it, and what its consequences are. For example, if you are a C++ programmer, consider why you would use a pointer rather than a value. If you pass a pointer to an object into a function, that function can operate on that particular object. If you pass the object itself (i.e. by value), then the function can only work on a copy of the object. But if that object itself contains a pointer to another object, then the pointer is copied, and the function again has access to it. So you use pointers when you want identity.</p>
<p>If you work in Java, then pointer is a bad word. Some people like to say that there are no pointers in Java, because of the bad reputation pointers got in C++ (memory leaks, buffer overruns, protection faults). Others like to say that everything is a pointer in Java, because Java has a reference type system. Only some of the built-in types are values. So when you pass an object to a method in Java, you have to pass its identity to that function. The function can then do anything it wants to that object. The language does not make a copy, like C++ does, to protect its identity.</p>
<p>This usually isn't a problem, because you are used to the way the language works. You might make objects immutable to avoid the possibility that the method will change it, or pass in an interface that exposes just the read-only methods. In extreme cases you might even make an explicit copy yourself. But you know that identity is being shared, and so you code for it.</p>
<p>If you code in C#, then you have options. You can define types that want identity as classes, and types that don't want identity as structs. Classes are reference types (i.e. have identity), and structs are value types (i.e. don't). So when you pass an object to a method, you share its identity. When you pass a structure, you don't. But C# gives you one more choice. You can declare your value-typed parameter using "ref". This suddenly gives the structure identity so that the function can modify it. You probably won't need to do this very often, but when you do you will see identity at work in your app.</p>
<p>Identity is also apparent in design. Most of the gang-of-four design patterns are heavily dependent upon identity. A visitor is given the identity of an object to visit. A state machine knows the identity of its current state. Each strategy has identity so that it can be distinguished from other strategies that implement the same interface. Patterns that do not take advantage of identity have consequences that derive from that fact. Flyweights must be immutable (since their identity is shared and must not be exploited). Singletons have identity, but the identity of the instance is synonymous with that of the type, and must therefore be protected (against multi-threaded access, or duplicate creation).</p>
<p>If you draw your designs on a white board or a piece of paper, objects with identity will be visible as boxes or circles. They will be independent yet related to other objects in the drawing. If you draw an arrow from one object to another, you are representing the fact that one object knows the identity of the other. You will probably construct a graph of objects that know each others identities, and live for some time within the system.</p>
<p>Types that don't want identity will appear as members or parameters of those objects. They will not have a life of their own outside of their identifiable hosts.</p>
<p>If you engage in object-oriented analysis, design, or programming, you use identity. But most people fail to recognize it. You may find yourself wondering whether to declare that new C# type as a struct or a class. You may wonder whether you should make that method static or not. You may consider reusing an object instead of creating a new one each time. If you put the idea of identity at the front of your thinking, then the answers to all of these questions become apparent.</p>
				</div>

				<p class="postmetadata">Posted in <a href="indexb0b7.html?cat=6" title="View all posts in Patterns" rel="category">Patterns</a> |   <a href="index5831.html?p=19#respond" title="Comment on The first tenet of object-oriented programming">No Comments &#187;</a></p>
			</div>

		
			<div class="post" id="post-18">
				<h2><a href="index0735.html?p=18" rel="bookmark" title="Permanent Link to Order-sensitive unit testing">Order-sensitive unit testing</a></h2>
				<small>August 12th, 2006 <!-- by Michael L Perry --></small>

				<div class="entry">
					<p>I've spoken brifly in the post TDD Test Drive about using NMock2 to test a transaction pump. For this test, I mocked the transaction queue, the web service, and the dialup connection manager. I did this so that I could make sure, for example, that the transaction pump dialed the phone before it invoked the web service.</p>
<p>I set up expectations in my code as follows:</p>
<pre>&nbsp;&nbsp;&nbsp;&nbsp;[TestFixture]
&nbsp;&nbsp;&nbsp;&nbsp;public class FirstTest
&nbsp;&nbsp;&nbsp;&nbsp;{
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;private Mockery _mockery;
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;private DialupConnectionManager _dialupConnectionManager;
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;private TransactionService _transactionService;
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;private TransactionPump _transactionPump;

&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;[SetUp]
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;public void SetUp()
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;_mockery = new Mockery();
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;_dialupConnectionManager =
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;_mockery.NewMock();
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;_transactionService = _mockery.NewMock();
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;_transactionPump = new TransactionPump(_dialupConnectionManager,
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;_transactionService);
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}

&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;[TearDown]
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;public void TearDown()
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;_mockery.VerifyAllExpectationsHaveBeenMet();
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}

&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;[Test]
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;public void TestPump()
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Expect.Once.On(_dialupConnectionManager).Method("Dial");
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Expect.Once.On(_transactionService).Method("SendTransaction").
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;With("Hello");
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Expect.Once.On(_dialupConnectionManager).Method("HangUp");
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;_transactionPump.Run();
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}
&nbsp;&nbsp;&nbsp;&nbsp;}</pre>
<p>The tests failed, I made them pass, then I moved on to the next. Unfortunatly, they passed for the wrong reasons.</p>
<p>My transaction pump had a bug in it that caused the dialup connection to dial at the wrong times (it was much more complex than the example given above). By default, NMock validates that all expectations are met, but not in the order that you specified. You have to take one additional step to get there:</p>
<pre>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;public void TestPump()
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;using (_mockery.Ordered)
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Expect.Once.On(_dialupConnectionManager).Method("Dial");
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Expect.Once.On(_transactionService).Method("SendTransaction").
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;With("Hello");
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Expect.Once.On(_dialupConnectionManager).Method("HangUp");
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;_transactionPump.Run();
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</pre>
<p>I had already written 40 tests with the assumption that NMock was validating order, so I didn't want to add this using statement to every test. Instead, I added it to the SetUp and TearDown methods:</p>
<pre>&nbsp;&nbsp;&nbsp;&nbsp;[TestFixture]
&nbsp;&nbsp;&nbsp;&nbsp;public class FirstTest
&nbsp;&nbsp;&nbsp;&nbsp;{
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;private Mockery _mockery;
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;private DialupConnectionManager _dialupConnectionManager;
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;private TransactionService _transactionService;
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;private TransactionPump _transactionPump;

&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;private IDisposable _ordered;

&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;[SetUp]
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;public void SetUp()
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;_mockery = new Mockery();
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;_dialupConnectionManager =
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;_mockery.NewMock();
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;_transactionService = _mockery.NewMock();
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;_transactionPump = new TransactionPump(_dialupConnectionManager,
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;_transactionService);

&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;_ordered = _mockery.Ordered;
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}

&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;[TearDown]
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;public void TearDown()
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;_ordered.Dispose();

&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;_mockery.VerifyAllExpectationsHaveBeenMet();
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}

&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;[Test]
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;public void TestPump()
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Expect.Once.On(_dialupConnectionManager).Method("Dial");
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Expect.Once.On(_transactionService).Method("SendTransaction").
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;With("Hello");
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Expect.Once.On(_dialupConnectionManager).Method("HangUp");
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;_transactionPump.Run();
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}
&nbsp;&nbsp;&nbsp;&nbsp;}</pre>
<p>This caused all unit tests to become order-sensitive. Not surprisingly, this revealed some errors in other test that I tought were working. Unit testing with NMock2 is incredibly effective, but you must be aware of this caveat. If order matters (and it usually does), then tell NMock2 to pay attention to it.</p>
				</div>

				<p class="postmetadata">Posted in <a href="index3f7b.html?cat=2" title="View all posts in Unit testing" rel="category">Unit testing</a> |   <a href="index0735.html?p=18#respond" title="Comment on Order-sensitive unit testing">No Comments &#187;</a></p>
			</div>

		
		<div class="navigation">
			<div class="alignleft"><a href="index12f6.html?paged=38">&laquo; Previous Entries</a></div>
			<div class="alignright"><a href="indexf2e6.html?paged=36">Next Entries &raquo;</a></div>
		</div>

	
	</div>
		</td>
	</tr>
</table>

<hr />
<div id="footer">
<!-- If you'd like to support WordPress, having the "powered by" link someone on your blog is the best way, it's our only promotion or advertising. -->
	<p>
		Adventures in Software is proudly powered by 
		<a href="http://wordpress.org/">WordPress</a>
		<br /><a href="indexd784.html?feed=rss2">Entries (RSS)</a>
		and <a href="indexa6da.html?feed=comments-rss2">Comments (RSS)</a>.
		<!-- 21 queries. 0.459 seconds. -->
	</p>
</div>
<script type="text/javascript">
var gaJsHost = (("https:" == document.location.protocol) ? "https://ssl." : "http://www.");
document.write(unescape("%3Cscript src='" + gaJsHost + "google-analytics.com/ga.js' type='text/javascript'%3E%3C/script%3E"));
</script>
<script type="text/javascript">
try {
var pageTracker = _gat._getTracker("UA-389401-3");
pageTracker._trackPageview();
} catch(err) {}</script></div>

<!-- Gorgeous design by Michael Heilemann - http://binarybonsai.com/kubrick/ -->

		<div id="sk2-footer" style="color:#FFF; background-color:#444; padding: 3px 2px 3px 2px; border-top: #888 solid 1px;">This blog is protected by <a href="http://unknowngenius.com/blog/" title="Dave">dr Dave</a>'s <strong><a href="http://unknowngenius.com/blog/wordpress/spam-karma/" title="SK2">Spam Karma 2</a></strong>: <strong>274531</strong>  Spams eaten and counting...</div><script type="text/javascript" src="replies.js"></script>
<script type="text/javascript" src="blogger.js"></script>
<script type="text/javascript" src="http://twitter.com/statuses/user_timeline/michaellperry.json?callback=twitterCallback2&amp;count=5"></script>
<script type="text/javascript" src="http://search.twitter.com/search.json?q=@michaellperry&amp;callback=twitterCallbackReplies&amp;rpp=5"></script>
</body>

<!-- Mirrored from adventuresinsoftware.com/blog/?paged=37 by HTTrack Website Copier/3.x [XR&CO'2014], Fri, 13 Jan 2017 13:11:21 GMT -->
</html>
