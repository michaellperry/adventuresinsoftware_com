<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" dir="ltr">


<!-- Mirrored from adventuresinsoftware.com/blog/?cat=36 by HTTrack Website Copier/3.x [XR&CO'2014], Fri, 13 Jan 2017 12:54:57 GMT -->
<!-- Added by HTTrack --><meta http-equiv="content-type" content="text/html;charset=UTF-8" /><!-- /Added by HTTrack -->
<head profile="http://gmpg.org/xfn/11">
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8" />

<title>Adventures in Software   &raquo; Update Controls</title>

<meta name="generator" content="WordPress 2.3.3" /> <!-- leave this for stats -->

<link rel="stylesheet" href="wp-content/themes/ais2/style.css" type="text/css" media="screen" />
<link rel="alternate" type="application/rss+xml" title="Adventures in Software RSS Feed" href="indexd784.html?feed=rss2" />
<link rel="pingback" href="xmlrpc.html" />
    <script type="text/javascript">
        function onSilverlightError(sender, args) {
            var appSource = "";
            if (sender != null && sender != 0) {
              appSource = sender.getHost().Source;
            }
            
            var errorType = args.ErrorType;
            var iErrorCode = args.ErrorCode;

            if (errorType == "ImageError" || errorType == "MediaError") {
              return;
            }

            var errMsg = "Unhandled Error in Silverlight Application " +  appSource + "\n" ;

            errMsg += "Code: "+ iErrorCode + "    \n";
            errMsg += "Category: " + errorType + "       \n";
            errMsg += "Message: " + args.ErrorMessage + "     \n";

            if (errorType == "ParserError") {
                errMsg += "File: " + args.xamlFile + "     \n";
                errMsg += "Line: " + args.lineNumber + "     \n";
                errMsg += "Position: " + args.charPosition + "     \n";
            }
            else if (errorType == "RuntimeError") {           
                if (args.lineNumber != 0) {
                    errMsg += "Line: " + args.lineNumber + "     \n";
                    errMsg += "Position: " +  args.charPosition + "     \n";
                }
                errMsg += "MethodName: " + args.methodName + "     \n";
            }

            throw new Error(errMsg);
        }
    </script>

	<link rel="EditURI" type="application/rsd+xml" title="RSD" href="xmlrpc0db0.php?rsd" />
 <link rel="wlwmanifest" type="application/wlwmanifest+xml" href="wp-includes/wlwmanifest.xml" /> <style type='text/css'>
<!--#header { background: url('wp-content/themes/ais2/images/header-imgae03.html?upper=A7A73F&amp;lower=77773F') no-repeat bottom center; }
--></style>
</head>
<body>
<div id="page">

<div class="aisTopBar">
	<form method="get" id="searchform" action="http://adventuresinsoftware.com/blog/">
<div>
<a href="indexd784.html?feed=rss2"><img src="../images/feed-icon-28x28.png" border="0"></a>
<input type="text" value="" name="s" id="s" />
<input type="submit" id="searchsubmit" value="Search" />
</div>
</form>
</div>

<div class="aisHeaderImageRight">
	<div class="aisHeaderImage">
	<div class="aisHeaderCornerRight">
	<div class="aisHeaderCornerLeft">
	<div class="aisImageBar">
	<div class="aisSubSites">
		<a href="index.html" class="aisSubSiteLink"><span class="aisSiteTabRight"><span class="aisSiteTabLeft"><span class="aisSiteTab">
			home</span></span></span></a>
		<a class="aisSubSiteLink" href="indexb60a.html?cat=27"><span class="aisSiteTabRight"><span class="aisSiteTabLeft"><span class="aisSiteTab">
			historic modeling</span></span></span></a>
		<a class="aisSubSiteLink" href="indexa88f.html?cat=36"><span class="aisSiteTabRight"><span class="aisSiteTabLeft"><span class="aisSiteTab">
			update controls</span></span></span></a>
		<a href="index2d79.html?cat=26" class="aisSubSiteLink"><span class="aisSiteTabRight"><span class="aisSiteTabLeft"><span class="aisSiteTab">
			degrees of freedom</span></span></span></a>
		<a class="aisSubSiteLink" href="indexba53.html?page_id=2"><span class="aisSiteTabRight"><span class="aisSiteTabLeft"><span class="aisSiteTab">
			about us</span></span></span></a>

	</div>
	</div>
	</div>
	</div>
	</div>
</div>

<table style="width: 100%" cellspacing="0" cellpadding="0">
	<tr valign="top">
		<td width="210px">
<div id="sidebar">
<div class="aisLeftColumnFill">
<div class="aisLeftColumnBottom">
<div class="aisLeftColumnTop">
<div id="twitter_div" class="aisLeftNav">
<h2 class="sidebar-title">Twitter Updates</h2>
<ul id="twitter_update_list"></ul>
<a href="http://twitter.com/michaellperry" id="follow">Follow me</a>
</div>
<div id="twitter_reply_div" class="aisLeftNav">
<h2 class="sidebar-title">Twitter Replies</h2>
<ul id="twitter_reply_list"></ul>
</div>

<div class="aisLeftNav">
<a href='http://ineta.org/Speakers/SearchCommunitySpeakers.aspx?SpeakerId=c5110e21-9243-461b-a464-a6548524e885'><img alt='INETA Community Speakers Program' border='0' src='../../www.ineta.org/images/OfficialLogos/InetaCommunitySpeakersRequestMe.html' /></a>
</div>

<div class="aisLeftNav">
	<li class="pagenav"><h2>Pages</h2><ul><li class="page_item page-item-2"><a href="indexba53.html?page_id=2" title="About Us">About Us</a></li>
<li class="page_item page-item-210"><a href="index6ae3.html?page_id=210" title="Templates">Templates</a></li>
</ul></li></div>

<div class="aisLeftNav">
<h2>Archives</h2>
<ul>
	<li><a href='indexb4d5.html?m=201110' title='October 2011'>October 2011</a></li>
	<li><a href='indexc61a.html?m=201106' title='June 2011'>June 2011</a></li>
	<li><a href='indexa80d.html?m=201105' title='May 2011'>May 2011</a></li>
	<li><a href='index512b.html?m=201104' title='April 2011'>April 2011</a></li>
	<li><a href='index08fb.html?m=201103' title='March 2011'>March 2011</a></li>
	<li><a href='index52f4.html?m=201102' title='February 2011'>February 2011</a></li>
	<li><a href='index74f1.html?m=201101' title='January 2011'>January 2011</a></li>
	<li><a href='index8956.html?m=201012' title='December 2010'>December 2010</a></li>
	<li><a href='indexa1aa.html?m=201011' title='November 2010'>November 2010</a></li>
	<li><a href='indexe3d5.html?m=201010' title='October 2010'>October 2010</a></li>
	<li><a href='index9ab9.html?m=201009' title='September 2010'>September 2010</a></li>
	<li><a href='index1ff0.html?m=201008' title='August 2010'>August 2010</a></li>
	<li><a href='index9f11.html?m=201007' title='July 2010'>July 2010</a></li>
	<li><a href='index31f0.html?m=201006' title='June 2010'>June 2010</a></li>
	<li><a href='indexd189.html?m=201005' title='May 2010'>May 2010</a></li>
	<li><a href='indexb5c0.html?m=201004' title='April 2010'>April 2010</a></li>
	<li><a href='indexf258.html?m=201003' title='March 2010'>March 2010</a></li>
	<li><a href='index6e30.html?m=201002' title='February 2010'>February 2010</a></li>
	<li><a href='index6b19.html?m=201001' title='January 2010'>January 2010</a></li>
	<li><a href='index5c0a.html?m=200912' title='December 2009'>December 2009</a></li>
	<li><a href='index8f62.html?m=200911' title='November 2009'>November 2009</a></li>
	<li><a href='index451d.html?m=200910' title='October 2009'>October 2009</a></li>
	<li><a href='index3e04.html?m=200909' title='September 2009'>September 2009</a></li>
	<li><a href='index425a.html?m=200908' title='August 2009'>August 2009</a></li>
	<li><a href='index9907.html?m=200907' title='July 2009'>July 2009</a></li>
	<li><a href='index3104.html?m=200906' title='June 2009'>June 2009</a></li>
	<li><a href='indexc36d.html?m=200905' title='May 2009'>May 2009</a></li>
	<li><a href='index17e8.html?m=200904' title='April 2009'>April 2009</a></li>
	<li><a href='index10a5.html?m=200903' title='March 2009'>March 2009</a></li>
	<li><a href='index8988.html?m=200902' title='February 2009'>February 2009</a></li>
	<li><a href='index1419.html?m=200901' title='January 2009'>January 2009</a></li>
	<li><a href='index7866.html?m=200812' title='December 2008'>December 2008</a></li>
	<li><a href='index55f6.html?m=200811' title='November 2008'>November 2008</a></li>
	<li><a href='indexa7bc.html?m=200810' title='October 2008'>October 2008</a></li>
	<li><a href='indexe77c.html?m=200809' title='September 2008'>September 2008</a></li>
	<li><a href='indexcffc.html?m=200808' title='August 2008'>August 2008</a></li>
	<li><a href='index0e62.html?m=200807' title='July 2008'>July 2008</a></li>
	<li><a href='indexfda7.html?m=200806' title='June 2008'>June 2008</a></li>
	<li><a href='index7d64.html?m=200805' title='May 2008'>May 2008</a></li>
	<li><a href='index94dd.html?m=200804' title='April 2008'>April 2008</a></li>
	<li><a href='index9631.html?m=200803' title='March 2008'>March 2008</a></li>
	<li><a href='indexdd52.html?m=200802' title='February 2008'>February 2008</a></li>
	<li><a href='index21ee.html?m=200801' title='January 2008'>January 2008</a></li>
	<li><a href='index363c.html?m=200712' title='December 2007'>December 2007</a></li>
	<li><a href='index7493.html?m=200711' title='November 2007'>November 2007</a></li>
	<li><a href='index93a7.html?m=200710' title='October 2007'>October 2007</a></li>
	<li><a href='index4ca8.html?m=200709' title='September 2007'>September 2007</a></li>
	<li><a href='index6124.html?m=200708' title='August 2007'>August 2007</a></li>
	<li><a href='index6013.html?m=200707' title='July 2007'>July 2007</a></li>
	<li><a href='index2ab6.html?m=200706' title='June 2007'>June 2007</a></li>
	<li><a href='index44f0.html?m=200705' title='May 2007'>May 2007</a></li>
	<li><a href='indexf0b4.html?m=200704' title='April 2007'>April 2007</a></li>
	<li><a href='index481d.html?m=200703' title='March 2007'>March 2007</a></li>
	<li><a href='indexcbea.html?m=200702' title='February 2007'>February 2007</a></li>
	<li><a href='index9cdc.html?m=200701' title='January 2007'>January 2007</a></li>
	<li><a href='index3ea4.html?m=200612' title='December 2006'>December 2006</a></li>
	<li><a href='index67ca.html?m=200611' title='November 2006'>November 2006</a></li>
	<li><a href='indexff49.html?m=200610' title='October 2006'>October 2006</a></li>
	<li><a href='index611c.html?m=200609' title='September 2006'>September 2006</a></li>
	<li><a href='index9a21.html?m=200608' title='August 2006'>August 2006</a></li>
	<li><a href='index3ee9.html?m=200607' title='July 2006'>July 2006</a></li>
	<li><a href='indexe13a.html?m=200606' title='June 2006'>June 2006</a></li>
</ul>
</div>

<div class="aisLeftNav">
	</div>

<div class="aisLeftNav">
<h2>Books</h2>
<iframe src="http://rcm.amazon.com/e/cm?t=adventures0d2-20&amp;o=1&amp;p=8&amp;l=as1&amp;asins=0764526413&amp;fc1=000000&amp;IS2=1&amp;lt1=_blank&amp;lc1=0000ff&amp;bc1=000000&amp;bg1=ffffff&amp;f=ifr" style="width:120px;height:240px;" scrolling="no" marginwidth="0" marginheight="0" frameborder="0" name="I5" id="I5"></iframe>
<br/>
<iframe src="http://rcm.amazon.com/e/cm?t=adventures0d2-20&amp;o=1&amp;p=8&amp;l=as1&amp;asins=0201633612&amp;fc1=000000&amp;IS2=1&amp;lt1=_blank&amp;lc1=0000ff&amp;bc1=000000&amp;bg1=ffffff&amp;f=ifr" style="width:120px;height:240px;" scrolling="no" marginwidth="0" marginheight="0" frameborder="0" name="I6" id="I6"></iframe>
<br/>
<iframe src="http://rcm.amazon.com/e/cm?t=adventures0d2-20&amp;o=1&amp;p=8&amp;l=as1&amp;asins=0136291554&amp;fc1=000000&amp;IS2=1&amp;lt1=_blank&amp;lc1=0000ff&amp;bc1=000000&amp;bg1=ffffff&amp;f=ifr" style="width:120px;height:240px;" scrolling="no" marginwidth="0" marginheight="0" frameborder="0" name="I7" id="I7"></iframe>
<br/>
<iframe src="http://rcm.amazon.com/e/cm?t=adventures0d2-20&amp;o=1&amp;p=8&amp;l=as1&amp;asins=1888009195&amp;fc1=000000&amp;IS2=1&amp;lt1=_blank&amp;lc1=0000ff&amp;bc1=000000&amp;bg1=ffffff&amp;f=ifr" style="width:120px;height:240px;" scrolling="no" marginwidth="0" marginheight="0" frameborder="0" name="I8" id="I8"></iframe>
</div>
<div class="aisLeftNav">
<h2>Meta</h2>
<ul>
		<li><a href="wp-login.html">Login</a></li>
	<li><a href="http://validator.w3.org/check/referer" title="This page validates as XHTML 1.0 Transitional">Valid <abbr title="eXtensible HyperText Markup Language">XHTML</abbr></a></li>
	<li><a href="http://gmpg.org/xfn/"><abbr title="XHTML Friends Network">XFN</abbr></a></li>
	<li><a href="http://wordpress.org/" title="Powered by WordPress, state-of-the-art semantic personal publishing platform.">WordPress</a></li>
	</ul>
</div>
<div class="aisLeftContent">
<h2>Community</h2>
<ul>
	<script type="text/javascript" src="../../localhost/embed/92q2bbma.js"></script>
</ul>
</div>

</div></div></div>
</div>		</td>
		<td>

	<div id="content" class="narrowcolumn">

		
		 		<h2 class="pagetitle">Archive for the &#8216;Update Controls&#8217; Category</h2>

 	  

		<div class="navigation">
			<div class="alignleft"><a href="index7a24.html?cat=36&amp;paged=2">&laquo; Previous Entries</a></div>
			<div class="alignright"></div>
		</div>

				<div class="post">
				<h3 id="post-598"><a href="index424e.html?p=598" rel="bookmark" title="Permanent Link to Databinding in Silverlight 5">Databinding in Silverlight 5</a></h3>
				<small>Thursday, December 2nd, 2010</small>

				<div class="entry">
					<p>Microsoft hosted a Silverlight Firestarter event. It was important for Microsoft to reset the Silverlight message after the Mary Jo Foley incident at PDC10. The most important piece in this strategy was Silverlight 5.</p>
<p>I was very excited today to see some of the new features coming in Silverlight 5 to support databinding. As <a href="http://weblogs.asp.net/scottgu/archive/2010/12/02/announcing-silverlight-5.aspx">Scott Guthrie says</a>, this will bring Silverlight into even better parity with WPF. There are two features that I think are most important: implicit DataTemplates and markup extensions.</p>
<h3>Implicit DataTemplates</h3>
<p>I am a big believer in creating a DataTemplate based on the type, rather than explicitly setting a DataTemplate in XAML. This supports polymorphism to the view. If you have a heterogeneous list, this technique lets you express the view of each element declaratively. If you add a new type of item to the list, you just add a new DataTemplate to your resources.</p>
<p>Most importantly, this lets the View Model be in control. I’ve often said that the view model locator pattern is backwards. When the view locates the view model, navigation goes to the view first. This leads to some awkward code. But when we navigating to a view model, all of the navigation code is naturally in the right place. We can allow the resources to determine the correct DataTemplate. This technique is covered in <a href="index6c15.html?p=503">Convention-based view model registration</a>.</p>
<h3>Markup extensions</h3>
<p>The original Update Controls XAML interface was a binding extension. That is why it took so long to port Update Controls to Silverlight. The Update markup extension provided WPF data binding without INotifyPropertyChanged. It bound directly to your view model.</p>
<p>To support Blendability, and to enable the Silverlight port, I added ForView.Wrap() to the library. This method wraps your view model so that the built-in Binding markup extension can use it. The wrapper has many disadvantages:</p>
<ul>
<li>It hides data annotations like Required and Display.</li>
<li>It adds a performance tax because it uses reflection and (in the Silverlight versions) DependencyProperties.</li>
<li>It requires you to call ForView.Unwrap() whenever accessing objects in code behind.</li>
<li>It interferes with implicit DataTemplates.</li>
</ul>
<p>The benefits of Blendability and Silverlight support outweighed these disadvantages, so it was with great sadness that I changed my recommended approach from the Update markup extension to ForView.Wrap(). Silverlight 5, however, is going to give me the choice back. If I can find a way to change how Blend does databinding, I’ll have the best of both worlds.</p>
<h3>What does this mean for Update Controls</h3>
<p>There will be a new version of Update Controls as soon as I get my hands on the Silverlight 5 bits. It will reintroduce the Update markup extension to Silverlight. I expect this version to be closer to the WPF code base, which should make code maintenance easier.</p>
<p>This also means that more Update Controls demos are coming. The joy of knowing that improvements are coming was sullied every time a demo implemented INotifyPropertyChanged. That interface is a stick in the eye every time I see it. It especially hurts when I see John Papa list INPC as one of the benefits of RIA services. I want everyone who watched the Silverlight Firestarter to be able to compare those demos with ones that don’t have the code clutter and pain of this extraneous interface. Let it be known that <a href="http://code-magazine.com/">INotifyPropertyChanged is Obsolete</a>, now more than ever.</p>
				</div>

				<p class="postmetadata">Posted in <a href="indexe5c7.html?cat=44" title="View all posts in Silverlight" rel="category">Silverlight</a>,  <a href="indexa88f.html?cat=36" title="View all posts in Update Controls" rel="category">Update Controls</a> |   <a href="index424e.html?p=598#respond" title="Comment on Databinding in Silverlight 5">No Comments &#187;</a></p>

			</div>

				<div class="post">
				<h3 id="post-571"><a href="index62bf.html?p=571" rel="bookmark" title="Permanent Link to Knockout.js: Update Controls for JavaScript">Knockout.js: Update Controls for JavaScript</a></h3>
				<small>Friday, October 22nd, 2010</small>

				<div class="entry">
					<p>Whenever I demo <a href="http://updatecontrols.codeplex.com/">Update Controls</a> for WPF, Silverlight, or Windows Forms, I usually get the question “What about the web?” My answer has always been that Update Controls doesn’t work on the web because the user interface (in the browser) is far removed from the data model (on the server). Fortunately, <a href="http://knockoutjs.com/index.html">Knockout.js</a> solves that problem.</p>
<p><a href="http://blog.stevensanderson.com/">Steven Sanderson</a> created this elegant JavaScript library that does automatic dependency tracking the same way that Update Controls does. He solves the far-removal problem by moving the data model into the browser. Write your web app using JSON services, and pull your data into the browser. Then use the Knockout templating engine to transform that data into the view. The view will be dependent upon the data, so it updates when it changes.</p>
<p>With XAML data binding, MVVM, Knockout, and Update Controls, the concept of automatic dependency tracking is starting to make its way into the mainstream. Before long, it will find its way into our programming languages.</p>
				</div>

				<p class="postmetadata">Posted in <a href="indexa88f.html?cat=36" title="View all posts in Update Controls" rel="category">Update Controls</a> |   <a href="index62bf.html?p=571#respond" title="Comment on Knockout.js: Update Controls for JavaScript">No Comments &#187;</a></p>

			</div>

				<div class="post">
				<h3 id="post-516"><a href="index3ee1.html?p=516" rel="bookmark" title="Permanent Link to Update Controls 2.1.1.0 release">Update Controls 2.1.1.0 release</a></h3>
				<small>Friday, July 16th, 2010</small>

				<div class="entry">
					<p>If you use Update Controls, please get the <a href="http://updatecontrols.net/cs/download.shtml">latest release</a>. In addition to changing from LGPL to the MIT license, this one supports Visual Studio 2010 and Silverlight 4 better. It also includes a new ViewModelBase class for better control of your view models.</p>
<p><strong>MIT License</strong>    <br />My goal is to improve software quality. That is best accomplished by giving people the patterns and tools to develop the best software they can. That is why Update Controls is open source. If you can see how it works, you don’t have to fear it. The MIT license supports wide adoption by placing no additional burden on the user of the library.</p>
<p><strong>Visual Studio 2010</strong>    <br />While I’ve ported the project to VS2010, the library can still be used in VS2008. It still targets .NET 3.5, and will continue to do so for the foreseeable future. But Visual Studio has changed the way that it populates the Add Reference dialog. This new installer works better with that mechanism.</p>
<p><strong>Silverlight 4</strong>    <br />In addition to targeting Silverlight 3, the project also targets Silverlight 4. While Silverlight 4 can load assemblies built for 3, I found that that configuration was not as stable as a targeted Silverlight 4 build. Both assemblies are installed. Visual Studio chooses the correct assembly in the Add Reference dialog based on your project type.</p>
<p><strong>ViewModelBase</strong>    <br />Sometimes the wrapper gets in the way. If you are using paged collection views, data grids, or RIA services, you want the view to see the attributes on your view model. ForView.Wrap() obscures these attributes. In those situations, you can use ViewModelBase instead. Just call Get(() =&gt; ...) or GetCollection(() =&gt; ...) inside your property getters. You can put whatever logic you need to inside the lambda expression.</p>
<p>When Update Controls was originally created, I favored composition over inheritance. Since then, the MVVM pattern has become quite popular. Many of these new frameworks have a class called ViewModelBase that implements INotifyPropertyChanged. Since the community appears to accept giving up their base class for this purpose, I decided that Update Controls should offer that as an option. But ForView.Wrap() and the Update markup extension are still fully supported. The choice is yours.</p>
				</div>

				<p class="postmetadata">Posted in <a href="indexa88f.html?cat=36" title="View all posts in Update Controls" rel="category">Update Controls</a> |   <a href="index3ee1.html?p=516#respond" title="Comment on Update Controls 2.1.1.0 release">No Comments &#187;</a></p>

			</div>

				<div class="post">
				<h3 id="post-487"><a href="indexe3b6.html?p=487" rel="bookmark" title="Permanent Link to Pass through view model">Pass through view model</a></h3>
				<small>Sunday, March 21st, 2010</small>

				<div class="entry">
					<p>I will be speaking at the <a href="http://dallasxaml.com/">Dallas XAML</a> user’s group on May 4. I’ll guide the group through the creation of a simple MVVM application to demonstrate why you want to use the pattern. This is a hands-on format, so bring your laptop. We will be using Visual Studio 2008 and WPF, so no special downloads will be required.</p>
<p>In preparing for this presentation, I’ve researched much of the MVVM advice currently available. Here are just some of the sources that I’ve found:</p>
<ul>
<li><a href="http://blog.lab49.com/archives/2650">Jason Dolinger on Model-View-ViewModel</a> </li>
<li><a href="http://live.visitmix.com/MIX10/Sessions/EX14">Laurent Bugnion Understanding the Model-View-ViewModel pattern</a> </li>
<li><a href="http://live.visitmix.com/MIX10/Sessions/EX15">Ron Eisenberg Build your own MVVM Framework</a> </li>
<li><a href="http://joshsmithonwpf.wordpress.com/advanced-mvvm/">Josh Smith Advanced MVVM</a> </li>
<li><a href="http://weblogs.asp.net/craigshoemaker/archive/2009/11/03/vm-workshop-model-view-viewmodel-mvvm-and-the-presentation-model-pattern-in-5-ui-platforms.aspx">Craig Shoemaker VM Workshop</a> </li>
<li><a href="http://www.vimeo.com/8915487">MVVM Made Easy</a> </li>
</ul>
<p>In almost every example, the presenter copies data from their Model into the View Model. Some don’t even have a Model at all! I, on the other hand, create pass-through View Models. My View Models don’t store any data. So either I’m doing it wrong, or my idea of MVVM is different from everybody else’s. Before I present the pattern to a room full of people with laptops, I’d like to know which.</p>
<p><strong>Disconnected View Model</strong>     <br />The typical example of a View Model example keeps a copy of its data. The properties work against local fields.</p>
<pre><span style="color: blue">public</span> <span style="color: blue">class</span> <span style="color: #2b91af">PersonViewModel</span> : <span style="color: #2b91af">INotifyPropertyChanged</span>
{
    <span style="color: blue">public</span> <span style="color: blue">event</span> <span style="color: #2b91af">PropertyChangedEventHandler</span> PropertyChanged;

    <span style="color: blue">private</span> <span style="color: blue">string</span> _firstName;
    <span style="color: blue">private</span> <span style="color: blue">string</span> _lastName;

    <span style="color: blue">public</span> <span style="color: blue">string</span> FirstName
    {
        <span style="color: blue">get</span>
        {
            <span style="color: blue">return</span> _firstName;
        }
        <span style="color: blue">set</span>
        {
            _firstName = value;
            FirePropetyChanged(<span style="color: maroon">&quot;FirstName&quot;</span>);
            FirePropetyChanged(<span style="color: maroon">&quot;FullName&quot;</span>);
        }
    }

    <span style="color: blue">public</span> <span style="color: blue">string</span> LastName
    {
        <span style="color: blue">get</span>
        {
            <span style="color: blue">return</span> _lastName;
        }
        <span style="color: blue">set</span>
        {
            _lastName = value;
            FirePropetyChanged(<span style="color: maroon">&quot;LastName&quot;</span>);
            FirePropetyChanged(<span style="color: maroon">&quot;FullName&quot;</span>);
        }
    }

    <span style="color: blue">public</span> <span style="color: blue">string</span> FullName
    {
        <span style="color: blue">get</span>
        {
            <span style="color: blue">return</span> <span style="color: blue">string</span>.Format(<span style="color: maroon">&quot;{1}, {0}&quot;</span>, _firstName, _lastName);
        }
    }

    <span style="color: blue">private</span> <span style="color: blue">void</span> FirePropetyChanged(<span style="color: blue">string</span> propertyName)
    {
        <span style="color: blue">if</span> (PropertyChanged != <span style="color: blue">null</span>)
            PropertyChanged(<span style="color: blue">this</span>, <span style="color: blue">new</span> <span style="color: #2b91af">PropertyChangedEventArgs</span>(propertyName));
    }
}</pre>
<p>Before you display the view, you have to copy the data into the view model. At some point later, you copy the data back out of the view model.</p>
<pre><span style="color: blue">public</span> <span style="color: blue">class</span> <span style="color: #2b91af">PersonViewModel</span>

    <span style="color: green">//...</span>

    <span style="color: blue">public</span> <span style="color: blue">static</span> <span style="color: #2b91af">PersonViewModel</span> FromPerson(<span style="color: #2b91af">Person</span> person)
    {
        <span style="color: blue">return</span> <span style="color: blue">new</span> <span style="color: #2b91af">PersonViewModel</span>()
        {
            FirstName = person.FirstName,
            LastName = person.LastName
        };
    }

    <span style="color: blue">public</span> <span style="color: blue">void</span> ToPerson(<span style="color: #2b91af">Person</span> person)
    {
        person.FirstName = _firstName;
        person.LastName = _lastName;
    }
}</pre>
<p>Some of the experts just skip the model class altogether and go straight from their view model to the database or service.</p>
<p><strong>Pass Through View Model</strong> </p>
<p>I prefer the pass through style. The view model stores no data.</p>
<pre><span style="color: blue">public</span> <span style="color: blue">class</span> <span style="color: #2b91af">PersonViewModel</span> : <span style="color: #2b91af">INotifyPropertyChanged</span>
{
    <span style="color: blue">public</span> <span style="color: blue">event</span> <span style="color: #2b91af">PropertyChangedEventHandler</span> PropertyChanged;

    <strong><span style="color: blue">private</span> <span style="color: #2b91af">Person</span> _person;</strong>

<strong>    <span style="color: blue">public</span> PersonViewModel(<span style="color: #2b91af">Person</span> person)
    {
        _person = person;
    }
</strong>
    <span style="color: blue">public</span> <span style="color: blue">string</span> FirstName
    {
        <span style="color: blue">get</span>
        {
            <span style="color: blue">return</span> _<strong>person.FirstName</strong>;
        }
        <span style="color: blue">set</span>
        {
            <strong>_person.FirstName</strong> = value;
            FirePropetyChanged(<span style="color: maroon">&quot;FirstName&quot;</span>);
            FirePropetyChanged(<span style="color: maroon">&quot;FullName&quot;</span>);
        }
    }

    <span style="color: blue">public</span> <span style="color: blue">string</span> LastName
    {
        <span style="color: blue">get</span>
        {
            <span style="color: blue">return</span> <strong>_person.LastName;</strong>
        }
        <span style="color: blue">set</span>
        {
            <strong>_person.LastName</strong> = value;
            FirePropetyChanged(<span style="color: maroon">&quot;LastName&quot;</span>);
            FirePropetyChanged(<span style="color: maroon">&quot;FullName&quot;</span>);
        }
    }

    <span style="color: blue">public</span> <span style="color: blue">string</span> FullName
    {
        <span style="color: blue">get</span>
        {
            <span style="color: blue">return</span> <span style="color: blue">string</span>.Format(<span style="color: maroon">&quot;{1}, {0}&quot;</span>, <strong>_person.FirstName</strong>, <strong>_person.LastName</strong>);
        }
    }

    <span style="color: blue">private</span> <span style="color: blue">void</span> FirePropetyChanged(<span style="color: blue">string</span> propertyName)
    {
        <span style="color: blue">if</span> (PropertyChanged!= <span style="color: blue">null</span>)
            PropertyChanged(<span style="color: blue">this</span>, <span style="color: blue">new</span> <span style="color: #2b91af">PropertyChangedEventArgs</span>(propertyName));
    }
}</pre>
<p>Instead of storing a copy of the Person data, this view model uses the storage that is in the actual Person model. There is no back-and-forth copying of data.</p>
<p><strong>The advantages of pass through</strong> </p>
<p>I prefer the pass through style because it limits the number of moving parts in the application; in other words, it minimizes the “degrees of freedom”. Fewer moving parts means:</p>
<ol>
<li>Less code </li>
<li>Fewer tests </li>
<li>Fewer things that could break </li>
<li>Simpler communication </li>
</ol>
<p>If data exists in two places, then it will diverge. Data in one place will be more up-to-date than data in the other place. You have to write code to manage the divergence. That code needs to be tested. That code could break.</p>
<p>Many of the MVVM frameworks that the experts use have a mechanism for sending messages from one view model to another. This is necessary because each view model has its own copy of the data. But if each view model passes through to the same model object, then message passing is no longer necessary. The data model itself becomes the means of communication between view models.</p>
<p><strong>The disadvantages of pass through</strong> </p>
<p>There is a trade-off between the disconnected and pass through styles. The pass through style does have some disadvantages:</p>
<ol>
<li>Harder to support Cancel </li>
<li>Requires change notification from model </li>
<li>Difficult to represent complex transformations </li>
</ol>
<p>Some applications call for the modal dialog OK/Cancel metaphor. It is easier to implement this metaphor if you copy the data into a disconnected view model. If the user presses cancel, you just don’t copy the data back to the model.</p>
<p>While view models can use the data model to share data, they need to be notified of changes that other view models are making. That means that your view models not only implement INotifyPropertyChanged, they also subscribe to it. This can lead to a lot of bookkeeping code. Fortunately, there is a <a href="http://www.code-magazine.com/Article.aspx?quickid=0907101">solution to this</a>, but you have to use a third-party library.</p>
<p>Some transformations cannot be easily represented as a pass through. Maybe the objects in the data model need to be combined or regrouped in different ways. This regrouping cannot be easily done with pass through properties. A disconnected view model can make large scale transformations during the copying process.</p>
<p>None of the experts that I’ve studied make a distinction between disconnected view models and pass through view models. This is unfortunate, because the differences are significant. Where the advantages of a pass through view model outweigh the disadvantages, I find it to be an excellent choice. But before you can make that choice, you have to know that there is a choice to be made.</p>
				</div>

				<p class="postmetadata">Posted in <a href="indexa88f.html?cat=36" title="View all posts in Update Controls" rel="category">Update Controls</a>,  <a href="index2d79.html?cat=26" title="View all posts in dof" rel="category">dof</a> |   <a href="indexe3b6.html?p=487#comments" title="Comment on Pass through view model">2 Comments &#187;</a></p>

			</div>

				<div class="post">
				<h3 id="post-479"><a href="index5657.html?p=479" rel="bookmark" title="Permanent Link to Correspondence Reversi">Correspondence Reversi</a></h3>
				<small>Wednesday, January 27th, 2010</small>

				<div class="entry">
					<p>Correspondence is a library for creating collaborative smart client applications in .NET. When you express a model in Correspondence, it provides three things:</p>
<ul>
<li>Storage</li>
<li>UI updates</li>
<li>Synchronization</li>
</ul>
<p>This open source library includes a demo application to illustrate its collaborative capabilities. Correspondence Reversi is a WPF rendition of a popular two player game. Download the <a href="http://correspondence.codeplex.com/Release/ProjectReleases.aspx?ReleaseId=39602#DownloadId=103570">client</a> to play against a friend, or to randomly join in a game with a stranger. Download the <a href="http://correspondence.codeplex.com/">source code</a> to learn how Correspondence makes collaboration easy.</p>
<p><strong>Storage</strong><br />
Applications typically store their data in a relational database. But they act upon that data by loading objects into memory. To bride the gap, application designers can choose from several object-relational mappers (ORMs).</p>
<p>The problem with the ORM approach is that it requires the application designer to express their model three times:</p>
<ul>
<li>Database schema</li>
<li>Objects</li>
<li>Mapping configuration</li>
</ul>
<p>Keeping these three in synch becomes a maintenance task each time the model changes. And deploying a new version requires that the data be migrated to the new schema.</p>
<p>Correspondence is not an ORM. The application model is not reflected in a relational database schema. When the model changes, only the objects are changed. The schema remains consistent. This allows for new versions to be deployed without changing the database or migrating data. And it eliminates the need for mapping configuration, as the library stores all models the same way.</p>
<p><strong>UI updates</strong><br />
Correspondence is built on top of <a href="http://updatecontrols.codeplex.com/">Update Controls</a>, a library for keeping UI controls up-to-date. While most UI update libraries require you to manage your own dependencies, Update Controls discovers them for you and manages them on your behalf. The only thing that Update Controls requires is that your model alert it when a property is accessed or modified.</p>
<p>Correspondence takes on the responsibility of notifying Update Controls. A Correspondence model can be bound to a Winforms or WPF user interface – even through an intermediate View Model – to provide automatic dependency discovery and change notification. A Correspondence application developer will never see INotifyPropertyChanged or ObservableCollection.</p>
<p><strong>Synchronization</strong><br />
By far the most compelling feature of Correspondence is that it automatically synchronizes a data model among clients. Two or more people collaborating on the same data on different machines will automatically see each other’s changes. The automatic UI updates provided by Update Controls ensure that changes made on one machine automatically appear on the screen of another.</p>
<p>Most smart client applications switch from off-line mode to on-line mode based on the availability of the network. While on-line, smart clients communicate changes that the user makes with a server. It runs queries on the server to bring back information that the user wants to see. While off-line, they switch into a mode where data storage and queries are performed locally. Typically, smart client synchronization occurs during the switch between modes.</p>
<p>Correspondence works differently. It offers a consistent programming model whether the network is available or not. Objects created in Correspondence are stored locally, regardless of network availability. A background thread constantly synchronizes the local storage with a server when available, and silently waits when it is not. By eliminating the switch between modes, Correspondence simplifies the task of smart-client development, and improves the end-user experience.</p>
<p>Correspondence Reversi synchronizes with a cloud service running in Windows Azure. This service collects data from each client, and redistributes that data to other clients who need it. Two people playing a game together will see each other’s moves. But they will not see any of the traffic from other games. <strong>This is not a special feature of the Reversi game model. This is a feature of Correspondence.</strong> A different model will be synchronized just as intelligently, and will work with <strong>the same synchronization service</strong>. There is nothing application-specific about the cloud service.</p>
<p>Please download the <a href="http://correspondence.codeplex.com/Release/ProjectReleases.aspx?ReleaseId=39602#DownloadId=103570">client </a>and play against your friends. Then explore the <a href="http://correspondence.codeplex.com/">source code</a> and see what you can do with Correspondence.</p>
				</div>

				<p class="postmetadata">Posted in <a href="index489b.html?cat=34" title="View all posts in Synchronization" rel="category">Synchronization</a>,  <a href="indexa88f.html?cat=36" title="View all posts in Update Controls" rel="category">Update Controls</a> |   <a href="index5657.html?p=479#respond" title="Comment on Correspondence Reversi">No Comments &#187;</a></p>

			</div>

				<div class="post">
				<h3 id="post-462"><a href="indexd526.html?p=462" rel="bookmark" title="Permanent Link to Not At PDC">Not At PDC</a></h3>
				<small>Monday, November 23rd, 2009</small>

				<div class="entry">
					<p>I was saddened when I was unable to attend PDC this year. One project is winding down, we're staffing up for the next, and I cannot be spared at this particular time. I was not present when Scott Hanselman dragged and dropped his way through a data binding demo. Nevertheless, I was groaning from afar.</p>
<p>I did, however, have the chance to participate in the <a href="http://notatpdc.com/">Not@PDC</a> conference. It was quickly organized via Twitter and blogs to be an online get together for folks who were not lucky enough to be in LA. (Lucky to be in LA? Did I really say that?) It turned out to be a wonderful substitute. OK, not really a substitute; more like consolation.</p>
<p>I presented <a href="http://updatecontrols.net/doc/examples/awesome">Data Binding Without INotifyPropertyChanged</a>, a 70-minute demo of Update Controls in WPF, Winforms, and Silverlight. In the video, I show you the most awesome application ever: Microsoft Excel. Excel is awesome because you can use the MVVM pattern. It's true.</p>
<p>As you watch, please forgive the poor video quality and even poorer jokes. I'll be polishing the demo and taking it on the road. My first stop will hopefully be the North Dallas .NET Users' Group. I'll keep you posted.</p>
				</div>

				<p class="postmetadata">Posted in <a href="indexa88f.html?cat=36" title="View all posts in Update Controls" rel="category">Update Controls</a> |   <a href="indexd526.html?p=462#respond" title="Comment on Not At PDC">No Comments &#187;</a></p>

			</div>

				<div class="post">
				<h3 id="post-452"><a href="index20a4.html?p=452" rel="bookmark" title="Permanent Link to Topic specific sites">Topic specific sites</a></h3>
				<small>Saturday, October 10th, 2009</small>

				<div class="entry">
					<p>I now have three sites for topic-specific content.</p>
<ul>
<li><a href="http://historicmodeling.com/">Historic Modeling</a>
<li><a href="http://updatecontrols.net/doc">Update Controls</a>
<li><a href="http://qedcode.com/">Q.E.D. Code</a></li>
</ul>
<p>I have seeded these sites with articles from Adventures in Software. But from now on, articles specific to those topics will go on those sites. Please subscribe to those RSS feeds as well as this one.</p>
				</div>

				<p class="postmetadata">Posted in <a href="indexb60a.html?cat=27" title="View all posts in Historic Modeling" rel="category">Historic Modeling</a>,  <a href="indexa88f.html?cat=36" title="View all posts in Update Controls" rel="category">Update Controls</a>,  <a href="index51fa.html?cat=40" title="View all posts in qed" rel="category">qed</a> |   <a href="index20a4.html?p=452#respond" title="Comment on Topic specific sites">No Comments &#187;</a></p>

			</div>

				<div class="post">
				<h3 id="post-448"><a href="indexc79d.html?p=448" rel="bookmark" title="Permanent Link to Non-recursive WPF TreeView controls">Non-recursive WPF TreeView controls</a></h3>
				<small>Friday, October 2nd, 2009</small>

				<div class="entry">
					<p>A WPF TreeView control can display data in any tree structure. There are essentially two kinds of tree structures: recursive and non-recursive. Non-recursive trees are simpler.</p>
<p><a href="wp-content/uploads/2009/10/surveydatamodel.jpg"><img src="wp-content/uploads/2009/10/surveydatamodel-thumb.jpg" style="border-width: 0px" alt="SurveyDataModel" align="right" border="0" height="172" width="451" /></a>Items in a recursive tree can have children of the same type. Items in a non-recursive tree cannot. A non-recursive tree has a fixed depth, and every item on the same depth is the same type as its siblings. This makes it particularly easy to model in WPF.</p>
<p>Pictured here is a non-recursive tree structure for a survey game. A Game has Surveys, which in turn have Answers. It's a very simple tree structure with no recursion. The depth of this tree from the Game to the Answers will always be 3.</p>
<p><strong>Binding the TreeView</strong><br />
Let's start with a TreeView control that displays the surveys. We'll bind the collection to the ItemsSource of the TreeView.</p>
<pre><span style="color: blue">&lt;</span><span style="color: maroon">TreeView</span> <span style="color: red">ItemsSource</span>="<span style="color: blue">{Binding Surveys}</span>"<span style="color: blue">&gt;</span>
<span style="color: blue">&lt;</span>/<span style="color: maroon">TreeView</span><span style="color: blue">&gt;</span></pre>
<p>The TreeView control creates a TreeViewItem for each element in the collection. We need to tell the container how to populate those TreeViewItems. We do this with a DataTemplate.</p>
<p>A DataTemplate defines the contents of an item in a container control. DataTemplates are used for things like list boxes, menus, and tree controls. A DataTemplate does not define the item itself -- the container determines that. ListBox controls have ListBoxItems. TreeView controls have TreeViewItems. The DataTemplate just defines what goes <em>into</em> that item.</p>
<p>We want each TreeViewItem to contain a TextBlock bound to the survey question. So we set the ItemTemplate property to an instance of the DataTemplate class. This DataTemplate contains a TextBox with the right binding.</p>
<pre><span style="color: blue">&lt;</span><span style="color: maroon">TreeView</span> <span style="color: red">ItemsSource</span>="<span style="color: blue">{Binding Surveys}</span>"<span style="color: blue">&gt;</span>
    <span style="color: blue">&lt;</span><span style="color: maroon">TreeView.ItemTemplate</span><span style="color: blue">&gt;</span>
        <span style="color: blue">&lt;</span><strong><span style="color: maroon">DataTemplate</span></strong><span style="color: blue">&gt;</span>
            <span style="color: blue">&lt;</span><span style="color: maroon">TextBlock</span> <span style="color: red">Text</span>="<span style="color: blue">{Binding Question}</span>"/<span style="color: blue">&gt;</span>
        <span style="color: blue">&lt;</span>/<strong><span style="color: maroon">DataTemplate</span></strong><span style="color: blue">&gt;</span>
    <span style="color: blue">&lt;</span>/<span style="color: maroon">TreeView.ItemTemplate</span><span style="color: blue">&gt;</span>
<span style="color: blue">&lt;</span>/<span style="color: maroon">TreeView</span><span style="color: blue">&gt;</span></pre>
<p>We want each TreeViewItem to have child items. The child items are not <em>contained</em> within the parent item. They are just a <em>property</em> of the parent item. We can't use a DataTemplate to set properties. So we switch to a special DataTemplate: HierarchicalDataTemplate.</p>
<p><strong>HierarchicalDataTemplate</strong><br />
A HierarchicalDataTemplate is a DataTemplate with an additional property: ItemsSource. This property is bound to a child collection. The template sets this property on the TreeViewItem itself.</p>
<pre><span style="color: blue">&lt;</span><span style="color: maroon">TreeView</span> <span style="color: red">ItemsSource</span>="<span style="color: blue">{Binding Surveys}</span>"<span style="color: blue">&gt;</span>
    <span style="color: blue">&lt;</span><span style="color: maroon">TreeView.ItemTemplate</span><span style="color: blue">&gt;</span>
        <span style="color: blue">&lt;</span><strong><span style="color: maroon">HierarchicalDataTemplate</span> </strong><span style="color: red">ItemsSource</span>="<span style="color: blue">{Binding Answers}</span>"<span style="color: blue">&gt;</span>
            <span style="color: blue">&lt;</span><span style="color: maroon">TextBlock</span> <span style="color: red">Text</span>="<span style="color: blue">{Binding Question}</span>"/<span style="color: blue">&gt;</span>
        <span style="color: blue">&lt;</span>/<strong><span style="color: maroon">HierarchicalDataTemplate</span></strong><span style="color: blue">&gt;</span>
    <span style="color: blue">&lt;</span>/<span style="color: maroon">TreeView.ItemTemplate</span><span style="color: blue">&gt;</span>
<span style="color: blue">&lt;</span>/<span style="color: maroon">TreeView</span><span style="color: blue">&gt;</span></pre>
<p>This template will set the ItemsSource of each Survey TreeViewItem to the bound collection of Answers. But, as before, we need to tell the control what to put into those TreeViewItems. We do this by setting the ItemTemplate property of the HierarchicalDataTemplate.</p>
<pre><span style="color: blue">&lt;</span><span style="color: maroon">TreeView</span> <span style="color: red">ItemsSource</span>="<span style="color: blue">{Binding Surveys}</span>"<span style="color: blue">&gt;</span>
    <span style="color: blue">&lt;</span><span style="color: maroon">TreeView.ItemTemplate</span><span style="color: blue">&gt;</span>
        <span style="color: blue">&lt;</span><span style="color: maroon">HierarchicalDataTemplate</span> <span style="color: red">ItemsSource</span>="<span style="color: blue">{Binding Answers}</span>"<span style="color: blue">&gt;</span>
            <span style="color: blue">&lt;</span><span style="color: maroon">TextBlock</span> <span style="color: red">Text</span>="<span style="color: blue">{Binding Question}</span>"/<span style="color: blue">&gt;</span>
            <span style="color: blue">&lt;</span><span style="color: maroon">HierarchicalDataTemplate.ItemTemplate</span><span style="color: blue">&gt;</span>
                <span style="color: blue">&lt;</span><strong><span style="color: maroon">DataTemplate</span></strong><span style="color: blue">&gt;</span>
                    <span style="color: blue">&lt;</span><span style="color: maroon">TextBlock</span> <span style="color: red">Text</span>="<span style="color: blue">{Binding Response}</span>"/<span style="color: blue">&gt;</span>
                <span style="color: blue">&lt;</span>/<strong><span style="color: maroon">DataTemplate</span></strong><span style="color: blue">&gt;</span>
            <span style="color: blue">&lt;</span>/<span style="color: maroon">HierarchicalDataTemplate.ItemTemplate</span><span style="color: blue">&gt;</span>
        <span style="color: blue">&lt;</span>/<span style="color: maroon">HierarchicalDataTemplate</span><span style="color: blue">&gt;</span>
    <span style="color: blue">&lt;</span>/<span style="color: maroon">TreeView.ItemTemplate</span><span style="color: blue">&gt;</span>
<span style="color: blue">&lt;</span>/<span style="color: maroon">TreeView</span><span style="color: blue">&gt;</span></pre>
<p>Because the Answer TreeViewItem does not need to have children, there is no need to use a HierarchicalDataTemplate at this level.</p>
<p>A non-recursive tree structure is easy to model. Since an item does not have children of its own type, there are no self-referential templates. When the tree structure can be recursive, however, things are a bit tricker. That's coming up.</p>
				</div>

				<p class="postmetadata">Posted in <a href="indexa88f.html?cat=36" title="View all posts in Update Controls" rel="category">Update Controls</a> |   <a href="indexc79d.html?p=448#respond" title="Comment on Non-recursive WPF TreeView controls">No Comments &#187;</a></p>

			</div>

				<div class="post">
				<h3 id="post-438"><a href="index9ed5.html?p=438" rel="bookmark" title="Permanent Link to Continuous testing does not require static analysis">Continuous testing does not require static analysis</a></h3>
				<small>Thursday, September 17th, 2009</small>

				<div class="entry">
					<p>Ben Rady is the author of Infinitest, a continuous testing tool. This is an Eclipse or IntelliJ plug-in for Java that runs unit tests as you edit code. The key differentiator of <a href="http://www.benrady.com/2009/04/comparing-infinitest-and-junitmax.html">Infinitest over other continuous testing plug-ins</a> is that it runs only the unit tests that need to be run.</p>
<p>Ben describes how he accomplishes this feat. He uses static analysis of both the test and the code under test to determine whether tests need to run. Unfortunately, he's doing more work than he needs to. Continuous testing does not require static analysis.</p>
<p><strong>Update Controls</strong><br />I moderate an open source project called Update Controls for .NET. This project does data binding for WPF, Winforms, and Silverlight. It has absolutely nothing to do with a continuous testing plug-in for Java.</p>
<p>Or does it?</p>
<p>Update Controls automatically discovers the data that your properties depend upon. When that data changes, those properties are updated. You might think that it's doing some sort of static analysis to discover dependencies, but it's much simpler than that.</p>
<p>Say you have a dependent property "A". As the property getter for "A" is executing, Update Controls is watching. When another property called "B" is referenced, Update Controls says "Aha! A depends upon B." It's that simple.</p>
<p><strong>Why does this work?</strong><br />Most code is deterministic. If you call it providing the same inputs, it will produce the same outputs. Furthermore, it will do so in exactly the same way. So execute some code and it see what set of properties it reads. Execute it again, and it will still read the same set of properties.</p>
<p>Now, change a property <em>not</em> in the set that was read. Does the behavior of the code change?</p>
<p>No! The code only observed one set of properties. It doesn't care what happens to any other properties. It will still read that same set, and it will still produce the same results.</p>
<p>OK, this time change a property that <em>is</em> in the set. Does the behavior of the code change?</p>
<p>You bet it does. In fact, it may change drastically. It may even read an entirely different set of properties next time. So all bets are off. Once you change a property upon which it depends, you have to dump the entire set and run the code again. Then you can gather up a brand new set.</p>
<p><strong>Back to Infinitest</strong><br />So, Ben, my advice to you. Drop the static analysis. Instead pick up a code coverage tool. Look at all of the lines of code covered by each test. If any of those lines changes, you have to rerun the test. If not, you don't. Simple as that.</p>
				</div>

				<p class="postmetadata">Posted in <a href="indexa88f.html?cat=36" title="View all posts in Update Controls" rel="category">Update Controls</a> |   <a href="index9ed5.html?p=438#comments" title="Comment on Continuous testing does not require static analysis">1 Comment &#187;</a></p>

			</div>

				<div class="post">
				<h3 id="post-413"><a href="index672e.html?p=413" rel="bookmark" title="Permanent Link to MVVM and Linq to SQL the easy way">MVVM and Linq to SQL the easy way</a></h3>
				<small>Sunday, August 9th, 2009</small>

				<div class="entry">
					<p>Download the <a href="wp-content/uploads/2009/08/noteworthy.zip">source code</a> and follow along.</p>
<p>The biggest challenge implementing the MVVM pattern is the View Model responding to changes in the Data Model. Usually, the View Model needs to subscribe to the PropertyChanged events fired by the Data Model, update its internal state, and then fire its own PropertyChanged events for the View. That's the hard way.</p>
<p>The easy way is to use <a href="http://updatecontrols.net/">Update Controls</a>. With Update Controls, you just decorate the Data Model and wrap the View Model. The library takes care of everything in between.</p>
<p><strong>Decorate a Linq to SQL data model</strong><br />
You decorate the data model by adding <a href="http://updatecontrols.net/documentation/classDocumentation/vb/UpdateControls.Independent.do">Independent</a> sentries to every property. Whenever the property is accessed, call OnGet(). Whenever it is modified, call OnSet(). To decorate a Linq to SQL data model, we just need to inject these calls into the generated code. Unfortunately, the Linq to SQL code generator does not give you a way to easily tweak its output.</p>
<p>Damien Guard has solved that problem. His open source project <a href="http://l2st4.codeplex.com/">LINQ to SQL templates for T4</a> is incredibly easy to set up and start using. It drops straight into Visual Studio and replaces the build-in code generator with one that you control. With just a few edits to his provided T4 template, I replaced INotifyPropertyChanged with Independent sentries.</p>
<p>I added a sentry for each single-valued property, and called OnGet() inside of the getter and OnSet() in the setter. I also added a sentry for each collection. They require OnGet() in the getter, and OnSet() when something is added or removed. Finally, I added a sentry per table, to take care of the top-level queries. For these, I call OnSet() on any insert, update, and delete. The final T4 template is in the example source code.</p>
<p><strong>Wrap the view model for WPF</strong><br />
Wrapping the view model for the view is a one-liner.</p>
<pre><span style="color: blue">public</span> Window1()
{
    InitializeComponent();

    <span style="color: green">// Create a data model and a navigation model.</span>
    _blog = <span style="color: blue">new</span> Blog();
    BlogNavigationModel navigationModel = <span style="color: blue">new</span> BlogNavigationModel();

    <span style="color: green">// Put them both in a view model, then wrap it for the view.</span>
    <span style="color: blue">this</span>.DataContext = <strong>ForView.Wrap</strong>(<span style="color: blue">new</span> BlogViewModel(_blog, navigationModel));
}</pre>
<p>We create a view model based on the decorated data model and a similarly decorated navigation model (more on that later). Then we let Update Controls wrap it up before we give it to the view.</p>
<p><strong>View model per scope</strong><br />
<a href="wp-content/uploads/2009/08/noteworthy.png"><img src="wp-content/uploads/2009/08/noteworthy-thumb.png" style="border: 0px none " alt="Noteworthy" width="209" align="right" border="0" height="244" /></a>The example application -- Noteworthy -- is a blog editor. Different parts of the view focus on different granularities of data. The main view (shown in red) focuses on the blog as a whole. The article list items and detail pane (shown in blue) focus on a single article. And the tag list items (shown in green) focus on a single tag.</p>
<p>We define one view model class for each of these three scopes. Each one takes constructor parameters to put itself in context. So the BlogViewModel takes a Blog, the ArticleViewModel takes a Blog and an Article, and the TagViewModel takes a Blog and a Tag.</p>
<p>The DataContext property of a WPF control determines where it begins for data binding. If you don't set it, the control inherits it from its parent. If the control is an item in a list, then it is automatically set to an element of the ItemsSource. Finally, you can data bind to a property of its parent scope. Noteworthy uses all three techniques.</p>
<p><strong>Property per control attribute</strong><br />
WPF data binding connects control attributes to object properties. So within each view model, we define a property for each attribute of a control. The view model exists to serve of the view, so this one-to-one mapping is to be expected. The view model is an isolation layer designed to keep these view-specific concerns out of your data model.</p>
<p><strong>Navigation model per user context</strong><br />
The user of your application has a conceptual model of how controls should work together. Noteworthy is a single window program, so they expect all of the controls on that window to interact appropriately. If it had multiple child windows all within a parent, they would expect each window to be its own context, but participate within the context of the main window. And if it were a composite application, they would expect all of the components to work together.</p>
<p>Where the user draws their conceptual boundary, we create a navigation model. A navigation model records the user's point-of-view as they navigate through the application. It keeps track of their selection and temporary input.</p>
<p>All of the state in the navigation model is transient. Nothing is written to the database. Persistent state belongs in the data model. This keeps the view model completely stateless. The view model has only behavior, which depends upon the data model and the navigation model.</p>
<p>Because the navigation model is transient, we just write fields, select them, and hit Ctrl+D, G to generate the properties. For example, here's the property that records the selected article. The part that I wrote by hand is highlighted:</p>
<pre><span style="color: blue">public</span> <span style="color: blue">class</span> BlogNavigationModel
{
<strong>    <span style="color: blue">private</span> Article _selectedArticle;
</strong>
    <span style="color: blue">#region</span> Independent properties
    <span style="color: green">// Generated by Update Controls --------------------------------</span>
    <span style="color: blue">private</span> Independent _indSelectedArticle = <span style="color: blue">new</span> Independent();

    <span style="color: gray">/// &lt;summary&gt;</span>
    <span style="color: gray">/// The article for which to display details.</span>
    <span style="color: gray">/// &lt;/summary&gt;</span>
    <span style="color: blue">public</span> Article SelectedArticle
    {
        <span style="color: blue">get</span> { _indSelectedArticle.OnGet(); <span style="color: blue">return</span> _selectedArticle; }
        <span style="color: blue">set</span> { _indSelectedArticle.OnSet(); _selectedArticle = value; }
    }
    <span style="color: green">// End generated code --------------------------------</span>
    <span style="color: blue">#endregion</span>
}</pre>
<p>The properties of the navigation model are always data model types, never view model types. The view model depends upon the navigation model, not vice-versa.</p>
<p><strong>Explore on your own</strong><br />
That's just enough to get you started. There are many interesting patterns that came together in the making of Noteworthy. Here are some that you might want to examine on your own:</p>
<ul>
<li>The BlogViewModel.Articles property is filtered by the selected tag.</li>
<li>The article detail pane is a Grid within a Grid. The outer grid binds IsEnabled, while the inner grid binds DataContext.</li>
<li>The TagListBoxStyle resource binds the ListBoxItem.IsSelected attribute to the TagViewModel.TagIsSelected property to support multiple selection.</li>
<li>The Blog data model class uses a Dependent sentry to cache Tags.</li>
<li>Every view model setter and command that affects the data model calls SubmitChanges.</li>
<li>The ArticleViewModel.AvailableTags property uses .Except() to get all tags not assigned to the article.</li>
<li>The BlogViewModel.SelectedArticle property wraps the data object from the navigation model in a view model, and then unwraps it on the way back.</li>
<li>The first tag in BlogViewModel.Filters is actually not a tag at all. It is a null to represent the lack of a filter.</li>
</ul>
<p>Expect future posts to return to this example and explore these points in more detail.</p>
				</div>

				<p class="postmetadata">Posted in <a href="indexb0b7.html?cat=6" title="View all posts in Patterns" rel="category">Patterns</a>,  <a href="indexa88f.html?cat=36" title="View all posts in Update Controls" rel="category">Update Controls</a> |   <a href="index672e.html?p=413#comments" title="Comment on MVVM and Linq to SQL the easy way">1 Comment &#187;</a></p>

			</div>

		
		<div class="navigation">
			<div class="alignleft"><a href="index7a24.html?cat=36&amp;paged=2">&laquo; Previous Entries</a></div>
			<div class="alignright"></div>
		</div>

	
	</div>
		</td>
	</tr>
</table>

<hr />
<div id="footer">
<!-- If you'd like to support WordPress, having the "powered by" link someone on your blog is the best way, it's our only promotion or advertising. -->
	<p>
		Adventures in Software is proudly powered by 
		<a href="http://wordpress.org/">WordPress</a>
		<br /><a href="indexd784.html?feed=rss2">Entries (RSS)</a>
		and <a href="indexa6da.html?feed=comments-rss2">Comments (RSS)</a>.
		<!-- 17 queries. 0.408 seconds. -->
	</p>
</div>
<script type="text/javascript">
var gaJsHost = (("https:" == document.location.protocol) ? "https://ssl." : "http://www.");
document.write(unescape("%3Cscript src='" + gaJsHost + "google-analytics.com/ga.js' type='text/javascript'%3E%3C/script%3E"));
</script>
<script type="text/javascript">
try {
var pageTracker = _gat._getTracker("UA-389401-3");
pageTracker._trackPageview();
} catch(err) {}</script></div>

<!-- Gorgeous design by Michael Heilemann - http://binarybonsai.com/kubrick/ -->

		<div id="sk2-footer" style="color:#FFF; background-color:#444; padding: 3px 2px 3px 2px; border-top: #888 solid 1px;">This blog is protected by <a href="http://unknowngenius.com/blog/" title="Dave">dr Dave</a>'s <strong><a href="http://unknowngenius.com/blog/wordpress/spam-karma/" title="SK2">Spam Karma 2</a></strong>: <strong>274531</strong>  Spams eaten and counting...</div><script type="text/javascript" src="replies.js"></script>
<script type="text/javascript" src="blogger.js"></script>
<script type="text/javascript" src="http://twitter.com/statuses/user_timeline/michaellperry.json?callback=twitterCallback2&amp;count=5"></script>
<script type="text/javascript" src="http://search.twitter.com/search.json?q=@michaellperry&amp;callback=twitterCallbackReplies&amp;rpp=5"></script>
</body>

<!-- Mirrored from adventuresinsoftware.com/blog/?cat=36 by HTTrack Website Copier/3.x [XR&CO'2014], Fri, 13 Jan 2017 12:54:57 GMT -->
</html>
