<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" dir="ltr">


<!-- Mirrored from adventuresinsoftware.com/blog/?p=542 by HTTrack Website Copier/3.x [XR&CO'2014], Fri, 13 Jan 2017 12:55:33 GMT -->
<!-- Added by HTTrack --><meta http-equiv="content-type" content="text/html;charset=UTF-8" /><!-- /Added by HTTrack -->
<head profile="http://gmpg.org/xfn/11">
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8" />

<title>Adventures in Software  &raquo; Blog Archive   &raquo; Navigate SSRS reports from a web application</title>

<meta name="generator" content="WordPress 2.3.3" /> <!-- leave this for stats -->

<link rel="stylesheet" href="wp-content/themes/ais2/style.css" type="text/css" media="screen" />
<link rel="alternate" type="application/rss+xml" title="Adventures in Software RSS Feed" href="indexd784.html?feed=rss2" />
<link rel="pingback" href="xmlrpc.html" />
    <script type="text/javascript">
        function onSilverlightError(sender, args) {
            var appSource = "";
            if (sender != null && sender != 0) {
              appSource = sender.getHost().Source;
            }
            
            var errorType = args.ErrorType;
            var iErrorCode = args.ErrorCode;

            if (errorType == "ImageError" || errorType == "MediaError") {
              return;
            }

            var errMsg = "Unhandled Error in Silverlight Application " +  appSource + "\n" ;

            errMsg += "Code: "+ iErrorCode + "    \n";
            errMsg += "Category: " + errorType + "       \n";
            errMsg += "Message: " + args.ErrorMessage + "     \n";

            if (errorType == "ParserError") {
                errMsg += "File: " + args.xamlFile + "     \n";
                errMsg += "Line: " + args.lineNumber + "     \n";
                errMsg += "Position: " + args.charPosition + "     \n";
            }
            else if (errorType == "RuntimeError") {           
                if (args.lineNumber != 0) {
                    errMsg += "Line: " + args.lineNumber + "     \n";
                    errMsg += "Position: " +  args.charPosition + "     \n";
                }
                errMsg += "MethodName: " + args.methodName + "     \n";
            }

            throw new Error(errMsg);
        }
    </script>

	<link rel="EditURI" type="application/rsd+xml" title="RSD" href="xmlrpc0db0.php?rsd" />
 <link rel="wlwmanifest" type="application/wlwmanifest+xml" href="wp-includes/wlwmanifest.xml" /> <style type='text/css'>
<!--#header { background: url('wp-content/themes/ais2/images/header-imgae03.html?upper=A7A73F&amp;lower=77773F') no-repeat bottom center; }
--></style>
</head>
<body>
<div id="page">

<div class="aisTopBar">
	<form method="get" id="searchform" action="http://adventuresinsoftware.com/blog/">
<div>
<a href="indexd784.html?feed=rss2"><img src="../images/feed-icon-28x28.png" border="0"></a>
<input type="text" value="" name="s" id="s" />
<input type="submit" id="searchsubmit" value="Search" />
</div>
</form>
</div>

<div class="aisHeaderImageRight">
	<div class="aisHeaderImage">
	<div class="aisHeaderCornerRight">
	<div class="aisHeaderCornerLeft">
	<div class="aisImageBar">
	<div class="aisSubSites">
		<a href="index.html" class="aisSubSiteLink"><span class="aisSiteTabRight"><span class="aisSiteTabLeft"><span class="aisSiteTab">
			home</span></span></span></a>
		<a class="aisSubSiteLink" href="indexb60a.html?cat=27"><span class="aisSiteTabRight"><span class="aisSiteTabLeft"><span class="aisSiteTab">
			historic modeling</span></span></span></a>
		<a class="aisSubSiteLink" href="indexa88f.html?cat=36"><span class="aisSiteTabRight"><span class="aisSiteTabLeft"><span class="aisSiteTab">
			update controls</span></span></span></a>
		<a href="index2d79.html?cat=26" class="aisSubSiteLink"><span class="aisSiteTabRight"><span class="aisSiteTabLeft"><span class="aisSiteTab">
			degrees of freedom</span></span></span></a>
		<a class="aisSubSiteLink" href="indexba53.html?page_id=2"><span class="aisSiteTabRight"><span class="aisSiteTabLeft"><span class="aisSiteTab">
			about us</span></span></span></a>

	</div>
	</div>
	</div>
	</div>
	</div>
</div>

<table style="width: 100%" cellspacing="0" cellpadding="0">
	<tr valign="top">
		<td width="210px">
<div id="sidebar">
<div class="aisLeftColumnFill">
<div class="aisLeftColumnBottom">
<div class="aisLeftColumnTop">
<div id="twitter_div" class="aisLeftNav">
<h2 class="sidebar-title">Twitter Updates</h2>
<ul id="twitter_update_list"></ul>
<a href="http://twitter.com/michaellperry" id="follow">Follow me</a>
</div>
<div id="twitter_reply_div" class="aisLeftNav">
<h2 class="sidebar-title">Twitter Replies</h2>
<ul id="twitter_reply_list"></ul>
</div>

<div class="aisLeftNav">
<a href='http://ineta.org/Speakers/SearchCommunitySpeakers.aspx?SpeakerId=c5110e21-9243-461b-a464-a6548524e885'><img alt='INETA Community Speakers Program' border='0' src='../../www.ineta.org/images/OfficialLogos/InetaCommunitySpeakersRequestMe.html' /></a>
</div>

<div class="aisLeftNav">
	<li class="pagenav"><h2>Pages</h2><ul><li class="page_item page-item-2"><a href="indexba53.html?page_id=2" title="About Us">About Us</a></li>
<li class="page_item page-item-210"><a href="index6ae3.html?page_id=210" title="Templates">Templates</a></li>
</ul></li></div>

<div class="aisLeftNav">
<h2>Archives</h2>
<ul>
	<li><a href='indexb4d5.html?m=201110' title='October 2011'>October 2011</a></li>
	<li><a href='indexc61a.html?m=201106' title='June 2011'>June 2011</a></li>
	<li><a href='indexa80d.html?m=201105' title='May 2011'>May 2011</a></li>
	<li><a href='index512b.html?m=201104' title='April 2011'>April 2011</a></li>
	<li><a href='index08fb.html?m=201103' title='March 2011'>March 2011</a></li>
	<li><a href='index52f4.html?m=201102' title='February 2011'>February 2011</a></li>
	<li><a href='index74f1.html?m=201101' title='January 2011'>January 2011</a></li>
	<li><a href='index8956.html?m=201012' title='December 2010'>December 2010</a></li>
	<li><a href='indexa1aa.html?m=201011' title='November 2010'>November 2010</a></li>
	<li><a href='indexe3d5.html?m=201010' title='October 2010'>October 2010</a></li>
	<li><a href='index9ab9.html?m=201009' title='September 2010'>September 2010</a></li>
	<li><a href='index1ff0.html?m=201008' title='August 2010'>August 2010</a></li>
	<li><a href='index9f11.html?m=201007' title='July 2010'>July 2010</a></li>
	<li><a href='index31f0.html?m=201006' title='June 2010'>June 2010</a></li>
	<li><a href='indexd189.html?m=201005' title='May 2010'>May 2010</a></li>
	<li><a href='indexb5c0.html?m=201004' title='April 2010'>April 2010</a></li>
	<li><a href='indexf258.html?m=201003' title='March 2010'>March 2010</a></li>
	<li><a href='index6e30.html?m=201002' title='February 2010'>February 2010</a></li>
	<li><a href='index6b19.html?m=201001' title='January 2010'>January 2010</a></li>
	<li><a href='index5c0a.html?m=200912' title='December 2009'>December 2009</a></li>
	<li><a href='index8f62.html?m=200911' title='November 2009'>November 2009</a></li>
	<li><a href='index451d.html?m=200910' title='October 2009'>October 2009</a></li>
	<li><a href='index3e04.html?m=200909' title='September 2009'>September 2009</a></li>
	<li><a href='index425a.html?m=200908' title='August 2009'>August 2009</a></li>
	<li><a href='index9907.html?m=200907' title='July 2009'>July 2009</a></li>
	<li><a href='index3104.html?m=200906' title='June 2009'>June 2009</a></li>
	<li><a href='indexc36d.html?m=200905' title='May 2009'>May 2009</a></li>
	<li><a href='index17e8.html?m=200904' title='April 2009'>April 2009</a></li>
	<li><a href='index10a5.html?m=200903' title='March 2009'>March 2009</a></li>
	<li><a href='index8988.html?m=200902' title='February 2009'>February 2009</a></li>
	<li><a href='index1419.html?m=200901' title='January 2009'>January 2009</a></li>
	<li><a href='index7866.html?m=200812' title='December 2008'>December 2008</a></li>
	<li><a href='index55f6.html?m=200811' title='November 2008'>November 2008</a></li>
	<li><a href='indexa7bc.html?m=200810' title='October 2008'>October 2008</a></li>
	<li><a href='indexe77c.html?m=200809' title='September 2008'>September 2008</a></li>
	<li><a href='indexcffc.html?m=200808' title='August 2008'>August 2008</a></li>
	<li><a href='index0e62.html?m=200807' title='July 2008'>July 2008</a></li>
	<li><a href='indexfda7.html?m=200806' title='June 2008'>June 2008</a></li>
	<li><a href='index7d64.html?m=200805' title='May 2008'>May 2008</a></li>
	<li><a href='index94dd.html?m=200804' title='April 2008'>April 2008</a></li>
	<li><a href='index9631.html?m=200803' title='March 2008'>March 2008</a></li>
	<li><a href='indexdd52.html?m=200802' title='February 2008'>February 2008</a></li>
	<li><a href='index21ee.html?m=200801' title='January 2008'>January 2008</a></li>
	<li><a href='index363c.html?m=200712' title='December 2007'>December 2007</a></li>
	<li><a href='index7493.html?m=200711' title='November 2007'>November 2007</a></li>
	<li><a href='index93a7.html?m=200710' title='October 2007'>October 2007</a></li>
	<li><a href='index4ca8.html?m=200709' title='September 2007'>September 2007</a></li>
	<li><a href='index6124.html?m=200708' title='August 2007'>August 2007</a></li>
	<li><a href='index6013.html?m=200707' title='July 2007'>July 2007</a></li>
	<li><a href='index2ab6.html?m=200706' title='June 2007'>June 2007</a></li>
	<li><a href='index44f0.html?m=200705' title='May 2007'>May 2007</a></li>
	<li><a href='indexf0b4.html?m=200704' title='April 2007'>April 2007</a></li>
	<li><a href='index481d.html?m=200703' title='March 2007'>March 2007</a></li>
	<li><a href='indexcbea.html?m=200702' title='February 2007'>February 2007</a></li>
	<li><a href='index9cdc.html?m=200701' title='January 2007'>January 2007</a></li>
	<li><a href='index3ea4.html?m=200612' title='December 2006'>December 2006</a></li>
	<li><a href='index67ca.html?m=200611' title='November 2006'>November 2006</a></li>
	<li><a href='indexff49.html?m=200610' title='October 2006'>October 2006</a></li>
	<li><a href='index611c.html?m=200609' title='September 2006'>September 2006</a></li>
	<li><a href='index9a21.html?m=200608' title='August 2006'>August 2006</a></li>
	<li><a href='index3ee9.html?m=200607' title='July 2006'>July 2006</a></li>
	<li><a href='indexe13a.html?m=200606' title='June 2006'>June 2006</a></li>
</ul>
</div>

<div class="aisLeftNav">
	</div>

<div class="aisLeftNav">
<h2>Books</h2>
<iframe src="http://rcm.amazon.com/e/cm?t=adventures0d2-20&amp;o=1&amp;p=8&amp;l=as1&amp;asins=0764526413&amp;fc1=000000&amp;IS2=1&amp;lt1=_blank&amp;lc1=0000ff&amp;bc1=000000&amp;bg1=ffffff&amp;f=ifr" style="width:120px;height:240px;" scrolling="no" marginwidth="0" marginheight="0" frameborder="0" name="I5" id="I5"></iframe>
<br/>
<iframe src="http://rcm.amazon.com/e/cm?t=adventures0d2-20&amp;o=1&amp;p=8&amp;l=as1&amp;asins=0201633612&amp;fc1=000000&amp;IS2=1&amp;lt1=_blank&amp;lc1=0000ff&amp;bc1=000000&amp;bg1=ffffff&amp;f=ifr" style="width:120px;height:240px;" scrolling="no" marginwidth="0" marginheight="0" frameborder="0" name="I6" id="I6"></iframe>
<br/>
<iframe src="http://rcm.amazon.com/e/cm?t=adventures0d2-20&amp;o=1&amp;p=8&amp;l=as1&amp;asins=0136291554&amp;fc1=000000&amp;IS2=1&amp;lt1=_blank&amp;lc1=0000ff&amp;bc1=000000&amp;bg1=ffffff&amp;f=ifr" style="width:120px;height:240px;" scrolling="no" marginwidth="0" marginheight="0" frameborder="0" name="I7" id="I7"></iframe>
<br/>
<iframe src="http://rcm.amazon.com/e/cm?t=adventures0d2-20&amp;o=1&amp;p=8&amp;l=as1&amp;asins=1888009195&amp;fc1=000000&amp;IS2=1&amp;lt1=_blank&amp;lc1=0000ff&amp;bc1=000000&amp;bg1=ffffff&amp;f=ifr" style="width:120px;height:240px;" scrolling="no" marginwidth="0" marginheight="0" frameborder="0" name="I8" id="I8"></iframe>
</div>
<div class="aisLeftNav">
<h2>Meta</h2>
<ul>
		<li><a href="wp-login.html">Login</a></li>
	<li><a href="http://validator.w3.org/check/referer" title="This page validates as XHTML 1.0 Transitional">Valid <abbr title="eXtensible HyperText Markup Language">XHTML</abbr></a></li>
	<li><a href="http://gmpg.org/xfn/"><abbr title="XHTML Friends Network">XFN</abbr></a></li>
	<li><a href="http://wordpress.org/" title="Powered by WordPress, state-of-the-art semantic personal publishing platform.">WordPress</a></li>
	</ul>
</div>
<div class="aisLeftContent">
<h2>Community</h2>
<ul>
	<script type="text/javascript" src="../../localhost/embed/92q2bbma.js"></script>
</ul>
</div>

</div></div></div>
</div>		</td>
		<td>

	<div id="content" class="widecolumn">

	
		<div class="navigation">
			<div class="alignleft">&laquo; <a href="indexfded.html?p=539">Forward network credentials to Report Server</a></div>
			<div class="alignright"><a href="index3a3f.html?p=545">Correspondence launch</a> &raquo;</div>
		</div>
		<br/>

		<div class="post" id="post-542">
			<h1>Navigate SSRS reports from a web application</h1>

			<div class="entry">
				<p>I’m on a <a href="index7398.html?p=531">continuing quest to deliver SSRS reports through a public-facing web application</a>. My user can <a href="index0745.html?p=532">authenticate</a>, and I can <a href="indexfded.html?p=539">forward their credentials to Report Server</a>. Now I need a branded menu of reports.</p>
<p><a href="wp-content/uploads/2010/07/image11.png"><img style="border-right-width: 0px; display: inline; border-top-width: 0px; border-bottom-width: 0px; margin-left: 0px; border-left-width: 0px; margin-right: 0px" title="image" border="0" alt="image" align="right" src="wp-content/uploads/2010/07/image-thumb11.png" width="244" height="232" /></a><strong>Generate a proxy</strong>     <br />We’re going to get the list of reports from the <a href="http://msdn.microsoft.com/en-us/library/ms154052.aspx">Report Server SOAP API</a>. So first, generate a proxy to call this API. The API is an old-fashioned asmx web service, so you can’t use WCF. Instead, we have to generate a web reference.</p>
<p>Create a new class library called “SQLServerReportingServices”. Right-click and select “Add Service Reference…”. Hit the “Advanced..” button, and then hit the “Add Web Reference” button.</p>
<p>Enter the URL of your report service, followed by “ReportService2010.asmx?wsdl”. You can get this URL by opening Reporting Services Configuration Manager and clicking Web Service URL. I entered “http://dit3074lt2:8080/ReportServer_SQL2008R2/ReportService2010.asmx?wsdl”. Click “Go”.</p>
<p>Enter a meaningful web reference name, like “ReportServer”. This is appended to the class library name to give the namespace of the proxy. So the proxy class is “SQLServerReportingServices.ReportServer.ReportingService2010”. Redundant, I know.</p>
<p><strong>Experiment with the proxy</strong>     <br />Now create a new unit test project. Not because calling an external system like SSRS is a good unit test, but because it’s more convenient than experimenting in a web project. Add a reference to the SQLServerReportingServices class library that you just created. Also, copy the app.config file from SQLServerReportingServices . Finally, add a reference to “System.Web.Services”. Now we can experiment.</p>
<p>Let’s begin by calling the <a href="http://msdn.microsoft.com/en-us/library/reportservice2010.reportingservice2010.listchildren.aspx">ListChildren</a> method. This method gives you a list of CatalogItem objects in a report folder. <a href="http://msdn.microsoft.com/en-us/library/reportservice2010.catalogitem_members.aspx">CatalogItem’s properties</a> give you information about each item, including a Path that you can use in another call to ListChildren. You’re actual number of items will vary, but you should get back an array.</p>
<pre class="code">[<span style="color: #2b91af">TestClass</span>]
<span style="color: blue">public class </span><span style="color: #2b91af">ReportNavigationTest
</span>{
    <span style="color: blue">public </span><span style="color: #2b91af">TestContext </span>TestContext { <span style="color: blue">get</span>; <span style="color: blue">set</span>; }

    <span style="color: blue">private </span><span style="color: #2b91af">ReportingService2010 </span>_client;

    [<span style="color: #2b91af">TestInitialize</span>]
    <span style="color: blue">public void </span>Initialize()
    {
        _client = <span style="color: blue">new </span><span style="color: #2b91af">ReportingService2010</span>();
        _client.Credentials = <span style="color: #2b91af">CredentialCache</span>.DefaultCredentials;
    }

    [<span style="color: #2b91af">TestCleanup</span>]
    <span style="color: blue">public void </span>Cleanup()
    {
        _client.Dispose();
    }

    [<span style="color: #2b91af">TestMethod</span>]
    <span style="color: blue">public void </span>GetTopLevelItems()
    {
        <span style="color: #2b91af">CatalogItem</span>[] children = _client.ListChildren(<span style="color: #a31515">&quot;/&quot;</span>, <span style="color: blue">false</span>);

        <span style="color: #2b91af">Assert</span>.AreEqual(6, children.Length);
    }
}</pre>
<p>If you get the exception “The request failed with HTTP status 401: Unauthorized”, be sure to initialize Credentials. Since you are running the unit test under your own account, the default credentials will be your own. Within the web application, we’ll need to forward the credentials of the logged-in user just like we did in the last post.</p>
<p>After experimenting in the unit test for a bit, we can move to the actual web application.</p>
<p><strong>Walk the folder structure</strong> </p>
<p>In a modern web application, user’s don’t want to click on a folder and wait for a postback to show its contents. If the folder structure is not too deep or too populated, we can display the entire contents on one page. If it is a bit much for one page, then users expect drop-down menus. In either scenario, we need to get the entire folder structure from a single call.</p>
<p>Fortunately, the reporting service lets us get all of the items in one call. Unfortunately, it returns these as a flat array. We have to render it as the folder structure that it truly is. To help with that, we’ll transform the array into a set of classes. See the Composite pattern in your handy Gang of Four book.</p>
<pre class="code"><span style="color: blue">public abstract class </span><span style="color: #2b91af">Item
</span>{
    <span style="color: blue">private string </span>_name;

    <span style="color: blue">public </span>Item(<span style="color: blue">string </span>name)
    {
        _name = name;
    }

    <span style="color: blue">public string </span>Name
    {
        <span style="color: blue">get </span>{ <span style="color: blue">return </span>_name; }
    }

    <span style="color: blue">public abstract void </span>Update();
}

<span style="color: blue">public class </span><span style="color: #2b91af">Folder </span>: <span style="color: #2b91af">Item
</span>{
    <span style="color: blue">private </span><span style="color: #2b91af">List</span>&lt;<span style="color: #2b91af">Item</span>&gt; _items = <span style="color: blue">new </span><span style="color: #2b91af">List</span>&lt;<span style="color: #2b91af">Item</span>&gt;();
    <span style="color: blue">private bool </span>_containsAnyReport;

    <span style="color: blue">public </span>Folder(<span style="color: blue">string </span>name)
        : <span style="color: blue">base</span>(name)
    {
    }

    <span style="color: blue">public void </span>AddItem(<span style="color: #2b91af">Item </span>item)
    {
        _items.Add(item);
    }

    <span style="color: blue">public override void </span>Update()
    {
        <span style="color: green">// Recursively update the items.
        </span><span style="color: blue">foreach </span>(<span style="color: #2b91af">Item </span>item <span style="color: blue">in </span>_items)
            item.Update();

        <span style="color: green">// This folder contains a report if any of its items is a report,
        // or if any of its sub folders contain a report.
        </span>_containsAnyReport =
            _items
                .OfType&lt;<span style="color: #2b91af">Report</span>&gt;()
                .Any() ||
            _items
                .OfType&lt;<span style="color: #2b91af">Folder</span>&gt;()
                .Any(folder =&gt; folder.ContainsAnyReport);
    }

    <span style="color: blue">public bool </span>ContainsAnyReport
    {
        <span style="color: blue">get </span>{ <span style="color: blue">return </span>_containsAnyReport; }
    }

    <span style="color: blue">public </span><span style="color: #2b91af">IEnumerable</span>&lt;<span style="color: #2b91af">Item</span>&gt; Items
    {
        <span style="color: blue">get </span>{ <span style="color: blue">return </span>_items; }
    }
}

<span style="color: blue">public class </span><span style="color: #2b91af">Report </span>: <span style="color: #2b91af">Item
</span>{
    <span style="color: blue">private string </span>_path;

    <span style="color: blue">public </span>Report(<span style="color: blue">string </span>name, <span style="color: blue">string </span>path)
        : <span style="color: blue">base</span>(name)
    {
        _path = path;
    }

    <span style="color: blue">public override void </span>Update()
    {
    }
}</pre>
<p>The Update method walks the structure and updates the ContainsAnyReport property. We can later use this property while rendering the HTML. If the folder does not contain any report, we don’t need to render it. This will hide any folders that the admin created just for data sources or some other resource.</p>
<p>Next we need to turn the flat array into a hierarchy. For this, we use a stack.</p>
<pre class="code"><span style="color: #2b91af">CatalogItem</span>[] children = _client.ListChildren(<span style="color: #a31515">&quot;/&quot;</span>, <span style="color: blue">true</span>);

<span style="color: green">// Keep the current folders on a stack.
</span><span style="color: #2b91af">Folder </span>root = <span style="color: blue">new </span><span style="color: #2b91af">Folder</span>(<span style="color: #a31515">&quot;&quot;</span>);
<span style="color: #2b91af">Stack</span>&lt;<span style="color: #2b91af">Folder</span>&gt; folderStack = <span style="color: blue">new </span><span style="color: #2b91af">Stack</span>&lt;<span style="color: #2b91af">Folder</span>&gt;();
folderStack.Push(root);

<span style="color: green">// Convert the flat array into a folder structure.
</span><span style="color: blue">string </span>currentPath = <span style="color: #a31515">&quot;/&quot;</span>;
<span style="color: #2b91af">Array</span>.Sort(children, (a, b) =&gt; a.Path.CompareTo(b.Path));
<span style="color: blue">foreach </span>(<span style="color: #2b91af">CatalogItem </span>item <span style="color: blue">in </span>children)
{
    <span style="color: green">// Get the path up to and including the final slash.
    </span><span style="color: blue">string </span>parentPath = item.Path.Substring(0, item.Path.LastIndexOf(<span style="color: #a31515">&quot;/&quot;</span>) + 1);
    <span style="color: blue">while </span>(parentPath != currentPath)
    {
        <span style="color: green">// Unwind the stack to get back to the parent folder.
        </span>folderStack.Pop();
        currentPath = currentPath.Substring(0, currentPath.LastIndexOf(<span style="color: #a31515">&quot;/&quot;</span>, currentPath.Length - 2) + 1);
    }

    <span style="color: blue">if </span>(item.TypeName == <span style="color: #a31515">&quot;Folder&quot;</span>)
    {
        <span style="color: green">// Push the new folder to the stack.
        </span><span style="color: #2b91af">Folder </span>folder = <span style="color: blue">new </span><span style="color: #2b91af">Folder</span>(item.Name);
        folderStack.Peek().AddItem(folder);
        folderStack.Push(folder);
        currentPath = item.Path + <span style="color: #a31515">&quot;/&quot;</span>;
    }
    <span style="color: blue">else if </span>(item.TypeName == <span style="color: #a31515">&quot;Report&quot;</span>)
    {
        <span style="color: green">// Add the report to the current folder.
        </span>folderStack.Peek().AddItem(<span style="color: blue">new </span><span style="color: #2b91af">Report</span>(item.Name, item.Path));
    }
}

<span style="color: green">// Figure out which folders contain reports.
</span>root.Update();</pre>
<p>We have to sort the array by the path to ensure that everything in a folder is clumped together. Then we add folders and reports to the current folder. If the path deviates, we pop the stack until we get back on track.</p>
<p>Now you can recursively walk the folder structure to output &lt;div&gt; tags or &lt;ul&gt; lists. That’s an exercise left to the reader, since it will depend upon how you want to render your menu.</p>
<p><strong>Next steps</strong> </p>
<p>As it turns out, we have some applications that don’t authenticate against Active Directory. We would like to use SSRS for those applications as well. For that, we will have to set up a shadow user, which has access to SSRS. Our next step is to implement authentication and authorization for a logged-in user, even though the application accesses SSRS via the shadow user.</p>

				
				<p class="postmetadata alt">
					<small>
						This entry was posted
												on Friday, July 30th, 2010 at 12:22 pm						and is filed under <a href="index363a.html?cat=45" title="View all posts in Reports" rel="category">Reports</a>.
						You can follow any responses to this entry through the <a href='indexd176.html?feed=rss2&amp;p=542'>RSS 2.0</a> feed.

													You can skip to the end and leave a response. Pinging is currently not allowed.

						
					</small>
				</p>

			</div>
		</div>

	
<!-- You can start editing here. -->

	<h3 id="comments">6 Responses to &#8220;Navigate SSRS reports from a web application&#8221;</h3>

	<ol class="commentlist">

	
		<li class="alt" id="comment-77508">
			<cite>Andrew</cite> Says:
						<br />

			<small class="commentmetadata"><a href="#comment-77508" title="">August 3rd, 2010 at 5:02 am</a> </small>

			<p>Hi</p>
<p>I'm trying to add web reference to ReportSerive2010.asmx web service with VS2010, but receive the following error message:</p>
<p>"Reporting Services Error    The path of the item 'wsdl' is not valid." If I remove "?wsdl" from the end of url, I receive the html page which displays the  ReportServer content, and "Add Reference" button is disabled. Can you help with it? I use SSRS in SharePoint Integrated mode, SSRS 2008 R2, SharePoint 2010.</p>
<p>Thanks, Andrew</p>

		</li>

	
	
		<li class="" id="comment-77679">
			<cite>Michael L Perry</cite> Says:
						<br />

			<small class="commentmetadata"><a href="#comment-77679" title="">August 4th, 2010 at 8:42 am</a> </small>

			<p>Andrew,</p>
<p>I can reproduce that problem if I leave off the ReportService2010.asmx part of the URL. Please make sure that you didn't drop that.</p>
<p>Here's how I get to the Report Server content:<br />
<a href="http://dit3074lt2:8080/ReportServer_SQL2008R2" rel="nofollow">http://dit3074lt2:8080/ReportServer_SQL2008R2</a></p>
<p>This gets me to the wsdl:<br />
<a href="http://dit3074lt2:8080/ReportServer_SQL2008R2/ReportService2010.asmx?wsdl" rel="nofollow">http://dit3074lt2:8080/ReportServer_SQL2008R2/ReportService2010.asmx?wsdl</a></p>
<p>As does this:<br />
<a href="http://dit3074lt2:8080/ReportServer_SQL2008R2/ReportService2010.asmx" rel="nofollow">http://dit3074lt2:8080/ReportServer_SQL2008R2/ReportService2010.asmx</a></p>
<p>This gets me the "The path of the item 'wsdl' is not valid" error:<br />
<a href="http://dit3074lt2:8080/ReportServer_SQL2008R2?wsdl" rel="nofollow">http://dit3074lt2:8080/ReportServer_SQL2008R2?wsdl</a></p>

		</li>

	
	
		<li class="alt" id="comment-77788">
			<cite>Andrew</cite> Says:
						<br />

			<small class="commentmetadata"><a href="#comment-77788" title="">August 5th, 2010 at 9:47 am</a> </small>

			<p>Thank you Michael for the response.</p>
<p>Dut in my case it looks different for some reason:</p>
<p>These get me the Report Server content:<br />
<a href="http://:/" rel="nofollow">http://:/</a><br />
<a href="http://://ReportService2010.asmx" rel="nofollow">http://://ReportService2010.asmx</a></p>
<p>And this gets me the "The path of the item 'wsdl' is not valid" error:<br />
<a href="http://:/ReportService2010.asmx?wsdl" rel="nofollow">http://:/ReportService2010.asmx?wsdl</a></p>
<p>But in the same time I can get ReportService2006.asmx web service....</p>

		</li>

	
	
		<li class="" id="comment-80514">
			<cite><a href='http://mattdotson.com/' rel='external nofollow'>Matt</a></cite> Says:
						<br />

			<small class="commentmetadata"><a href="#comment-80514" title="">August 23rd, 2010 at 7:26 pm</a> </small>

			<p>Looks like you might be missing ReportServer in your url ... /ReportServer/ReportService2010.asmx</p>

		</li>

	
	
		<li class="alt" id="comment-80927">
			<cite>Michael L Perry</cite> Says:
						<br />

			<small class="commentmetadata"><a href="#comment-80927" title="">August 27th, 2010 at 9:30 am</a> </small>

			<p>If ReportService2010.asmx isn't working for you, try ReportService2005.asmx instead. You might not be on R2.</p>

		</li>

	
	
		<li class="" id="comment-128069">
			<cite><a href='http://www.blograndom.com/' rel='external nofollow'>RB Cohen</a></cite> Says:
						<br />

			<small class="commentmetadata"><a href="#comment-128069" title="">March 4th, 2011 at 8:25 am</a> </small>

			<p>We're writing an SDK in PHP for the 2010 SOAP API. We are able to call ListChildren, etc. Does anybody know what method to call to get an actual report? In the 2005 version it was "Render", but this no longer exists in 2010?</p>

		</li>

	
	
	</ol>

 


<h3 id="respond">Leave a Reply</h3>

<p>You must be <a href="wp-loginf294.html?redirect_to=http://adventuresinsoftware.com/blog/?p=542">logged in</a> to post a comment.</p>


	
	</div>
		</td>
	</tr>
</table>

<hr />
<div id="footer">
<!-- If you'd like to support WordPress, having the "powered by" link someone on your blog is the best way, it's our only promotion or advertising. -->
	<p>
		Adventures in Software is proudly powered by 
		<a href="http://wordpress.org/">WordPress</a>
		<br /><a href="indexd784.html?feed=rss2">Entries (RSS)</a>
		and <a href="indexa6da.html?feed=comments-rss2">Comments (RSS)</a>.
		<!-- 21 queries. 0.271 seconds. -->
	</p>
</div>
<script type="text/javascript">
var gaJsHost = (("https:" == document.location.protocol) ? "https://ssl." : "http://www.");
document.write(unescape("%3Cscript src='" + gaJsHost + "google-analytics.com/ga.js' type='text/javascript'%3E%3C/script%3E"));
</script>
<script type="text/javascript">
try {
var pageTracker = _gat._getTracker("UA-389401-3");
pageTracker._trackPageview();
} catch(err) {}</script></div>

<!-- Gorgeous design by Michael Heilemann - http://binarybonsai.com/kubrick/ -->

		<div id="sk2-footer" style="color:#FFF; background-color:#444; padding: 3px 2px 3px 2px; border-top: #888 solid 1px;">This blog is protected by <a href="http://unknowngenius.com/blog/" title="Dave">dr Dave</a>'s <strong><a href="http://unknowngenius.com/blog/wordpress/spam-karma/" title="SK2">Spam Karma 2</a></strong>: <strong>274531</strong>  Spams eaten and counting...</div><script type="text/javascript" src="replies.js"></script>
<script type="text/javascript" src="blogger.js"></script>
<script type="text/javascript" src="http://twitter.com/statuses/user_timeline/michaellperry.json?callback=twitterCallback2&amp;count=5"></script>
<script type="text/javascript" src="http://search.twitter.com/search.json?q=@michaellperry&amp;callback=twitterCallbackReplies&amp;rpp=5"></script>
</body>

<!-- Mirrored from adventuresinsoftware.com/blog/?p=542 by HTTrack Website Copier/3.x [XR&CO'2014], Fri, 13 Jan 2017 12:55:33 GMT -->
</html>
