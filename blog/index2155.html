<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" dir="ltr">


<!-- Mirrored from adventuresinsoftware.com/blog/?cat=1&paged=2 by HTTrack Website Copier/3.x [XR&CO'2014], Fri, 13 Jan 2017 13:02:59 GMT -->
<!-- Added by HTTrack --><meta http-equiv="content-type" content="text/html;charset=UTF-8" /><!-- /Added by HTTrack -->
<head profile="http://gmpg.org/xfn/11">
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8" />

<title>Adventures in Software   &raquo; Uncategorized</title>

<meta name="generator" content="WordPress 2.3.3" /> <!-- leave this for stats -->

<link rel="stylesheet" href="wp-content/themes/ais2/style.css" type="text/css" media="screen" />
<link rel="alternate" type="application/rss+xml" title="Adventures in Software RSS Feed" href="indexd784.html?feed=rss2" />
<link rel="pingback" href="xmlrpc.html" />
    <script type="text/javascript">
        function onSilverlightError(sender, args) {
            var appSource = "";
            if (sender != null && sender != 0) {
              appSource = sender.getHost().Source;
            }
            
            var errorType = args.ErrorType;
            var iErrorCode = args.ErrorCode;

            if (errorType == "ImageError" || errorType == "MediaError") {
              return;
            }

            var errMsg = "Unhandled Error in Silverlight Application " +  appSource + "\n" ;

            errMsg += "Code: "+ iErrorCode + "    \n";
            errMsg += "Category: " + errorType + "       \n";
            errMsg += "Message: " + args.ErrorMessage + "     \n";

            if (errorType == "ParserError") {
                errMsg += "File: " + args.xamlFile + "     \n";
                errMsg += "Line: " + args.lineNumber + "     \n";
                errMsg += "Position: " + args.charPosition + "     \n";
            }
            else if (errorType == "RuntimeError") {           
                if (args.lineNumber != 0) {
                    errMsg += "Line: " + args.lineNumber + "     \n";
                    errMsg += "Position: " +  args.charPosition + "     \n";
                }
                errMsg += "MethodName: " + args.methodName + "     \n";
            }

            throw new Error(errMsg);
        }
    </script>

	<link rel="EditURI" type="application/rsd+xml" title="RSD" href="xmlrpc0db0.php?rsd" />
 <link rel="wlwmanifest" type="application/wlwmanifest+xml" href="wp-includes/wlwmanifest.xml" /> <style type='text/css'>
<!--#header { background: url('wp-content/themes/ais2/images/header-imgae03.html?upper=A7A73F&amp;lower=77773F') no-repeat bottom center; }
--></style>
</head>
<body>
<div id="page">

<div class="aisTopBar">
	<form method="get" id="searchform" action="http://adventuresinsoftware.com/blog/">
<div>
<a href="indexd784.html?feed=rss2"><img src="../images/feed-icon-28x28.png" border="0"></a>
<input type="text" value="" name="s" id="s" />
<input type="submit" id="searchsubmit" value="Search" />
</div>
</form>
</div>

<div class="aisHeaderImageRight">
	<div class="aisHeaderImage">
	<div class="aisHeaderCornerRight">
	<div class="aisHeaderCornerLeft">
	<div class="aisImageBar">
	<div class="aisSubSites">
		<a href="index.html" class="aisSubSiteLink"><span class="aisSiteTabRight"><span class="aisSiteTabLeft"><span class="aisSiteTab">
			home</span></span></span></a>
		<a class="aisSubSiteLink" href="indexb60a.html?cat=27"><span class="aisSiteTabRight"><span class="aisSiteTabLeft"><span class="aisSiteTab">
			historic modeling</span></span></span></a>
		<a class="aisSubSiteLink" href="indexa88f.html?cat=36"><span class="aisSiteTabRight"><span class="aisSiteTabLeft"><span class="aisSiteTab">
			update controls</span></span></span></a>
		<a href="index2d79.html?cat=26" class="aisSubSiteLink"><span class="aisSiteTabRight"><span class="aisSiteTabLeft"><span class="aisSiteTab">
			degrees of freedom</span></span></span></a>
		<a class="aisSubSiteLink" href="indexba53.html?page_id=2"><span class="aisSiteTabRight"><span class="aisSiteTabLeft"><span class="aisSiteTab">
			about us</span></span></span></a>

	</div>
	</div>
	</div>
	</div>
	</div>
</div>

<table style="width: 100%" cellspacing="0" cellpadding="0">
	<tr valign="top">
		<td width="210px">
<div id="sidebar">
<div class="aisLeftColumnFill">
<div class="aisLeftColumnBottom">
<div class="aisLeftColumnTop">
<div id="twitter_div" class="aisLeftNav">
<h2 class="sidebar-title">Twitter Updates</h2>
<ul id="twitter_update_list"></ul>
<a href="http://twitter.com/michaellperry" id="follow">Follow me</a>
</div>
<div id="twitter_reply_div" class="aisLeftNav">
<h2 class="sidebar-title">Twitter Replies</h2>
<ul id="twitter_reply_list"></ul>
</div>

<div class="aisLeftNav">
<a href='http://ineta.org/Speakers/SearchCommunitySpeakers.aspx?SpeakerId=c5110e21-9243-461b-a464-a6548524e885'><img alt='INETA Community Speakers Program' border='0' src='../../www.ineta.org/images/OfficialLogos/InetaCommunitySpeakersRequestMe.html' /></a>
</div>

<div class="aisLeftNav">
	<li class="pagenav"><h2>Pages</h2><ul><li class="page_item page-item-2"><a href="indexba53.html?page_id=2" title="About Us">About Us</a></li>
<li class="page_item page-item-210"><a href="index6ae3.html?page_id=210" title="Templates">Templates</a></li>
</ul></li></div>

<div class="aisLeftNav">
<h2>Archives</h2>
<ul>
	<li><a href='indexb4d5.html?m=201110' title='October 2011'>October 2011</a></li>
	<li><a href='indexc61a.html?m=201106' title='June 2011'>June 2011</a></li>
	<li><a href='indexa80d.html?m=201105' title='May 2011'>May 2011</a></li>
	<li><a href='index512b.html?m=201104' title='April 2011'>April 2011</a></li>
	<li><a href='index08fb.html?m=201103' title='March 2011'>March 2011</a></li>
	<li><a href='index52f4.html?m=201102' title='February 2011'>February 2011</a></li>
	<li><a href='index74f1.html?m=201101' title='January 2011'>January 2011</a></li>
	<li><a href='index8956.html?m=201012' title='December 2010'>December 2010</a></li>
	<li><a href='indexa1aa.html?m=201011' title='November 2010'>November 2010</a></li>
	<li><a href='indexe3d5.html?m=201010' title='October 2010'>October 2010</a></li>
	<li><a href='index9ab9.html?m=201009' title='September 2010'>September 2010</a></li>
	<li><a href='index1ff0.html?m=201008' title='August 2010'>August 2010</a></li>
	<li><a href='index9f11.html?m=201007' title='July 2010'>July 2010</a></li>
	<li><a href='index31f0.html?m=201006' title='June 2010'>June 2010</a></li>
	<li><a href='indexd189.html?m=201005' title='May 2010'>May 2010</a></li>
	<li><a href='indexb5c0.html?m=201004' title='April 2010'>April 2010</a></li>
	<li><a href='indexf258.html?m=201003' title='March 2010'>March 2010</a></li>
	<li><a href='index6e30.html?m=201002' title='February 2010'>February 2010</a></li>
	<li><a href='index6b19.html?m=201001' title='January 2010'>January 2010</a></li>
	<li><a href='index5c0a.html?m=200912' title='December 2009'>December 2009</a></li>
	<li><a href='index8f62.html?m=200911' title='November 2009'>November 2009</a></li>
	<li><a href='index451d.html?m=200910' title='October 2009'>October 2009</a></li>
	<li><a href='index3e04.html?m=200909' title='September 2009'>September 2009</a></li>
	<li><a href='index425a.html?m=200908' title='August 2009'>August 2009</a></li>
	<li><a href='index9907.html?m=200907' title='July 2009'>July 2009</a></li>
	<li><a href='index3104.html?m=200906' title='June 2009'>June 2009</a></li>
	<li><a href='indexc36d.html?m=200905' title='May 2009'>May 2009</a></li>
	<li><a href='index17e8.html?m=200904' title='April 2009'>April 2009</a></li>
	<li><a href='index10a5.html?m=200903' title='March 2009'>March 2009</a></li>
	<li><a href='index8988.html?m=200902' title='February 2009'>February 2009</a></li>
	<li><a href='index1419.html?m=200901' title='January 2009'>January 2009</a></li>
	<li><a href='index7866.html?m=200812' title='December 2008'>December 2008</a></li>
	<li><a href='index55f6.html?m=200811' title='November 2008'>November 2008</a></li>
	<li><a href='indexa7bc.html?m=200810' title='October 2008'>October 2008</a></li>
	<li><a href='indexe77c.html?m=200809' title='September 2008'>September 2008</a></li>
	<li><a href='indexcffc.html?m=200808' title='August 2008'>August 2008</a></li>
	<li><a href='index0e62.html?m=200807' title='July 2008'>July 2008</a></li>
	<li><a href='indexfda7.html?m=200806' title='June 2008'>June 2008</a></li>
	<li><a href='index7d64.html?m=200805' title='May 2008'>May 2008</a></li>
	<li><a href='index94dd.html?m=200804' title='April 2008'>April 2008</a></li>
	<li><a href='index9631.html?m=200803' title='March 2008'>March 2008</a></li>
	<li><a href='indexdd52.html?m=200802' title='February 2008'>February 2008</a></li>
	<li><a href='index21ee.html?m=200801' title='January 2008'>January 2008</a></li>
	<li><a href='index363c.html?m=200712' title='December 2007'>December 2007</a></li>
	<li><a href='index7493.html?m=200711' title='November 2007'>November 2007</a></li>
	<li><a href='index93a7.html?m=200710' title='October 2007'>October 2007</a></li>
	<li><a href='index4ca8.html?m=200709' title='September 2007'>September 2007</a></li>
	<li><a href='index6124.html?m=200708' title='August 2007'>August 2007</a></li>
	<li><a href='index6013.html?m=200707' title='July 2007'>July 2007</a></li>
	<li><a href='index2ab6.html?m=200706' title='June 2007'>June 2007</a></li>
	<li><a href='index44f0.html?m=200705' title='May 2007'>May 2007</a></li>
	<li><a href='indexf0b4.html?m=200704' title='April 2007'>April 2007</a></li>
	<li><a href='index481d.html?m=200703' title='March 2007'>March 2007</a></li>
	<li><a href='indexcbea.html?m=200702' title='February 2007'>February 2007</a></li>
	<li><a href='index9cdc.html?m=200701' title='January 2007'>January 2007</a></li>
	<li><a href='index3ea4.html?m=200612' title='December 2006'>December 2006</a></li>
	<li><a href='index67ca.html?m=200611' title='November 2006'>November 2006</a></li>
	<li><a href='indexff49.html?m=200610' title='October 2006'>October 2006</a></li>
	<li><a href='index611c.html?m=200609' title='September 2006'>September 2006</a></li>
	<li><a href='index9a21.html?m=200608' title='August 2006'>August 2006</a></li>
	<li><a href='index3ee9.html?m=200607' title='July 2006'>July 2006</a></li>
	<li><a href='indexe13a.html?m=200606' title='June 2006'>June 2006</a></li>
</ul>
</div>

<div class="aisLeftNav">
	</div>

<div class="aisLeftNav">
<h2>Books</h2>
<iframe src="http://rcm.amazon.com/e/cm?t=adventures0d2-20&amp;o=1&amp;p=8&amp;l=as1&amp;asins=0764526413&amp;fc1=000000&amp;IS2=1&amp;lt1=_blank&amp;lc1=0000ff&amp;bc1=000000&amp;bg1=ffffff&amp;f=ifr" style="width:120px;height:240px;" scrolling="no" marginwidth="0" marginheight="0" frameborder="0" name="I5" id="I5"></iframe>
<br/>
<iframe src="http://rcm.amazon.com/e/cm?t=adventures0d2-20&amp;o=1&amp;p=8&amp;l=as1&amp;asins=0201633612&amp;fc1=000000&amp;IS2=1&amp;lt1=_blank&amp;lc1=0000ff&amp;bc1=000000&amp;bg1=ffffff&amp;f=ifr" style="width:120px;height:240px;" scrolling="no" marginwidth="0" marginheight="0" frameborder="0" name="I6" id="I6"></iframe>
<br/>
<iframe src="http://rcm.amazon.com/e/cm?t=adventures0d2-20&amp;o=1&amp;p=8&amp;l=as1&amp;asins=0136291554&amp;fc1=000000&amp;IS2=1&amp;lt1=_blank&amp;lc1=0000ff&amp;bc1=000000&amp;bg1=ffffff&amp;f=ifr" style="width:120px;height:240px;" scrolling="no" marginwidth="0" marginheight="0" frameborder="0" name="I7" id="I7"></iframe>
<br/>
<iframe src="http://rcm.amazon.com/e/cm?t=adventures0d2-20&amp;o=1&amp;p=8&amp;l=as1&amp;asins=1888009195&amp;fc1=000000&amp;IS2=1&amp;lt1=_blank&amp;lc1=0000ff&amp;bc1=000000&amp;bg1=ffffff&amp;f=ifr" style="width:120px;height:240px;" scrolling="no" marginwidth="0" marginheight="0" frameborder="0" name="I8" id="I8"></iframe>
</div>
<div class="aisLeftNav">
<h2>Meta</h2>
<ul>
		<li><a href="wp-login.html">Login</a></li>
	<li><a href="http://validator.w3.org/check/referer" title="This page validates as XHTML 1.0 Transitional">Valid <abbr title="eXtensible HyperText Markup Language">XHTML</abbr></a></li>
	<li><a href="http://gmpg.org/xfn/"><abbr title="XHTML Friends Network">XFN</abbr></a></li>
	<li><a href="http://wordpress.org/" title="Powered by WordPress, state-of-the-art semantic personal publishing platform.">WordPress</a></li>
	</ul>
</div>
<div class="aisLeftContent">
<h2>Community</h2>
<ul>
	<script type="text/javascript" src="../../localhost/embed/92q2bbma.js"></script>
</ul>
</div>

</div></div></div>
</div>		</td>
		<td>

	<div id="content" class="narrowcolumn">

		
		 		<h2 class="pagetitle">Archive for the &#8216;Uncategorized&#8217; Category</h2>

 	  

		<div class="navigation">
			<div class="alignleft"><a href="index9f05.html?cat=1&amp;paged=3">&laquo; Previous Entries</a></div>
			<div class="alignright"><a href="indexb31a.html?cat=1">Next Entries &raquo;</a></div>
		</div>

				<div class="post">
				<h3 id="post-489"><a href="indexb645.html?p=489" rel="bookmark" title="Permanent Link to There&rsquo;s an op for that">There&rsquo;s an op for that</a></h3>
				<small>Friday, April 2nd, 2010</small>

				<div class="entry">
					<p>Just found this extension method in my team’s code:</p>
<pre><span style="color: blue">public</span> <span style="color: blue">static</span> <span style="color: blue">int</span> <span style="color: #2b91af">ConvertNull</span>(<span style="color: blue">this</span> <span style="color: blue">int?</span> value, <span style="color: blue">int</span> defaultValue)
{
    <span style="color: blue">if</span> (value == <span style="color: blue">null</span>)
        <span style="color: blue">return</span> defaultValue;
    <span style="color: blue">return</span> ((<span style="color: blue">int</span>)value);
}</pre>
<p>Um, what’s wrong with the null coalescing operator?</p>
				</div>

				<p class="postmetadata">Posted in <a href="indexb31a.html?cat=1" title="View all posts in Uncategorized" rel="category">Uncategorized</a> |   <a href="indexb645.html?p=489#respond" title="Comment on There&rsquo;s an op for that">No Comments &#187;</a></p>

			</div>

				<div class="post">
				<h3 id="post-440"><a href="indexe982.html?p=440" rel="bookmark" title="Permanent Link to Homework assignment: Fix the Socket API">Homework assignment: Fix the Socket API</a></h3>
				<small>Friday, September 25th, 2009</small>

				<div class="entry">
					<p>Your task is to fix the .NET Socket API. This is as unhelpful as an API gets. There are several rules that a user of a Socket must follow. Create an API that proves that they are following all of the rules.
<p>Here is the relevant part of the existing unhelpful API:</p>
<pre><span style="color: blue">public</span> <span style="color: blue">class</span> Socket : IDisposable
{
    <span style="color: blue">public</span> Socket(SocketInformation socketInformation);
    <span style="color: blue">public</span> Socket(AddressFamily addressFamily, SocketType socketType, ProtocolType protocolType);

    <span style="color: blue">public</span> Socket Accept();
    <span style="color: blue">public</span> <span style="color: blue">void</span> Bind(EndPoint localEP);
    <span style="color: blue">public</span> <span style="color: blue">void</span> Connect(EndPoint remoteEP);
    <span style="color: blue">public</span> <span style="color: blue">void</span> Connect(<span style="color: blue">string</span> host, <span style="color: blue">int</span> port);
    <span style="color: blue">public</span> <span style="color: blue">void</span> Dispose();
    <span style="color: blue">public</span> <span style="color: blue">void</span> Listen(<span style="color: blue">int</span> backlog);
    <span style="color: blue">public</span> <span style="color: blue">int</span> Receive(<span style="color: blue">byte</span>[] buffer);
    <span style="color: blue">public</span> <span style="color: blue">int</span> Send(<span style="color: blue">byte</span>[] buffer);
}</pre>
<p>Here are the rules as documented in MSDN: </p>
<ul>
<li>You cannot use a Socket returned from Accept to accept any additional connections from the connection queue.
<li>You cannot call Accept, Bind, Connect, Listen, Receive, or Send if the socket has been closed.
<li>You must call Bind before you can call the Listen method.
<li>You must call Listen before calling Accept.
<li>Connect(string host, int port) can only be called if addressFamily is either InterNetwork or InterNetworkV6.
<li>Connect cannot be called if Listen has been called.
<li>You have to either call Connect or Accept before Sending and Receiving data.
<li>If the socket has been previously disconnected, then you cannot use Connect to restore the connection.</li>
</ul>
<p>You may use as the basis of your proof the concepts that were discussed in previous Q.E.D. articles, including:</p>
<ul>
<li><a href="index0ed6.html?p=410">Math 101 for developers</a></li>
<li><a href="indexd519.html?p=415">Proving prerequisites</a></li>
<li><a href="index5750.html?p=416">The constructor: the strongest of all methods</a></li>
<li><a href="indexedce.html?p=429">Closure</a></li>
<li><a href="indexecc4.html?p=432">Proof based on imperative programming</a></li>
<li><a href="indexc1f6.html?p=436">Fixing an unhelpful API</a></li>
</ul>
<p>Please post responses in the comments, email them to <a href="mailto:mperry@adventuresinsoftware.com">mperry@adventuresinsoftware.com</a>, or post links on your own blog. I will share my solution next week.</p>
				</div>

				<p class="postmetadata">Posted in <a href="indexb31a.html?cat=1" title="View all posts in Uncategorized" rel="category">Uncategorized</a> |   <a href="indexe982.html?p=440#respond" title="Comment on Homework assignment: Fix the Socket API">No Comments &#187;</a></p>

			</div>

				<div class="post">
				<h3 id="post-395"><a href="index0449.html?p=395" rel="bookmark" title="Permanent Link to Wet floor effect batch transform using WPF">Wet floor effect batch transform using WPF</a></h3>
				<small>Saturday, June 13th, 2009</small>

				<div class="entry">
					<p>My wife just took some new photos for <a href="http://myscraproom.net/">her scrapbooking website</a>. I have a coverflow effect on that page, so I needed to apply the wet floor transform to 64 images. Rather than do it all by hand, I wrote some WPF code to do it for me:</p>
<pre><span style="color: blue">public</span> <span style="color: blue">class</span> WetFloor
{
    <span style="color: blue">public</span> <span style="color: blue">static</span> <span style="color: blue">void</span> Render(<span style="color: blue">string</span> source, <span style="color: blue">string</span> target, <span style="color: blue">int</span> targetWidth)
    {
        <span style="color: blue">using</span> (Stream input = File.OpenRead(source))
        {
            <span style="color: green">// Load the source jpg.</span>
            JpegBitmapDecoder sourceJpg = <span style="color: blue">new</span> JpegBitmapDecoder(input, BitmapCreateOptions.None, BitmapCacheOption.Default);
            <span style="color: blue">if</span> (sourceJpg.Frames.Count != <span style="color: maroon">1</span>)
                <span style="color: blue">throw</span> <span style="color: blue">new</span> Exception(String.Format(<span style="color: maroon">"I don't know how to handle {0} frames."</span>, sourceJpg.Frames.Count));
            BitmapFrame sourceBitmap = sourceJpg.Frames[<span style="color: maroon">0</span>];

            <span style="color: green">// Create a render target scaled to 400 pixels at 150% the aspect ratio.</span>
            <span style="color: blue">double</span> scale = (<span style="color: blue">double</span>)targetWidth / sourceBitmap.PixelWidth;
            RenderTargetBitmap renderTarget = <span style="color: blue">new</span> RenderTargetBitmap(
                targetWidth, (<span style="color: blue">int</span>)Math.Round(scale * (<span style="color: blue">float</span>)sourceBitmap.PixelHeight * <span style="color: maroon">1</span><span style="color: maroon">.5</span>),
                sourceBitmap.DpiX, sourceBitmap.DpiY,
                PixelFormats.Pbgra32);

            <span style="color: green">// Paint a rectangle with the source bitmap.</span>
            Rectangle original = <span style="color: blue">new</span> Rectangle()
            {
                Fill = <span style="color: blue">new</span> ImageBrush(sourceBitmap),
                Width = scale * sourceBitmap.Width,
                Height = scale * sourceBitmap.Height
            };

            original.Arrange(<span style="color: blue">new</span> Rect(<span style="color: blue">new</span> Size(scale * sourceBitmap.Width, scale * sourceBitmap.Height)));
            renderTarget.Render(original);

            <span style="color: green">// Paint a black rectangle.</span>
            Rectangle shade = <span style="color: blue">new</span> Rectangle()
            {
                Fill = <span style="color: blue">new</span> SolidColorBrush(Colors.Black),
                Width = scale * sourceBitmap.Width,
                Height = scale * sourceBitmap.Height
            };

            shade.Arrange(<span style="color: blue">new</span> Rect(<span style="color: blue">new</span> Point(<span style="color: maroon">0</span>, scale * sourceBitmap.Height), <span style="color: blue">new</span> Size(scale * sourceBitmap.Width, scale * sourceBitmap.Height)));
            renderTarget.Render(shade);

            <span style="color: green">// Paint an inverted rectangle with the source bitmap.</span>
            Border reflection = <span style="color: blue">new</span> Border()
            {
                Background = <span style="color: blue">new</span> ImageBrush(sourceBitmap),
                Width = scale * sourceBitmap.Width,
                Height = scale * sourceBitmap.Height,
                RenderTransform = <span style="color: blue">new</span> ScaleTransform(<span style="color: maroon">1</span><span style="color: maroon">.0f</span>, -<span style="color: maroon">1</span><span style="color: maroon">.0f</span>, scale * sourceBitmap.Width / <span style="color: maroon">2</span>, scale * sourceBitmap.Height / <span style="color: maroon">2</span>),
                OpacityMask = <span style="color: blue">new</span> LinearGradientBrush()
                {
                    StartPoint = <span style="color: blue">new</span> Point(<span style="color: maroon">0</span>, <span style="color: maroon">1</span>),
                    EndPoint = <span style="color: blue">new</span> Point(<span style="color: maroon">0</span>, <span style="color: maroon">0</span>),
                    GradientStops = <span style="color: blue">new</span> GradientStopCollection(<span style="color: blue">new</span> GradientStop[]
                    {
                        <span style="color: blue">new</span> GradientStop()
                        {
                            Offset = -<span style="color: maroon">0</span><span style="color: maroon">.3f</span>,
                            Color = Colors.Black
                        },
                        <span style="color: blue">new</span> GradientStop()
                        {
                            Offset = <span style="color: maroon">0</span><span style="color: maroon">.5f</span>,
                            Color = Colors.Transparent
                        }
                    })
                }
            };

            reflection.Arrange(<span style="color: blue">new</span> Rect(<span style="color: blue">new</span> Point(<span style="color: maroon">0</span>, scale * sourceBitmap.Height), <span style="color: blue">new</span> Size(scale * sourceBitmap.Width, scale * sourceBitmap.Height)));
            renderTarget.Render(reflection);

            <span style="color: green">// Render the final product.</span>
            JpegBitmapEncoder png = <span style="color: blue">new</span> JpegBitmapEncoder();
            png.Frames.Add(BitmapFrame.Create(renderTarget));
            <span style="color: blue">using</span> (Stream fs = File.Create(target))
            {
                png.Save(fs);
            }
        }
    }
}
</pre>
<p>Enjoy.</p>
				</div>

				<p class="postmetadata">Posted in <a href="indexb31a.html?cat=1" title="View all posts in Uncategorized" rel="category">Uncategorized</a> |   <a href="index0449.html?p=395#respond" title="Comment on Wet floor effect batch transform using WPF">No Comments &#187;</a></p>

			</div>

				<div class="post">
				<h3 id="post-330"><a href="index1639.html?p=330" rel="bookmark" title="Permanent Link to Ignore whitespace in TFS compare">Ignore whitespace in TFS compare</a></h3>
				<small>Friday, April 10th, 2009</small>

				<div class="entry">
					<p>Thanks to <a href="http://jb-brown.blogspot.com/2009/03/whitesapce-in-team-system-compare.html">JB Brown</a>, <a href="http://blogs.msdn.com/jmanning/articles/535573.aspx">James Manning</a>, and <a href="http://social.msdn.microsoft.com/forums/en-US/tfsgeneral/thread/c939de17-98fe-4526-b69c-2ed0affb3dba/">Brian Harry</a> for this information. Unfortunately, nobody I could find puts it all in one place, step-by-step. So here it is.</p>
<ul>
<li>In Visual Studio, select "Tools", "Options", "Source Control", ":Visual Studio Team Foundation Server".</li>
<li>Click "Configure User Tools".</li>
<li>Click "Add".</li>
<li>Extension: .cs</li>
<li>Operation: Compare</li>
<li>Command: C:\Program Files\Microsoft Visual Studio 9.0\Common7\IDE\diffmerge.exe</li>
<li>Arguments: %1 %2 %6 %7 %5 /ignorespace</li>
<li>OK</li>
<li>OK</li>
<li>OK</li>
</ul>
<p>If you use VB, C++, XML, or any other file extension, go back and add those extensions, too.</p>
<p>And please, Microsoft. Why is this not the default?</p>
				</div>

				<p class="postmetadata">Posted in <a href="indexb31a.html?cat=1" title="View all posts in Uncategorized" rel="category">Uncategorized</a> |   <a href="index1639.html?p=330#comments" title="Comment on Ignore whitespace in TFS compare">2 Comments &#187;</a></p>

			</div>

				<div class="post">
				<h3 id="post-252"><a href="indexa943.html?p=252" rel="bookmark" title="Permanent Link to The real solution to creating objects in a managed WMI provider">The real solution to creating objects in a managed WMI provider</a></h3>
				<small>Wednesday, September 3rd, 2008</small>

				<div class="entry">
					<p>This is a case of RTFM. The real solution to the problem of creating an object via WMI is the ManagementCreate attribute. This attribute decorates a static method that takes key parameters (themselves decorated with ManagementName) and returns a new management entity.</p>
<p>The mental block that I was running into was the proxy. I was equating a .NET object with a WMI object. I assumed that creation of a .NET object via &quot;new&quot; was equivalent to the creation of a WMI entity via &quot;path ... create&quot;. Not the case.</p>
<p>The .NET objects are proxies for the WMI entities. The are created and destroyed with each request. A call to the create method should cause the enumerate method to include the new entity, as well as return the new proxy object. However, the .NET object returned from the create method will be different from the one returned from the create method. These are merely proxies to the same entity.</p>
<p>Problem solved. Moving on.</p>
				</div>

				<p class="postmetadata">Posted in <a href="indexb31a.html?cat=1" title="View all posts in Uncategorized" rel="category">Uncategorized</a> |   <a href="indexa943.html?p=252#respond" title="Comment on The real solution to creating objects in a managed WMI provider">No Comments &#187;</a></p>

			</div>

				<div class="post">
				<h3 id="post-251"><a href="indexd6e1.html?p=251" rel="bookmark" title="Permanent Link to Solution to creating a managed MWI provider">Solution to creating a managed MWI provider</a></h3>
				<small>Tuesday, September 2nd, 2008</small>

				<div class="entry">
					<p>I am attempting to create a Windows Service in C# that exposes management interfaces through WMI. I'm having trouble creating new objects from the WMI command line. See the <a href="indexc807.html?p=250">problem description</a>.</p>
<p>In working through the <a href="http://msdn.microsoft.com/en-us/library/cc268228.aspx">referenced article</a>, I learned a bit more about managed MWI providers. At the half-way point, you have a working coupled WMI provider written in C#. You should be able to enumerate service objects with the following command:</p>
<pre>C:\&gt;wmic /NAMESPACE:\\root\test PATH win32_servicehost get /value</pre>
<p>I tried that, and sure enough I get a list of service hosts and the services that they are running. These objects are created in code by the EnumerateServiceHosts method.</p>
<p>My problem requires that I create a new object. I have to allow operations to specify its properties and issue it commands. So I tried do create an instance of a Win32_ServiceHost with an ID not yet in the list:</p>
<pre>wmic:root\cli&gt;PATH win32_servicehost create id=821
Create instance of 'win32_servicehost' class (Y/N)?y
ERROR:
Code = 0x80041024
Description = Provider is not capable of the attempted operation
Facility = WMI</pre>
<p>Not surprising that this would fail, since the code returns null if the process ID is not found. But if I try to create an object using a process ID already in the list, this is what happens:</p>
<pre class="csharpcode">wmic:root\cli&gt;PATH win32_servicehost create ID=820
Create instance of <span class="str">'win32_servicehost'</span> <span class="kwrd">class</span> (Y/N)?y
ERROR:
Code = 0x80041019
Description = Object or property already exists
Facility = WMI</pre>
<p>So I changed the example code to allow me to create process hosts with IDs that are not in use. Now every ID I use gives me &quot;Object or property already exists&quot;. But if I query for an ID that does not exist, it tells me &quot;No Instance(s) Available&quot;.</p>
<pre class="csharpcode">wmic:root\cli&gt;PATH win32_servicehost create id=820
Create instance of <span class="str">'win32_servicehost'</span> <span class="kwrd">class</span> (Y/N)?y
ERROR:
Code = 0x80041019
Description = Object or property already exists
Facility = WMI

wmic:root\cli&gt;PATH win32_servicehost create id=821
Create instance of <span class="str">'win32_servicehost'</span> <span class="kwrd">class</span> (Y/N)?y
ERROR:
Code = 0x80041019
Description = Object or property already exists
Facility = WMI

wmic:root\cli&gt;PATH win32_servicehost <span class="kwrd">where</span> ID=820
ID   Services
820  {<span class="str">&quot;SCardSvr&quot;</span>}

wmic:root\cli&gt;PATH win32_servicehost <span class="kwrd">where</span> ID=821
No Instance(s) Available.</pre>
<p><strong>Here's my solution</strong></p>
<p>I think I'm approaching the problem from the wrong angle. Create doesn't mean what I think it means. WMI is set up to access objects that already exist.</p>
<p>Instead of creating instances of objects from WMI, I'm going to change my service so that I can return objects created in code. The operations team can issue commands to these existing objects to cause new objects to be created -- in code. Based on what works in the example, this should solve the problem. I'll post when it's working.</p>
				</div>

				<p class="postmetadata">Posted in <a href="indexb31a.html?cat=1" title="View all posts in Uncategorized" rel="category">Uncategorized</a> |   <a href="indexd6e1.html?p=251#respond" title="Comment on Solution to creating a managed MWI provider">No Comments &#187;</a></p>

			</div>

				<div class="post">
				<h3 id="post-243"><a href="indexfbc5.html?p=243" rel="bookmark" title="Permanent Link to Dallas TechFest 2008">Dallas TechFest 2008</a></h3>
				<small>Sunday, May 4th, 2008</small>

				<div class="entry">
					<p>The first Dallas TechFest was this weekend. There were sessions on .NET, Ruby, REST, Groovy, Flex, AIR, and many other languages, tools, and platforms. It was a chance for members of different communities to get together and cross-train each other. I made a point of stepping outside my comfort zone, rather than sticking with the .NET track.</p>
<p>But the two sessions that I attended within the .NET track were hosted by Carl Franklin and Richard Campbell of .NET Rocks. I couldn't miss the chance to see them. The first was a recording of a .NET Rocks episode on community. The second was Richard on web application performance and scalability. If you ever get a chance to hear Richard speak, you must go.</p>
<p>After his talk, I asked Richard to take a look at Update Controls. He was very gracious and gave me at least a half an hour of his time over lunch to show him the demo. He understood the benefits of the library immediately, and gave me some pointers for getting the idea across more effectively. Finally, he told me that I need to complete the database story, which, as it happens, is in the works.</p>
<p>It was a thrill to finally meet Carl and Richard, the guys who inspired me to launch this site. And it was enlightening to see what's been going on in other parts of the industry. Who knows. Maybe I'll get a chance to present next year.</p>
				</div>

				<p class="postmetadata">Posted in <a href="indexb31a.html?cat=1" title="View all posts in Uncategorized" rel="category">Uncategorized</a> |   <a href="indexfbc5.html?p=243#comments" title="Comment on Dallas TechFest 2008">2 Comments &#187;</a></p>

			</div>

				<div class="post">
				<h3 id="post-217"><a href="indexc094.html?p=217" rel="bookmark" title="Permanent Link to Raise the level of abstraction">Raise the level of abstraction</a></h3>
				<small>Sunday, March 9th, 2008</small>

				<div class="entry">
					<p>There's a long post by Jeff Moser entitled <a href="http://www.moserware.com/2008/03/what-does-it-take-to-become-grandmaster.html">What Does It Take To Become A Grandmaster Developer?</a> The post itself is interesting, but I'd like to call out one thing that I immediately reacted to.</p>
<blockquote><p>A foolish [assumption] would be to believe that you could exclusively live at the higher levels without understanding the lower levels. [...] Early on, I thought it was always possible to "raise the level of abstraction." I was wrong.</p>
</blockquote>
<p>I am all about raising the level of abstraction, so I thought he was calling me foolish. He seems to be saying that we cannot escape the details, even as we find the chunks that make them easier to remember.</p>
<p>After calming down a bit, I realized that he was saying something much more intelligent. He's saying that it is not always possible to completely hide details behind an abstraction. Further, he's implying that it is not always desirable to do so.</p>
<p><strong>Two kinds of abstractions</strong><br />The reasonable viewpoint that I missed at first is that there are two kinds of abstractions. There is the "leaky" abstraction that lets the underlying detail show through. Then there is the complete abstraction that hides those details from you for your own good. Both of these abstractions are useful.</p>
<p>Examples of leaky abstractions are web application languages like JSP and ASP. These generate HTML for you. They are an abstraction over HTML that relates it to your application data model. But they do not completely hide HTML from you. In fact, both of these languages live inside what looks like an HTML file.</p>
<p>Examples of complete abstractions are languages like C. It completely hides the underlying machine code. For an exceedingly large class of problems, you never have to write, look at, or think about machine code. At one point in history a knowledge of machine code was useful to C programming. But in this day, it's hard to argue that someone needs to have felt that pain in order to be a good C programmer.</p>
<p>Because JSP and ASP are leaky abstractions, they can never be decoupled from HTML. But because C is a compete abstraction, it can be ported (with varying degrees of success) to other platforms.</p>
<p><strong>An exceedingly large class of problems</strong><br />An abstraction is a model of the underlying idea. C programming isn't machine programming, but it represents machine programming. It captures the essential features required for a certain class of problems. Sure, there are problems outside of this class for which you have to write machine code. Boot loaders, operating systems, and device drivers can probably not be written entirely in C. But these are the minority. An exceedingly large class of programs can be written in C.</p>
<p>To make a complete abstraction, you must first identify the class of problems that you intend to solve. All problems in this class can be solved using <strong>only</strong> the features of the abstraction. Problems outside this class will require features of the underlying idea.</p>
<p><strong>Necessary and sufficient</strong><br />Once you have defined a class of problems, you can apply the concepts of <a href="indexc7e3.html?p=31">necessary and sufficient</a> features to create a complete abstraction for that class. Go back and read previous posts from the <a href="index2d79.html?cat=26">dof</a> (Degrees of Freedom) category. This post appears in that category, so skip back.</p>
<p>Each of the features of the abstraction is necessary for solving at least one problem in the class. The sum of the features is sufficient for solving all problems in the class.</p>
<p>This is also known as the Goldilocks principle. The abstraction is neither too big, nor too small. It's just right for the class of problems it solves.</p>
<p>This is also known as <a href="indexeb91.html?p=207">composability and orthogonality</a>. Each feature of the abstraction is orthogonal to the others because there is no combination of other features that can achieve the same effect. And the set of features can be composed to create a solution to any problem in the class.</p>
<p><strong>Benefits of a complete abstraction</strong><br />When you have a complete abstraction of necessary and sufficient features, you can solve any problem in a defined class. As long as you know that your problem belongs to that class, you never have to peel back the cover of the abstraction.</p>
<p>Not all abstractions demand this level of scrutiny and design, but those that do are often the most useful. They hide the details of the underlying idea for your own good. You never have to think about those details again. People new to the idea can focus on the abstraction and never even learn those details. And, those details can change without affecting artifacts created on top of the abstraction.</p>
				</div>

				<p class="postmetadata">Posted in <a href="indexb31a.html?cat=1" title="View all posts in Uncategorized" rel="category">Uncategorized</a> |   <a href="indexc094.html?p=217#respond" title="Comment on Raise the level of abstraction">No Comments &#187;</a></p>

			</div>

				<div class="post">
				<h3 id="post-125"><a href="index5070.html?p=125" rel="bookmark" title="Permanent Link to Bill Gates and Steve Jobs on the magic of software">Bill Gates and Steve Jobs on the magic of software</a></h3>
				<small>Friday, June 1st, 2007</small>

				<div class="entry">
					<p>Bill Gates and Steve Jobs participated in an interview for D5. The interviewers and audience were generally looking for points of tension, but Bill and Steve gave them so much more. The message was one of passion. Bill summed it up here:</p>
<blockquote><p>If you look inside my brain, it's filled with software, and the magic of software, and the belief in software, and that's not going to change.</p>
<p>-- Bill Gates</p></blockquote>
<p><a href="http://d5.allthingsd.com/20070531/video-steve-jobs-and-bill-gates-together-part-7-of-7/">Video on D5</a></p>
				</div>

				<p class="postmetadata">Posted in <a href="indexb31a.html?cat=1" title="View all posts in Uncategorized" rel="category">Uncategorized</a> |   <a href="index5070.html?p=125#respond" title="Comment on Bill Gates and Steve Jobs on the magic of software">No Comments &#187;</a></p>

			</div>

				<div class="post">
				<h3 id="post-61"><a href="index094d.html?p=61" rel="bookmark" title="Permanent Link to The Work Queue Pattern">The Work Queue Pattern</a></h3>
				<small>Thursday, November 30th, 2006</small>

				<div class="entry">
					<p>In each of the Enterprise systems I've worked on, we've had background processes to massage data. They could be report aggregators, media renderers, or message processors. The features that they have in common are:</p>
<ul>
<li>Work items may not be lost.</li>
<li>Work must not be interrupted.</li>
<li>Work items are independent of one-another.</li>
<li>Work items may not be repeated.</li>
</ul>
<p>The pattern that best implements these features is a work queue. A work queue has a publish-subscribe queue of work items serviced by redundant processors. The durability of the queue ensures that work items are not lost. Processors are allowed to work in parallel since work items are independent. That redundancy ensures that work continues even if a processor goes down. And proper use of the queue ensures that no two processors get the same work item.</p>
<p>This problem could be solved with JMS or MSMQ, but in my experience these solutions imposed undesirable requirements. JMS marries your code to J2EE, while MSMQ requires a Microsoft server environment. I prefer to keep my options open. Fortunately, it is not difficult to implement a work queue directly in the database of your choice.</p>
<p><span style="font-weight: bold">Here's my solution</span><br />
First you have to define a work queue table. In addition to columns that describe the work to be done, this table must also have a column that identifies the processor that is performing the work. A foreign key to a processor table works well. The processor table has a primary key (the processor ID) and the name of the machine running the process.</p>
<p>When a processor is ready to perform some work, it must query the work queue table twice. First it looks for any available work item, and then it ensures that no other processor has claimed that work item. This two-step query is the most effective way I've found to detect and resolve collisions let me explain in more detail.</p>
<p>The first query is performed with the transaction isolation level set to "read uncommitted". This allows the query to see any work queue items that are currently being claimed. The result of this query is the work item ID that the processor will try to claim for itself.</p>
<pre>SET TRANSACTION ISOLATION LEVEL READ UNCOMMITTED;
SET @id = (SELECT WorkItemID FROM WorkQueue WHERE ProcessorID=NULL);</pre>
<p>The second query is performed with the standard transaction isolation level of "read committed". It both locks the record and verifies that the work has not yet been claimed.</p>
<pre>SET TRANSACTION ISOLATION LEVEL READ COMMITTED;
SELECT ProcessorID FROM WorkQueue (UPDATE) WHERE WorkItemID=@id;</pre>
<p>If the row is found and the processor ID comes back NULL, then you know that the work has not yet been claimed. You may now update the ProcessorID and commit the transaction.</p>
<p>However, if the row is not found, then the work has already been completed and deleted from the queue. If the processor ID is not NULL, then a collision has occurred. Another processor is already busy working on that item. So you just commit your transaction and try again.</p>
<p>It took several days of trial-and-error to get the pattern right the first time. But now that I have it, it is easy to create a work queue without the overhead of JMS or MSMQ.</p>
				</div>

				<p class="postmetadata">Posted in <a href="indexc728.html?cat=7" title="View all posts in Databases" rel="category">Databases</a>,  <a href="indexb0b7.html?cat=6" title="View all posts in Patterns" rel="category">Patterns</a>,  <a href="indexb31a.html?cat=1" title="View all posts in Uncategorized" rel="category">Uncategorized</a> |   <a href="index094d.html?p=61#respond" title="Comment on The Work Queue Pattern">No Comments &#187;</a></p>

			</div>

		
		<div class="navigation">
			<div class="alignleft"><a href="index9f05.html?cat=1&amp;paged=3">&laquo; Previous Entries</a></div>
			<div class="alignright"><a href="indexb31a.html?cat=1">Next Entries &raquo;</a></div>
		</div>

	
	</div>
		</td>
	</tr>
</table>

<hr />
<div id="footer">
<!-- If you'd like to support WordPress, having the "powered by" link someone on your blog is the best way, it's our only promotion or advertising. -->
	<p>
		Adventures in Software is proudly powered by 
		<a href="http://wordpress.org/">WordPress</a>
		<br /><a href="indexd784.html?feed=rss2">Entries (RSS)</a>
		and <a href="indexa6da.html?feed=comments-rss2">Comments (RSS)</a>.
		<!-- 17 queries. 0.385 seconds. -->
	</p>
</div>
<script type="text/javascript">
var gaJsHost = (("https:" == document.location.protocol) ? "https://ssl." : "http://www.");
document.write(unescape("%3Cscript src='" + gaJsHost + "google-analytics.com/ga.js' type='text/javascript'%3E%3C/script%3E"));
</script>
<script type="text/javascript">
try {
var pageTracker = _gat._getTracker("UA-389401-3");
pageTracker._trackPageview();
} catch(err) {}</script></div>

<!-- Gorgeous design by Michael Heilemann - http://binarybonsai.com/kubrick/ -->

		<div id="sk2-footer" style="color:#FFF; background-color:#444; padding: 3px 2px 3px 2px; border-top: #888 solid 1px;">This blog is protected by <a href="http://unknowngenius.com/blog/" title="Dave">dr Dave</a>'s <strong><a href="http://unknowngenius.com/blog/wordpress/spam-karma/" title="SK2">Spam Karma 2</a></strong>: <strong>274531</strong>  Spams eaten and counting...</div><script type="text/javascript" src="replies.js"></script>
<script type="text/javascript" src="blogger.js"></script>
<script type="text/javascript" src="http://twitter.com/statuses/user_timeline/michaellperry.json?callback=twitterCallback2&amp;count=5"></script>
<script type="text/javascript" src="http://search.twitter.com/search.json?q=@michaellperry&amp;callback=twitterCallbackReplies&amp;rpp=5"></script>
</body>

<!-- Mirrored from adventuresinsoftware.com/blog/?cat=1&paged=2 by HTTrack Website Copier/3.x [XR&CO'2014], Fri, 13 Jan 2017 13:02:59 GMT -->
</html>
